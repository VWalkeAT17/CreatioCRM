(self.webpackChunkapp_studio_enterprise_schema_view=self.webpackChunkapp_studio_enterprise_schema_view||[]).push([[1631],{37206:(q,M,e)=>{e.d(M,{D:()=>y,w:()=>A});var f=e(73308),R=e(81517),S=e(41287),L=e(91775),c=e(62278),h=e.n(c);const u="ChatsListLoadSubject",m="ChatsListLoadSubscription";class y extends R.S{constructor(){super(...arguments),this.searchFilter=null,this.isFirstLoad=!1}}class A extends S.l{_getChatsListLoadSubject(a){return(0,f.A)(function*(){let d=yield a.$context[u];return d||(d=new c.Subject,a.$context[u]=d),d})()}_resetChatsLoadOffsetSubscription(a){var d=this;(0,f.A)(function*(){const g=yield a.$context[m];g&&g.unsubscribe();const n=yield d._getChatsListLoadSubject(a);d._handleChatsListOffsetChange(a,n)})()}_handleChatsListOffsetChange(a,d){var g=this;a.$context[m]=d.pipe((0,c.debounceTime)(500),(0,c.tap)(()=>a.$context.IsActiveChatsLoading=!1),(0,c.distinctUntilChanged)((n,r)=>n.offset===r.offset&&n.searchFilter===r.searchFilter),(0,c.tap)(()=>a.$context.IsActiveChatsLoading=!0),(0,c.switchMap)(n=>this.getChatPreviews(n.offset,n.rowsToLoad,n.searchFilter).pipe((0,c.filter)(r=>n.offset===0||r&&r.length>0),(0,c.map)(r=>r.map(v=>this.mapChatPreview(v))),(0,c.switchMap)(r=>(0,c.from)(a.$context.ActiveChats).pipe((0,c.take)(1),(0,c.map)(v=>!v||v.length===0||n.currentPage===0?r:[...v,...r]))),(0,c.map)(r=>({page:n.currentPage,mappedSessions:r,search:n.searchFilter})),(0,c.finalize)(()=>{a.$context.IsActiveChatsLoading=!1})))).subscribe({next:n=>{a.$context.ActiveChats=Array.from(new Map(n.mappedSessions.map(r=>[r.id,r])).values()),a.$context.ChatsListPage=n.page+1,n.search&&(0,f.A)(function*(){return yield g._reloadCurrentChatIfNeeded(a)})()},error:n=>{console.error("Failed to load chat previews:",n),this._resetChatsLoadOffsetSubscription(a)}})}_reloadCurrentChatIfNeeded(a){var d=this;return(0,f.A)(function*(){const g=yield d.getCurrentChatId(a),n=yield a.$context.IsCombinedMode,r=(yield a.$context.ActiveChats).find(v=>v.id===g);if(r&&n){const v=d.getChatOpenRequest(a,r);yield L.t.instance.process(v)}})()}handle(a){var d=this;return(0,f.A)(function*(){yield d.next?.handle(a);const g=yield d._getChatsListLoadSubject(a);a.isFirstLoad&&(d._handleChatsListOffsetChange(a,g),a.$context.ChatsListPage=0);const n=yield a.$context.ChatsListPage,r=n*a.rowsToLoadCount;g.next({offset:r,rowsToLoad:a.rowsToLoadCount,currentPage:n,searchFilter:a.searchFilter})})()}}},91631:(q,M,e)=>{e.r(M),e.d(M,{ALLOW_MENTION_HOOK:()=>$t.F,AcceptOmniChatHandler:()=>K.i,AcceptOmniChatRequest:()=>K.Z,BaseChatListLoadHandler:()=>U.w,BaseChatListLoadRequest:()=>U.D,CHAT_PROFILE_KEY:()=>Ot.j,CONVERSATION_RESET_EVENT:()=>Q.R,ChatDraftService:()=>Nt.X,ChatEventService:()=>Dt.o,ChatListChangeHandler:()=>W.h,ChatListChangeRequest:()=>W.w,ChatMessageActionHandler:()=>_.o,ChatMessageActionRequest:()=>I,ChatMessageInteractionRequest:()=>$,ChatMessageTypeRegisterServiceMock:()=>G,ChatPreview:()=>At.H,ChatScrollPositionService:()=>Tt.U,CloseOmniChatConversationHandler:()=>lt.T,CloseOmniChatConversationRequest:()=>F,ConversationEvent:()=>Q.u,ConversationPreprocessor:()=>It.D,CopilotContentUtils:()=>jt.$,CrtChatDisclaimerComponent:()=>a.k,CrtChatItemComponent:()=>g.I,CrtChatListComponent:()=>d.l,CrtChatMessagesComponent:()=>f.z,CrtChatPanelModule:()=>X.e,CrtChatTypingComponent:()=>R.E,CrtConversationComponent:()=>S.g,CrtMessageEditorComponent:()=>L.j,CrtMessageEditorInputComponent:()=>c.z,CrtMessageEditorReplyComponent:()=>O.z,CrtRenameChatComponent:()=>n.P,LoadAllConversationHandler:()=>st.Z,LoadAllConversationRequest:()=>V,LoadChatProfileHandler:()=>ot.m,LoadChatProfileRequest:()=>D,LoadConversationHandler:()=>tt.G,LoadConversationModeEnum:()=>w.W,LoadConversationRequest:()=>N,MessageEditorInputActionEnum:()=>A.g,MessageEditorInputChangeHandler:()=>et.x,MessageEditorInputChangeRequest:()=>T,MessageEditorPreprocessor:()=>xt.k,MessageEditorSendHandler:()=>E,MessageEditorSendRequest:()=>x,OmniChatInitHandler:()=>nt.o,OmniChatPaginationHandler:()=>rt.Y,OmniChatPaginationRequest:()=>B,OpenOmniChatHandler:()=>it.I,OpenOmniChatRequest:()=>H,RenameChatDialogData:()=>Et,SaveChatProfileHandler:()=>at.b,SaveChatProfileRequest:()=>j,TriggerMentionRequest:()=>y,providersMock:()=>Lt});var f=e(90615),R=e(38739),S=e(18611),L=e(28503),c=e(30073),h=e(5960),u=e(81517),m=e(2828);let y=class extends u.S{};y=(0,h.__decorate)([(0,m.$)({type:"crt.TriggerMentionRequest"})],y);var A=e(96158),O=e(7917),a=e(88263),d=e(83463),g=e(68759),n=e(11395),r=e(73308),v=e(41287),k=e(844);let E=class extends v.l{handle(t){var o=this;return(0,r.A)(function*(){yield o.next?.handle(t)})()}};E=(0,h.__decorate)([(0,k.l)({type:"crt.MessageEditorSendHandler",requestType:"crt.MessageEditorSendRequest"})],E);var _=e(42963),tt=e(39097),et=e(20903),ot=e(99556),at=e(53395),U=e(37206),W=e(53251),nt=e(29846),K=e(35794),st=e(2675),rt=e(11661),it=e(46865),lt=e(16365),b=e(22307),dt=e(11629),z=e(59969),ct=e(41833),ht=e(99543);class G{static{this._selectorCounter=0}static getProvider(){return{provide:ct.s,useFactory:(t,o)=>{for(const s of t){let{selector:i}=(0,b.reflectComponentType)(s.componentType);i=i+this._selectorCounter++,o.defineComponent(i,s.componentType),dt.L.register(s.messageType,i)}},deps:[ht.U,z.SH]}}}var ut=e(61832),mt=e(24091),Ct=e(31149),gt=e(57274),vt=e(25853),pt=e(59962),ft=e(26852),yt=e(26594),Mt=e(86323),Pt=e(4583),Z=e(59247),Rt=e(89285),l=e(62278),Y=e(82805),J=e(56005);class St{constructor(t={},o={},s=!1){this.attributes=t,this.isDestroyed=s,this._injectionContextValue="not set",this._injector={get:(i,p)=>p},this._attributeConfigs={},this._crtControls=new Map,this.formApiModel=new Z.FormGroup({}),this._destroy$=new l.Subject,this.events$=new l.Subject,this.dataSchemas={},this._businessRulesActivated$=new l.BehaviorSubject(!1),this._modelsMap=new Map,this.modelDependenciesMock={};for(const i of Object.keys(t)){Object.defineProperty(this,i,{get:()=>Promise.resolve(this.attributes[i]),set:P=>this.attributes[i]=P,configurable:!0});const p=Y.C.create({name:i,value:this.attributes[i],propertiesConfig:[],featureValues:{}});this._crtControls.set(i,p)}this.Resources={Strings:{}},Object.assign(this,o)}get PrimaryModelMode(){return Rt.b.Create}get IsChanged(){return Promise.resolve(!1)}get HasUnsavedData(){return Promise.resolve(!1)}get[J.w](){return this._injector}set[J.w](t){this._injector=t}get _injectionContext(){return this._injectionContextValue==="not set"?{id:"id",inject:()=>null,addLazyModule:()=>null,connectHostLazyModules:()=>{},getLazyModules:()=>[],destroy:()=>{}}:this._injectionContextValue}set _injectionContext(t){this._injectionContextValue=t}get _destroyed(){return this.isDestroyed}isValid(){return Promise.resolve(!0)}deactivateBusinessRules(){}activateBusinessRules(){return(0,l.of)()}validate(){return Promise.resolve({})}init(t){return(0,l.of)()}setValue(t,o){return(0,l.of)()}set(t,o,s){return(0,l.of)()}setSorting(){return(0,l.of)(null)}create(t,o){return(0,l.of)(null)}executeRequest(t){return Promise.resolve()}loadLookupList(t,o,s){return null}load(...t){return(0,l.of)()}copy(t,o,s){return(0,l.of)()}loadDefaultValues(){return(0,l.of)()}save(t,o,s){return(0,l.of)()}saveInTransaction(t,o,s,i){return(0,l.of)()}deleteInTransaction(t,o,s,i){return(0,l.of)()}commitTransaction(t,o,s,i){return(0,l.of)()}delete(t,o,s){return(0,l.of)()}getAttributeControl(t){const o=this.attributes[t];return new Z.FormControl(o)}getBoundDataSourceName(t){return""}getBoundDataSource(t){}getBoundDataSchema(t){}getViewModelAttributePath(t,o){return""}getViewModelAttributePaths(t,o){return null}destroy(){return this._destroy$.next(),this._destroy$.complete(),(0,l.of)(void 0)}getBoundDataSchemaByAttributePath(t){}getBoundDataSchemaAttributeByAttributePath(t){return null}getBoundDataSourceNameByAttributePath(t){return""}getPrimaryModelName(){return Promise.resolve("")}getPrimaryDataSchema(){return Promise.resolve(null)}getAttributeNameByViewItemName(t){return""}getControl(t){return this._crtControls.has(t)?this._crtControls.get(t):Y.C.create({name:t,value:null,propertiesConfig:[],featureValues:{}})}getAttributePropertyValue(...t){let o,s;if(t.length===2)o=t[0],s=t[1];else if(t.length===1){const p=t[0].split(":");o=p[0],s=p[1]}else throw new Error("ArgumentException");return this.getControl(o)?.getPropertyValue(s)}setAttributePropertyValue(...t){let o,s,i;if(t.length===3)o=t[0],s=t[1],i=t[2];else if(t.length===2){const P=t[0].split(":");o=P[0],s=P[1],i=t[1]}else throw new Error("ArgumentException");const p=this.getControl(o);p&&p.setPropertyValue(s,i)}resetAttributePropertyValue(...t){let o,s;if(t.length===1)[o,s]=t[0].split(":");else if(t.length===2)o=t[0],s=t[1];else throw new Error("ArgumentException");this.getControl(o).getPropertyByName(s)?.resetValue()}getInvariabilityPropertyName(t){return null}setModelValues(t,o){return null}getIsDirty(t){return this.getControl(t).isDirty}getModelByName(t){return null}getModelMode(t){return null}getPrimaryModelMode(){return null}_getModelModeChanges(t){return null}_getPrimaryModelModeChanges(){return null}_hotSwap(t){return(0,l.of)(!0)}markModelFor(t,o){return null}markPrimaryModelFor(t){return null}_onAsyncTaskStarted(t){}_onAsyncTaskFinished(t){}_getIsAffectedByBusinessRules(t){return Promise.resolve(!1)}_getDependOnModelsNames(t){return[]}_getModelDependencies(t){return this.modelDependenciesMock[t]??[]}}var X=e(42656);const Lt=[{provide:pt.e,useValue:[X.e,mt.S,Ct.q,ut.V,gt.u]},{provide:yt.G,useValue:{}},{provide:ft.I,useValue:{viewModel$:(0,l.of)(new St)}},{provide:Mt.V,useValue:Pt.V.instance},{provide:z.ZP,useFactory:()=>globalThis},G.getProvider(),(0,b.importProvidersFrom)(vt.A)];var Q=e(43778),w=e(15932),At=e(15959),Ot=e(13161);class Et{}var xt=e(1978),It=e(40870);let x=class extends u.S{};x=(0,h.__decorate)([(0,m.$)({type:"crt.MessageEditorSendRequest"})],x);let I=class extends u.S{};I=(0,h.__decorate)([(0,m.$)({type:"crt.ChatMessageActionRequest"})],I);let N=class extends u.S{constructor(){super(...arguments),this.loadMode=w.W.Replace}};N=(0,h.__decorate)([(0,m.$)({type:"crt.LoadConversationRequest"})],N);let T=class extends u.S{};T=(0,h.__decorate)([(0,m.$)({type:"crt.MessageEditorInputChangeRequest"})],T);let D=class extends u.S{};D=(0,h.__decorate)([(0,m.$)({type:"crt.LoadChatProfileRequest"})],D);let j=class extends u.S{};j=(0,h.__decorate)([(0,m.$)({type:"crt.SaveChatProfileRequest"})],j);let $=class extends u.S{constructor(t){super(),this.message=t.message,this.eventName=t.eventName,this.payload=t.payload}};$=(0,h.__decorate)([(0,m.$)({type:"crt.ChatMessageInteractionRequest"}),(0,h.__metadata)("design:paramtypes",[Object])],$);let V=class extends u.S{constructor(){super(...arguments),this.chatMessagesAttributeName="ChatMessages"}};V=(0,h.__decorate)([(0,m.$)({type:"crt.LoadAllConversationRequest"})],V);let B=class extends u.S{};B=(0,h.__decorate)([(0,m.$)({type:"crt.OmniChatPaginationRequest"})],B);let H=class extends u.S{};H=(0,h.__decorate)([(0,m.$)({type:"crt.OpenOmniChatRequest"})],H);let F=class extends u.S{constructor(){super(...arguments),this.chatMessagesAttributeName="ChatMessages"}};F=(0,h.__decorate)([(0,m.$)({type:"crt.CloseOmniChatConversationRequest"})],F);var Nt=e(13555),Tt=e(19540),Dt=e(16629),jt=e(92385),$t=e(89986)}}]);
