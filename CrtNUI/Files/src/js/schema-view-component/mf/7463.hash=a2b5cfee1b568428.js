(self.webpackChunkapp_studio_enterprise_schema_view=self.webpackChunkapp_studio_enterprise_schema_view||[]).push([[7463],{30268:(B,D,e)=>{e.d(D,{$:()=>y});/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function r(C,p,c){var _=document.head||document.getElementsByTagName("head")[0],m=document.createElement("script");typeof p=="function"&&(c=p,p={}),p=p||{},c=c||function(){},m.type=p.type||"text/javascript",m.charset=p.charset||"utf8",m.async="async"in p?!!p.async:!0,m.src=C,p.attrs&&a(m,p.attrs),p.text&&(m.text=String(p.text));var h="onload"in m?l:n;h(m,c),m.onload||l(m,c),_.appendChild(m)}function a(C,p){for(var c in p)C.setAttribute(c,p[c])}function l(C,p){C.onload=function(){this.onerror=this.onload=null,p(null,C)},C.onerror=function(){this.onerror=this.onload=null,p(new Error("Failed to load "+this.src),C)}}function n(C,p){C.onreadystatechange=function(){this.readyState!="complete"&&this.readyState!="loaded"||(this.onreadystatechange=null,p(null,C))}}var M;function y(C,p){return"CKEDITOR"in window?Promise.resolve(CKEDITOR):typeof C!="string"||C.length<1?Promise.reject(new TypeError("CKEditor URL must be a non-empty string.")):(M||(M=y.scriptLoader(C).then(function(c){return p&&p(c),c})),M)}y.scriptLoader=function(C){return new Promise(function(p,c){r(C,function(_){if(M=void 0,_)return c(_);if(!window.CKEDITOR)return c(new Error("Script loaded from editorUrl doesn't provide CKEDITOR namespace."));p(CKEDITOR)})})};function u(C,p){var c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},_;return function(){clearTimeout(_);for(var m=arguments.length,h=new Array(m),I=0;I<m;I++)h[I]=arguments[I];_=setTimeout(C.bind.apply(C,[c].concat(h)),p)}}},26165:(B,D,e)=>{e.d(D,{C:()=>l});var r=e(22307),a=e.n(r);const l=new r.InjectionToken("CkeditorThemeStyleUrl")},45093:(B,D,e)=>{e.d(D,{R:()=>W});var r=e(73308),a=e(5960),l=e(58155),n=e(22307),M=e(4615),y=e(37851),u=e(6530),C=e(86464),p=e(77592),c=e(34760),_=e(1034),m=e(96677),h=e(52793),I=e(50999),P=e(10098),R=e(70936),f=e(80775),d=e(7471),v=e(59969),E=e(50485),x=e(54918),O=e(19344),T=e(31774),b=e(16805),U=e(8017),j=e(48534),H=e(85040),G=e(57156),X=e(69930),z=e(66297),$=e(26594),F=e(19816),L=e(73916),k=e(97842),K=e(44945),N=e(92009),J=e(30268),Z=e(28399),Q=e(62278),le=e(36486),ce=e(89422),fe=e(3214),re=e(12444),se=e(26165),ie=e(58001),Ee=e(2122),ve=e(59247),de=e(66803);class _e{constructor(i,t){this._injector=i,this.dialogName=t,this.componentFactoryResolver=i.get(n.ComponentFactoryResolver)}createComponent(i){return this.componentFactoryResolver.resolveComponentFactory(i).create(this._injector)}overrideDialog(i,t){if(!this.dialogName||this.dialogName!==i.data.name)return;const o=this,s=i.data.definition,g=i.editor.document;s.onShow=function(){o.onDialogOpen(this,g,t)}}}class ue extends _e{constructor(){super(...arguments),this._customComboboxClass="custom-combobox-input",this._customDialogBodyClass="code-snippet-override",this._focusSelectors=["a.cke_dialog_close_button",".cke_dialog_ui_select .crt-base-input-container input",".cke_dialog_ui_select .crt-base-input-container .combobox-expander.clear",".cke_dialog_ui_select .crt-base-input-container .combobox-expander.closed","textarea.cke_dialog_ui_input_textarea","a.cke_dialog_ui_button_cancel","a.cke_dialog_ui_button_ok"]}_replaceButtons(i){const t=i.findOne(".cke_dialog_footer");if(!t)return;const o=t.findOne(".cke_dialog_ui_button_ok"),s=t.findOne(".cke_dialog_ui_button_cancel");if(o&&s){const g=o.getParent(),S=s.getParent();if(g.getIndex()<S.getIndex()){const w=g.getParent();w.append(S),w.append(g)}}}_replaceCloseIcon(i){const t=i.findOne(".cke_dialog_close_button");if(!t)return;const o=t.findOne("span");if(o){const s=this.createComponent(y.MatIcon);s.instance.svgIcon="close",s.location.nativeElement.classList.add("close-button-icon"),o.$.replaceWith(s.location.nativeElement)}}_replaceCombobox(i,t){const o=i.getContentElement("info","lang");if(!o)return;const s=t.findOne(".cke_dialog_ui_select");if(!s)return;const g=s.findOne(`.${this._customComboboxClass}`);g&&g.remove();const S=this._createAndSetupCombobox(o);s.$.appendChild(S.location.nativeElement);const w=S.instance.control.value;S.instance.control.setValue(w)}_createAndSetupCombobox(i){const t=this.createComponent(de.q),o=i.items.map(([w,V])=>({displayValue:w,value:V||"-"}));t.instance.items=o,t.instance.label=i.label,t.instance.labelPosition="above";const s=i.getValue(),g=new ve.FormControl(o.find(w=>w.value===s)??o[0]);return t.instance.control=g,t.instance.readonly=!1,t.instance.required=!0,t.instance.useStaticFiltering=!1,t.instance.showList.subscribe(w=>{t.instance.items=w?.filterValue?o.filter(V=>V.displayValue.includes(w.filterValue)):o}),t.instance.showValueAsLink=!0,t.instance.listActions=[],t.instance.valueChange.subscribe(w=>{if(!w||typeof w=="string")return;const V=w.value!=="-"?w.value:"";i.setValue(V)}),i.on("change",()=>{const w=i.getValue(),V=o.find(q=>q.value===w)??o[0];g.setValue(V,{emitEvent:!1})}),t.location.nativeElement.classList.add(this._customComboboxClass),t.location.nativeElement.classList.add("crt-base-edit-input"),t.location.nativeElement.querySelector(".crt-base-input-container input")?.addEventListener("blur",()=>this._removeComboboxInputFocus(t.location.nativeElement)),setTimeout(()=>{const V=t.instance.autocomplete?.autoCompleteTrigger?.autocomplete;V&&V.optionActivated.subscribe(()=>{t.changeDetectorRef.detectChanges()})},0),t}_removeComboboxInputFocus(i){const t="mat-focused",o=i.querySelector(".crt-autocomplete-input-control-container");o&&o.classList.contains(t)&&o.classList.remove(t)}_changeDialogZindex(i,t){const o=i.findOne(`.cke_dialog_container.cke_editor_${t}_dialog`);o&&o.setStyle("z-index","1010");const s=i.findOne(".cke_dialog_background_cover");s&&s.setStyle("z-index","1000");const g=i.getById(`cke_${t}`);g&&g.setStyle("z-index","999")}_initDialogFocusLogic(i){i.on("keydown",t=>{const o=t.data.getKeystroke();(o===27||o===13||[37,38,39,40].includes(o))&&t.stop()},this,null,-1),i.$.addEventListener("keydown",t=>{if(t.key!==ce.Key.Tab)return;const o=t.target,s=this._focusSelectors.findIndex(g=>o.matches(g));s!==-1&&(t.preventDefault(),this._focusNextElement(s,t.shiftKey))})}_focusNextElement(i,t,o=!1){const s=t?(i-1+this._focusSelectors.length)%this._focusSelectors.length:(i+1)%this._focusSelectors.length,g=document.querySelector(this._focusSelectors[s]);if(!g&&!o){this._focusNextElement(s,t,!0);return}setTimeout(()=>{g.focus()},0)}onDialogOpen(i,t,o){this._changeDialogZindex(t,o);const s=i.getElement();s.addClass(this._customDialogBodyClass),s.removeAllListeners(),this._replaceCloseIcon(s),this._replaceButtons(s),this._replaceCombobox(i,s),this._initDialogFocusLogic(s)}}const me={codeSnippet:ue},ge=new n.InjectionToken("DialogOverrideMap",{providedIn:"any",factory:()=>me});class ee{constructor(i,t){this._injector=i,this._strategyMap=t}_isDialogOverrideType(i){return i in this._strategyMap}_createOverride(i){const t=this._strategyMap[i];if(!t)throw new Error(`Dialog override type "${i}" is not supported.`);return new t(this._injector,i)}overrideDialog(i,t){const o=i.data.name;this._isDialogOverrideType(o)&&this._createOverride(o).overrideDialog(i,t)}static{this.\u0275fac=function(t){return new(t||ee)(n.\u0275\u0275inject(n.Injector),n.\u0275\u0275inject(ge))}}static{this.\u0275prov=n.\u0275\u0275defineInjectable({token:ee,factory:ee.\u0275fac,providedIn:"any"})}}var Ce=e(41314),xe=e(4092),ye=e(90983);class Te{constructor(i,t,o){this._contactColorService=i,this._initialsService=t,this._matIconRegistry=o,this._getMentionsWithDebounce=(0,Z.debounce)(this._getMentions,500),this._mentionStyles="padding-inline-start: 5px;padding-inline-end: 10px;margin-top: 2px;margin-inline-start: 2px;border-radius: 16px;text-decoration: none;max-width: calc(100% - 10px);display: inline-flex;max-height: 1.23em;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;line-height: 1.23em;vertical-align: text-bottom;",this._mentionUserIconStyles="display: inline-flex;height: 2em;line-height: 1.9em;margin-inline-end: 5px;border-radius: 50%;width: 2em;align-self: center;color: white;font-size: 0.6em;justify-content: space-evenly;box-sizing: border-box;font-weight: 400;",this._generalUserMentionStyles="color: var(--crt-palette-primary-500);background-color: var(--crt-palette-interaction-900);",this._externalUserMentionStyles="color: var(--crt-palette-success-700);background-color: var(--crt-palette-success-100);",this._initialsBorderStyle="border: 1px solid var(--crt-palette-border-400)",this._loadExternalUserIcon()}_loadExternalUserIcon(){this._matIconRegistry.getNamedSvgIcon("external-user-type-icon").pipe((0,Q.catchError)(()=>(0,Q.of)(null))).subscribe(i=>{if(i){const t=(0,Ce.M6)(i.outerHTML);this._userIcon=`data:image/svg+xml;base64,${t}`}})}_getPhotoUrl(i){return!i||(0,u.gZ)(i)?"":(0,Ce.Mc)(i)}_mapMention(i){const t=i.connectionType===`${xe.U.External}`,o=this._getPhotoUrl(i.primaryImageValue),s=!(0,Z.isEmpty)(o),g=s?"":this._contactColorService.getNextColor(i.value),S=this._mentionStyles+(t?this._externalUserMentionStyles:this._generalUserMentionStyles),w=s?this._mentionUserIconStyles:"display:none;";let V="display:none;";s||(V=this._mentionUserIconStyles+`background: ${g};`+this._initialsBorderStyle);const q=this._initialsService.getInitials(i.displayValue),te=t?this._userIcon:"",Se=JSON.stringify(i);return{id:i.value,name:i.displayValue,icon:o,typeIcon:te,pageUrl:(0,ye.TX)("Contact",i.value),styles:S,iconStyles:w,initialsStyles:V,initials:q,shortInitials:(0,Z.isEmpty)(q)?"":q[0],color:g,contactDto:encodeURIComponent(Se)}}_getMentions(i){this._mentionRequestOptions=i;const{mentionsService:t,queryString:o,callback:s}=i;t.getContacts(o).pipe((0,Q.catchError)(()=>(0,Q.of)(null))).subscribe(g=>{s&&s(g?.map(S=>this._mapMention(S))),this._processQueuedRequest(o)})}_processQueuedRequest(i){this._mentionRequestOptions&&this._mentionRequestOptions.queryString!==i?this._getMentions(this._mentionRequestOptions):this._mentionRequestOptions=null}getMentionsWithDebounce(i,t,o){if(!i)return o([]);if(this._mentionRequestOptions){this._mentionRequestOptions={mentionsService:i,queryString:t,callback:o};return}t===""?this._getMentions({mentionsService:i,queryString:t,callback:o}):this._getMentionsWithDebounce({mentionsService:i,queryString:t,callback:o})}getMentionsFromHtml(i){if((0,Z.isEmpty)(i))return[];const t=new RegExp(/mention-info="(.+?)"/gi);return[...i.matchAll(t)].map(o=>{try{const s=decodeURIComponent(o[1]),g=JSON.parse(s);return g.value?g:null}catch{return null}}).filter(o=>!!o)}}var Me=e(21542),he=e(75648),ne=e(47243),Y=e(67057),Ue=e(10990),Oe=e(58433),Pe=e(84137),Ie=e(26657),ae=e(66459),Be=e(48067),pe=e(58083),oe=e(45667),be=e(53887),we=e(8625),Ve=e(66302),Fe=e(30647),ke=e(80932),Ke=e(79772);const We=["tooltipLink"],je=["selectionActionsPanel"],Ne=["*"],He=A=>({"crt-input-required":A}),$e=()=>["cke_widget_drag_handler","cke_widget_mask"];function ze(A,i){A&1&&n.\u0275\u0275elementContainer(0)}function Ze(A,i){if(A&1&&n.\u0275\u0275element(0,"crt-base-input-width-holder",12),A&2){const t=n.\u0275\u0275nextContext();n.\u0275\u0275property("label",t.label)("minWidth",180)}}function Qe(A,i){if(A&1&&n.\u0275\u0275element(0,"div",13,2),A&2){const t=n.\u0275\u0275nextContext();n.\u0275\u0275property("tooltipConfig",t.getLinkWindowTooltipConfig())}}function Ge(A,i){A&1&&n.\u0275\u0275element(0,"crt-skeleton-loader")}function Xe(A,i){if(A&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"ckeditor",25),n.\u0275\u0275twoWayListener("dataChange",function(s){n.\u0275\u0275restoreView(t);const g=n.\u0275\u0275nextContext(2);return n.\u0275\u0275twoWayBindingSet(g.control.value,s)||(g.control.value=s),n.\u0275\u0275resetView(s)})("configChange",function(s){n.\u0275\u0275restoreView(t);const g=n.\u0275\u0275nextContext(2);return n.\u0275\u0275twoWayBindingSet(g.editorConfig,s)||(g.editorConfig=s),n.\u0275\u0275resetView(s)}),n.\u0275\u0275listener("ready",function(s){n.\u0275\u0275restoreView(t);const g=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(g.onEditorReady(s))})("focus",function(s){n.\u0275\u0275restoreView(t);const g=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(g.onEditorFocus(s))})("blur",function(s){n.\u0275\u0275restoreView(t);const g=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(g.onEditorBlur(s))})("click",function(s){n.\u0275\u0275restoreView(t);const g=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(g.onClick(s))})("sizeChanged",function(){n.\u0275\u0275restoreView(t);const s=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(s.onVideoSizeChanged())})("keydown.escape",function(s){n.\u0275\u0275restoreView(t);const g=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(g.tryCloseToolbar(s))}),n.\u0275\u0275elementEnd()}if(A&2){const t=n.\u0275\u0275nextContext(2);n.\u0275\u0275property("crtAnchorScrollHandler",(!t.isFocused||t.readonly)&&t.isReady&&!t.loading)("ignoreImageClasses",n.\u0275\u0275pureFunction0(11,$e))("toggleImageHandlers",(!t.isFocused||t.readonly)&&t.isReady&&!t.loading)("resetHighlightCode",t.control.value)("resetHighlightQuote",t.control.value)("resetResizeVideo",t.control.value)("enableSizeChanges",!0),n.\u0275\u0275twoWayProperty("data",t.control.value)("config",t.editorConfig),n.\u0275\u0275property("type",t.editorType)("editorUrl",t.editorUrl)}}function Je(A,i){if(A&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"mat-icon",26),n.\u0275\u0275pipe(1,"translate"),n.\u0275\u0275pipe(2,"translate"),n.\u0275\u0275listener("click",function(){n.\u0275\u0275restoreView(t);const s=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(s.onClipClicked())})("keyup.enter",function(s){n.\u0275\u0275restoreView(t);const g=n.\u0275\u0275nextContext(2);return s.stopPropagation(),n.\u0275\u0275resetView(g.onClipClicked())})("mousedown",function(){n.\u0275\u0275restoreView(t);const s=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(s.setBlurLocked())})("focus",function(){n.\u0275\u0275restoreView(t);const s=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(s.setBlurLocked())})("blur",function(s){n.\u0275\u0275restoreView(t),n.\u0275\u0275nextContext();const g=n.\u0275\u0275reference(8),S=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(S.tryBlurToggle(s,g))}),n.\u0275\u0275elementEnd()}A&2&&(n.\u0275\u0275property("crtTooltip",n.\u0275\u0275pipeBind1(1,2,"RichTextEditor.UploadAttachments")),n.\u0275\u0275attribute("aria-label",n.\u0275\u0275pipeBind1(2,4,"RichTextEditor.UploadAttachments")))}function Ye(A,i){if(A&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"mat-icon",27),n.\u0275\u0275pipe(1,"translate"),n.\u0275\u0275pipe(2,"translate"),n.\u0275\u0275listener("click",function(){n.\u0275\u0275restoreView(t);const s=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(s.onSelectTemplateClicked())})("keyup.enter",function(s){n.\u0275\u0275restoreView(t);const g=n.\u0275\u0275nextContext(2);return s.stopPropagation(),n.\u0275\u0275resetView(g.onSelectTemplateClicked())})("focus",function(){n.\u0275\u0275restoreView(t);const s=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(s.setBlurLocked())})("mousedown",function(){n.\u0275\u0275restoreView(t);const s=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(s.setBlurLocked())})("blur",function(s){n.\u0275\u0275restoreView(t),n.\u0275\u0275nextContext();const g=n.\u0275\u0275reference(8),S=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(S.tryBlurToggle(s,g))}),n.\u0275\u0275elementEnd()}A&2&&(n.\u0275\u0275property("crtTooltip",n.\u0275\u0275pipeBind1(1,2,"RichTextEditor.SelectTemplate")),n.\u0275\u0275attribute("aria-label",n.\u0275\u0275pipeBind1(2,4,"RichTextEditor.SelectTemplate")))}function qe(A,i){if(A&1){const t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"mat-icon",28),n.\u0275\u0275pipe(1,"translate"),n.\u0275\u0275pipe(2,"translate"),n.\u0275\u0275listener("click",function(s){n.\u0275\u0275restoreView(t);const g=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(g.toggleToolbar(s.buttons===1&&s.isPrimary))})("focus",function(){n.\u0275\u0275restoreView(t);const s=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(s.setBlurLocked())})("blur",function(s){n.\u0275\u0275restoreView(t),n.\u0275\u0275nextContext();const g=n.\u0275\u0275reference(8),S=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(S.tryBlurToggle(s,g))})("keyup.enter",function(s){n.\u0275\u0275restoreView(t);const g=n.\u0275\u0275nextContext(2);return s.stopPropagation(),n.\u0275\u0275resetView(g.toggleToolbar(!0))})("mousedown",function(){n.\u0275\u0275restoreView(t);const s=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(s.setBlurLocked())}),n.\u0275\u0275elementEnd()}if(A&2){const t=n.\u0275\u0275nextContext(2);n.\u0275\u0275classMap("toggle-icon crt-input-icon toggle-"+(t.showToolbar?"selected":"default")),n.\u0275\u0275property("tooltipConfig",t.getToggleTooltipConfig(n.\u0275\u0275pipeBind1(1,4,"RichTextEditor.ToggleToolbar"))),n.\u0275\u0275attribute("aria-label",n.\u0275\u0275pipeBind1(2,6,"RichTextEditor.ToggleToolbar"))}}function et(A,i){A&1&&(n.\u0275\u0275element(0,"mat-icon",29),n.\u0275\u0275pipe(1,"translate")),A&2&&n.\u0275\u0275property("title",n.\u0275\u0275pipeBind1(1,1,"Input.Readonly"))}function tt(A,i){if(A&1&&(n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275element(1,"crt-icon-tooltip",30),n.\u0275\u0275elementContainerEnd()),A&2){const t=n.\u0275\u0275nextContext(2);n.\u0275\u0275advance(),n.\u0275\u0275property("tooltip",t.errorMessages)("ariaLabel",t.label)}}function nt(A,i){if(A&1&&n.\u0275\u0275element(0,"crt-icon-tooltip",32),A&2){const t=n.\u0275\u0275nextContext(3);n.\u0275\u0275property("tooltip",t.tooltip)("ariaLabel",t.label)}}function it(A,i){if(A&1&&n.\u0275\u0275template(0,nt,1,2,"crt-icon-tooltip",31),A&2){const t=n.\u0275\u0275nextContext(2);n.\u0275\u0275property("ngIf",t.tooltip)}}function ot(A,i){if(A&1&&(n.\u0275\u0275elementStart(0,"div",14)(1,"label",15),n.\u0275\u0275text(2),n.\u0275\u0275elementEnd()(),n.\u0275\u0275elementStart(3,"div",16)(4,"div",17)(5,"div",18),n.\u0275\u0275template(6,Xe,1,12,"ckeditor",19),n.\u0275\u0275elementStart(7,"div",20,3),n.\u0275\u0275template(9,Je,3,6,"mat-icon",21)(10,Ye,3,6,"mat-icon",22)(11,qe,3,8,"mat-icon",23)(12,et,2,3,"mat-icon",24)(13,tt,2,2,"ng-container",11)(14,it,1,1,"ng-template",null,4,n.\u0275\u0275templateRefExtractor),n.\u0275\u0275elementEnd()()()()),A&2){const t=n.\u0275\u0275reference(15),o=n.\u0275\u0275nextContext();n.\u0275\u0275advance(),n.\u0275\u0275property("ngClass",n.\u0275\u0275pureFunction1(16,He,o.isShownRequiredMark)),n.\u0275\u0275advance(),n.\u0275\u0275textInterpolate(o.label),n.\u0275\u0275advance(),n.\u0275\u0275property("ngClass","label-position-"+o.displayLabelPosition),n.\u0275\u0275advance(2),n.\u0275\u0275classProp("invalid",o.invalid)("readonly",o.readonly)("hasTooltip",o.tooltip),n.\u0275\u0275advance(),n.\u0275\u0275property("ngIf",o.control),n.\u0275\u0275advance(3),n.\u0275\u0275property("ngIf",o.showClip&&o.isFocused&&!o.readonly),n.\u0275\u0275advance(),n.\u0275\u0275property("ngIf",o.useTemplates&&o.isFocused&&!o.readonly),n.\u0275\u0275advance(),n.\u0275\u0275property("ngIf",o.isFocused&&!o.readonly),n.\u0275\u0275advance(),n.\u0275\u0275property("ngIf",o.readonly),n.\u0275\u0275advance(),n.\u0275\u0275property("ngIf",o.invalid)("ngIfElse",t)}}let W=class De extends O.j{get _useMentions(){return!!this.mentionsService||!!this._mentionsConfig}get showToolbar(){return this._showToolbar}set showToolbar(i){this._showToolbar=i,this._setToolbarVisibility(i),this.currentEditor?.fire?.("toggleToolbar",{display:i})}get editorConfig(){return this._editorConfig}set editorConfig(i){Object.assign(this._editorConfig,i)}get mentionsConfig(){return this._mentionsConfig||this._defaultMentionsConfig}set mentionsConfig(i){Object.assign(this._mentionsConfig,i)}set content(i){this.control.setValue(i)}constructor(i,t,o,s,g,S,w,V,q,te,Se,rt,st,at,lt,ct,dt,_t,ut){super(i,t),this.matDateLocale=o,this.window=s,this.ckeditorUrl=g,this.themeCssUrlSearchTemplate=S,this._messageDialogProvider=w,this._contactColorService=V,this._initialsService=q,this._currentTheme$=te,this._platform=Se,this._featureValues=rt,this._domPurifier=st,this._fileUploadProcessingService=at,this._fileIconService=lt,this._uploadService=ct,this._rightsService=dt,this._dialogService=_t,this._dialogOverrideService=ut,this._editorConfig={skin:"freedom",customConfig:"",toolbar:[["Format","-","CopyFormatting","Bold","Italic","Underline","Strike","-","TextColor","-","NumberedList","BulletedList","-","CreatioLink","CreatioImageFileUploadButton","CreatioFileUploadButton","CreatioVideo","CreatioTable","CrtTableOfContents","-","Blockquote","CodeSnippet","-","JustifyLeft","JustifyCenter","JustifyRight","-","Outdent","Indent","Expand","Collapse"]],extraPlugins:"creatioeditorplaceholder,expandcollapse,textmatch,autolink,link,creatiolink,imagebase,uploadimage,creatiouploadfile,creatioImageFileUpload,dragresize,creatiotabletools,tableresize,justify,copyformatting,indent,creatiofixedtoolbox,tableselection",removePlugins:"smiley,pagebreak,iframe,language,flash,image,magicline,scayt,editorplaceholder,imageresizerowandcolumn",format_tags:"p;h1;h2;h3",colorButton_enableMore:!1,context_menu:[],title:"",allowedContent:!0,removeButtons:"Link,Image",toolbarStartupExpanded:!1,enterMode:2,startupShowBorders:!1,entities_greek:!1,entities_latin:!1,disableNativeSpellChecker:!1,versionCheck:!1,codeSnippet_languages:{bash:"Bash",cpp:"C++",cs:"C#",css:"CSS",html:"HTML",http:"HTTP",java:"Java",javascript:"JavaScript",json:"JSON",php:"PHP",pgsql:"PostgreSQL",python:"Python",ruby:"Ruby",scss:"SCSS",sql:"SQL",typescript:"TypeScript",xml:"XML"}},this._toolbarClassName="crt-rich-text-editor-toolbar",this._defaultMentionsConfig={feed:(ht,pt)=>this._getMentions(ht.query,pt),itemTemplate:'<li data-id="{id}" data-qa="{id}-mention-option" class="mention-item"><span class="contact-no-photo" color="{color}" aria-hidden="true" style="background:{color}">{initials}</span><img src="{icon}">{name}<img src="{typeIcon}" class="user-type-icon"></li>',outputTemplate:'<a href="{pageUrl}" contentEditable="false" style="{styles}" data-value="{id}" mention-info="{contactDto}" data-mention-display-value="{name}" data-link="mention" target="_blank"><img style="{iconStyles}" src="{icon}"/><span color="{color}" style="{initialsStyles}">{shortInitials}</span>{name}</a>',minChars:0,marker:"@",throttle:0},this._uploadedFileClassName="file-download-link",this._uploadedFileNameAttribute="crt-uploaded-file-name",this._selectionDebounceDelay=250,this._primaryDataSchemaName="",this._showToolbar=!1,this._tooltipOffset=24,this._dialogIsShowing=!1,this._currentRecordChanged=!1,this._namespaceInitialized=!1,this._selectionDebounceFn=(0,Z.debounce)(this._onSelectionChange,this._selectionDebounceDelay),this._onDomSelectionChangeHandler=this._onDocumentSelectionChange.bind(this),this.isFocused=!1,this.isReady=!1,this.lockBlur=!1,this._isVideoSizeChanged=!1,this.plainTextChange=new n.EventEmitter,this.editorType="inline",this.needHandleSave=!0,this.alwaysShowToolbar=!1,this.filesStorage={masterRecordColumnValue:"$Id",recordEntitySchemaName:"",recordColumnName:"RecordId",entitySchemaName:"SysFile"},this.selectAttachments=new n.EventEmitter,this.selectionChange=new n.EventEmitter,this.selectTemplate=new n.EventEmitter,this.filesUploaded=new n.EventEmitter,this.useBodyFilesLinks=!0,this.editorBlur=new n.EventEmitter,this.editorFocus=new n.EventEmitter,this.editorValueChanged=new n.EventEmitter,this.newMention=new n.EventEmitter,this.editorUrl=g,this._sanitizeHtmlPipe=this.injector.get(U.b),this._matIconRegistry=this.injector.get(y.MatIconRegistry),this._mentionUtils=new Te(this._contactColorService,this._initialsService,this._matIconRegistry),this._selectionActionsPositionService=i.get(ie.O),this._copilotToEditorCommunicationService=i.get(j.i),this._selectionUtils=i.get(Me.O),this._schemaService=i.get(N.R),he.M.init(i)}_getCurrentEditor(i){let t=CKEDITOR.currentInstance;return this._isVideoSizeChanged&&t&&(t=i?.editor),t}_updateValue(i){const t=this._getCurrentEditor(i);i?.editor?.name===this.currentEditor?.name&&this._currentRecordId!==this.control.parent?.value?.Id&&(this._currentRecordId=this.control.parent?.value?.Id,this.currentEditor.schemaRecordId=this._currentRecordId,this._currentRecordChanged=!0),t?.name===this.currentEditor?.name&&(this._updateValueInControl(t),this._isVideoSizeChanged=!1),this.editorValueChanged.emit()}_resetUndoCache(){this.currentEditor&&this.currentEditor.resetUndo()}_updateValueInControl(i){const t=i.getData();this.control.setValue(t);const s=i.editable().$?.innerText;this.plainTextChange.emit(s),this._updateValidity()}_setSpellcheck(i,t){const o=i?.editable?.();o&&(typeof o.setAttribute=="function"?o.setAttribute("spellcheck",t):o.$&&typeof o.$.setAttribute=="function"&&o.$.setAttribute("spellcheck",t))}_setToolbarVisibility(i){const t=(this._lastEditor||window?.CKEDITOR?.currentInstance||this.currentEditor)?.name,o=document.getElementById("cke_"+t);o&&(i?(o.style.opacity="1",o.style.pointerEvents="auto",o.style.removeProperty("display"),this.alwaysShowToolbar||window.dispatchEvent(new Event("scroll"))):(o.style.opacity="0",o.style.display="none",o.style.pointerEvents="none"))}_updateValidity(){this.control.updateValueAndValidity(),this.control.markAsTouched()}_openUrl(i,t){i&&this.window.open(i,t)}_setContenteditable(i,t){i?.editable().$.setAttribute("contenteditable",t)}_subscribeBeforeDestroyEvent(i){i.editor.on("beforeDestroy",t=>{this.isReady=!1,this._hideTooltip(),t.editor.fire("blur"),this._unsubscribeFromSelectionChange(t.editor)},this)}_handleSelection(i){const t="selectable",o="selected",g=i.getSelection().getStartElement();g&&g.hasClass(t)?g.addClass(o):i.document.find(`.${t}.${o}`).toArray().forEach(S=>{S.removeClass(o)})}_subscribeEvents(i){const t=i.editor;CKEDITOR.on("ariaWidget",this.onPanelElementCreated.bind(this)),CKEDITOR.on("dialogDefinition",this._updateBaseDialogs.bind(this)),t.on("change",this._updateValue.bind(this)),t.on("insertHtml",this._onInsertHtml.bind(this)),t.on("fileUploadRequest",this._handleFileUploadRequest.bind(this)),t.on("CreatioImageClick",()=>this.lockBlur=!0,this),t.on("CreatioImageWindowClose",()=>this.lockBlur=!1,this),t.on("CreatioLinkClick",this._showTooltip.bind(this)),t.on("CreatioLinkDoubleClick",this._showTooltip.bind(this)),t.on("CreatioFileUploadFailed",this._removeFailedLink.bind(this)),t.on("beforeCommandExec",this._beforeCommandExec.bind(this)),t.on("selectionChange",this._handleSelection.bind(this,t)),he.M.subscribeEvents(t),t.document.on("keydown",this._handleKeyDownEvent.bind(this)),t.on("CreatioVideoClick",this._showVideoDialog.bind(this)),this._subscribeImageResize(t),this._subscribeToSelectionChange(t),t.container.$.addEventListener("contextmenu",function(o){o.stopPropagation()},!0)}_subscribeToSelectionChange(i){this.disableSelectionOptions||!this._featureValues.SelectionRewriteActions||(i.document.$.body.append(this.selectionActionsPanel.nativeElement),i.document.$.addEventListener("selectionchange",this._onDomSelectionChangeHandler))}_unsubscribeFromSelectionChange(i){this.disableSelectionOptions||!this._featureValues.SelectionRewriteActions||(i.document.$.removeEventListener("selectionchange",this._onDomSelectionChangeHandler),this.selectionActionsPanel?.nativeElement?.remove())}_onDocumentSelectionChange(){const i=this._selectionUtils.isEditorContainingSelection(this.currentEditor);(this.selectionActionsPanel.nativeElement.style.display==="unset"||i)&&this._selectionDebounceFn()}_handleKeyDownEvent(i){switch(i.data.$.key){case ce.Key.Backspace:case ce.Key.Delete:this._removeBRBeforeFile(i),this._removeAllZWS();break;default:break}}_updateBaseDialogs(i){const t=(CKEDITOR.currentInstance||this._lastEditor)?.name;t&&this._dialogOverrideService.overrideDialog(i,t)}_removeBRBeforeFile(i){const t=this.currentEditor.getSelection();if(!t)return;const s=t.getRanges()[0]?.getNextNode(),g=s?.$;if(g){const S=g.previousElementSibling?.tagName?.toUpperCase()==="BR"&&g.previousSibling?.wholeText?.length===0,w=s.hasClass?.("crt-file-wrapper"),V=g.nextElementSibling?.classList.contains("crt-file-wrapper"),q=g.nodeType===CKEDITOR.NODE_TEXT&&g.nodeValue?.length===0&&V,te=g.tagName?.toUpperCase()==="BR";S&&(w||q)?(g.previousElementSibling.remove(),i.data.preventDefault()):te&&V&&(s.remove(),i.data.preventDefault())}}_removeAllZWS(){const i=this.currentEditor?.editable()?.$;if(!i)return;const t=document.createTreeWalker(i,NodeFilter.SHOW_TEXT,{acceptNode:()=>NodeFilter.FILTER_ACCEPT});let o;for(;o=t.nextNode();)o.nodeValue.includes("\u200B")&&(o.nodeValue=o.nodeValue.replace(/\u200B/g,""))}_removeFailedLink(i){this._replaceUploadedFileContainer(i.editor,i.data.fileName,""),this._showErrorDialog("InfoDialog.FileUpload.InvalidRequestParams")}_validateFileUploadRequest(){var i=this;return(0,r.A)(function*(){if(i.filesStorage.entitySchemaName==="SysFile"&&i.filesStorage.recordColumnName==="RecordId")return!0;if(!i.filesStorage.masterRecordColumnValue||!i.filesStorage.entitySchemaName||!i.filesStorage.recordColumnName||!i.filesStorage.recordEntitySchemaName)return i._showErrorDialog("InfoDialog.FileUpload.InvalidRequestParams"),!1;const t=(yield(0,Q.lastValueFrom)(i._rightsService.getCanAdd([i.filesStorage.entitySchemaName]).pipe((0,le.catchError)(()=>(0,Q.of)([])))))[0];return t?.errorMessage&&i._showErrorDialog(t.errorMessage),t?.result})()}_handleFileUploadRequest(i){const{editor:t}=i,o=i?.data?.requestData?.upload?.file,s=i?.data?.fileLoader;s&&(s.abort=()=>{}),i.stop(),o&&(t.crtUploadingFiles=t.crtUploadingFiles||[],t.crtUploadingFiles.push(o)),!(t.crtPastedFiles?.length>t.crtUploadingFiles.length)&&(t.crtUploadingFiles=t.crtUploadingFiles.filter(g=>g.name&&this.currentEditor.editable().$?.innerText?.includes(g.name)),t.crtPastedFiles=[],this._processFilesUpload(t.crtUploadingFiles).then(g=>{t.crtUploadingFiles=[],t.uploadFilesData={readyToUploadFiles:t.uploadFilesData?.readyToUploadFiles||[],filesStorage:this.filesStorage,uploadEvent:i},g.forEach(S=>{const w=(0,u.qv)(),V=this._uploadService.getUploadUrl({fileEntitySchemaName:this.filesStorage.entitySchemaName,id:w});this._wrapFileLink(S.name,V),t.uploadFilesData.readyToUploadFiles.push({fileId:w,file:S})}),setTimeout(()=>{document.querySelectorAll(".crt-file-wrapper").forEach(S=>S.setAttribute("contenteditable","false"))},0),this.filesUploaded.emit(t.uploadFilesData?.readyToUploadFiles)}))}_processFilesUpload(i){var t=this;return(0,r.A)(function*(){let o;if(!(yield t._validateFileUploadRequest()))return i.forEach(V=>t._replaceUploadedFileContainer(t.currentEditor,V.name,"")),[];const s=yield t._fileUploadProcessingService.processSelectedFiles(i,null),g=s?.files?(0,Z.differenceBy)(i,s?.files,"name"):[],S=[];s?.errors?.length>0&&(o=t._fileUploadProcessingService.createFileErrorMessageForLogs(s.errors));for(const V of i)(yield t._fileUploadProcessingService.isFileExtensionDeny(V))&&S.push(V);if(S.length>0){const V=t._fileUploadProcessingService.createExtensionAttachmentsErrorMessage(S);o=o?`${V}\r
\r
${o}`:V}const w=[...g,...S];return s.files=(0,Z.differenceBy)(i,w,"name"),o&&(t._showErrorDialog(o),w.forEach(V=>t._replaceUploadedFileContainer(t.currentEditor,V.name,""))),t.useBodyFilesLinks||s.files.forEach(V=>t._replaceUploadedFileContainer(t.currentEditor,V.name,"")),s.files})()}_showErrorDialog(i){this._dialogIsShowing||(this._dialogIsShowing=!0,this._messageDialogProvider.error(i).pipe((0,Q.takeUntil)(this.destroyed$)).subscribe(()=>{this._dialogIsShowing=!1}))}_wrapFileLink(i,t){const o=this._fileIconService.getFileIcon(i);this._matIconRegistry.getNamedSvgIcon(o).pipe((0,le.catchError)(()=>(0,Q.of)(null)),(0,le.map)(s=>{let g="";s&&(s.classList.add(ne.E.fileIconImageCssClass),s.style.width="16px",s.style.height="16px",g=s.outerHTML);const S=`<a ${this._uploadedFileNameAttribute}="${i}" class="${this._uploadedFileClassName}" href="${t}" target="_self">${i}</a>`;return`<span contenteditable="false" class="crt-file-wrapper">${g}${S}</span> `}),(0,Q.takeUntil)(this.destroyed$)).subscribe(s=>{this._replaceUploadedFileContainer(this.currentEditor,i,s),this._moveCaretPositionAfterFileLink(i)})}_moveCaretPositionAfterFileLink(i){const t=this.currentEditor;if(!t?.document)return;const s=t.document?.find(`a[${this._uploadedFileNameAttribute}="${i}"]`)?.getItem(0)?.getParent()?.getNext();if(s){const g=t.getSelection?.();if(!g)return;const S=t.createRange?.();if(!S)return;S.setStart(s,1),S.setEnd(s,1),g.selectRanges?.([S])}}_replaceUploadedFileContainer(i,t,o){const g=i?.document?.$?.querySelector(`a[${this._uploadedFileNameAttribute}="${t}"]`)?.parentNode;g&&(g.parentNode?.querySelector?.("div[data-cke-hidden-sel]")?.remove?.(),g.outerHTML=o,this.currentEditor?.fire?.("change"))}_replaceAnchorTags(i){return i.replace(/<a[^>]*data-mention-display-value="([^"]*)"[^>]*>(.*?)<\/a>/gs,function(t,o){return o})}_subscribeImageResize(i){const t=o=>{["*"].includes(o.data.type)&&(o.data.dataValue="")};i.on("paste",o=>{const s=o.editor?.elementPath()?.lastElement;s&&(o.data.dataValue=this._replaceAnchorTags(o.data.dataValue),o.editor.sizeBeforePaste={width:s.getSize("width"),height:s.getSize("height")}),o.editor.crtPastedFiles=o.data?.dataTransfer?.$?.files,t(o)}),i.on("resizeComplete",o=>{const s=o.data.element;s.style.width&&s.style.removeProperty("max-width")})}_onInsertHtml(i){const t=i?.data?.dataValue,o=this._mentionUtils.getMentionsFromHtml(t);o&&o.length>0&&this.newMention.next(o);const g=i.editor?.elementPath?.()?.lastElement;(g?.find?g.find("img"):null)?.toArray?.().forEach(w=>{const V=w.getAttribute?.("src");if(!V)return;if(t?.includes?.(CKEDITOR.tools.htmlEncode(V))){const te=i.editor?.sizeBeforePaste?.width;typeof te=="number"&&te>20&&w.setStyle("max-width",`${te-20}px`)}})}_loadSkin(){const i=this._getDomElement(this.window.document,"head");if(i){const t=this.ckeditorUrl.replace("ckeditor.js","");ne.E.appendLink(i,t+"skins/freedom/editor.css")}}_overrideShowNotification(i){i.editor.showNotification=t=>{t&&(t=this._sanitizeHtmlPipe.transform(t,{mode:"textOnly",dataType:C.r.MAXSIZE_TEXT}),this._messageDialogProvider.info(t))}}_getDomElement(i,t){const o=i?.getElementsByTagName(t);return!o||o.length<1?null:o[0]}_restoreSelectionRanges(){this.currentEditor?.getSelection()?.selectRanges(this.currentEditor?.oldRanges||[])}_getMentions(i,t){this._mentionUtils.getMentionsWithDebounce(this.mentionsService,i,t)}_isFileLink(){const t=CKEDITOR.plugins.link.getSelectedLink(this.currentEditor,!0)?.[0]||null;return t?.is("a")&&t.hasClass(this._uploadedFileClassName)}_showTooltip(i){if(this._isFileLink())return;this.toggleLink(!0);const t=this.tooltipLink.nativeElement,o=i.editor.getSelectedRanges()[0];if(o){const s=o?.getClientRects()?.[0],g=i.editor.container.getClientRect(),S=(s?.x||0)-g.x,w=(s?.bottom||0)-g.y;t.style.left=`${S}px`,t.style.top=`${w}px`,t.click()}}_showVideoDialog(i){this._dialogService.open(re.Te,{data:{value:{editor:this.currentEditor,viewModel:this._viewModel,editorConfig:this.editorConfig,primaryDataSchemaName:this._primaryDataSchemaName}},panelClass:"rich-text-video-dialog",disableClose:!0,autoFocus:!1}).subscribe()}_hideTooltip(){this.tooltipLink.nativeElement.dispatchEvent(new Event("blur")),this.toggleLink(!1)}_sanitizeGlobalStyleTagContent(i){var t=this;return(0,r.A)(function*(){if(!i.data.sanitized&&!t._featureValues.DisableRemoveRichtextGlobalStyles){let o=i.data.dataValue;if(t._featureValues["RichTextEditor.InlineStyles"])try{const{default:g}=yield e.e(1372).then(e.t.bind(e,91372,23));o=g(o,{removeStyleTags:!0})}catch(g){console.error(`Error while inlining styles. Perhaps the input html document is not valid:
`+g)}const s=t._domPurifier.sanitize(o,{FORBID_TAGS:["style","base"],ADD_TAGS:["signature","iframe","video"],ADD_ATTR:["bodylimiter","crt-file-name"]});i.data.dataValue=s,i.data.sanitized=!0}})()}_disablePlugin(i,t,o){i()&&(this.editorConfig.toolbar[0]=this.editorConfig.toolbar[0].filter(s=>s!==o),this.editorConfig.extraPlugins=this.editorConfig.extraPlugins.replace(new RegExp(`${t},`,"g"),""))}_setAdditionalExtraPlugins(){this.extraPlugins&&this.extraPlugins.length>0&&(this.editorConfig.extraPlugins+=`,${this.extraPlugins.join(",")}`)}_subscribeInstanceCreated(){this._namespaceInitialized?this._namespaceInitialized=!0:CKEDITOR&&(CKEDITOR.disableAutoInline=!0,CKEDITOR.on("instanceCreated",i=>{i.editor.on("setData",t=>{this._sanitizeGlobalStyleTagContent(t)})}))}_getSelection(){const i=this.currentEditor;return i?i.getSelection():null}_onSelectionChange(){const t=this._getSelection()?.getSelectedText()??"";if((0,Z.isEmpty)(this.selection)&&this.selection===t)return;this.selectionChange.emit(t),this._selectionActionsPositionService.updatePosition(this.selectionActionsPanel,this.currentEditor?.container?.$)&&this._subscribeToHighlightSelection()}_subscribeToHighlightSelection(){this._copilotToEditorCommunicationService.subscribeToNotifications(this.currentEditor.id,i=>{if(!(!this.isReady||!this.currentEditor.editable))switch(i.editorAction){case H.u.SetHighlighting:this._selectionUtils.highlightSelection(this.currentEditor);break;case H.u.RemoveHighlighting:this._selectionUtils.removeHighlight(this.currentEditor),this._updateValueInControl(this.currentEditor);break;case G.U.Replace:case G.U.InsertAbove:case G.U.InsertBelow:this._selectionUtils.replaceSelection(this.currentEditor,i);break}})}_beforeCommandExec(i){i.data.name==="toolbarFocus"&&(this.showToolbar=!0,this.detectChanges())}isFocusingOutside(i,t){let o=!0;const s=i?.relatedTarget?.parentElement;return s&&(o=s!==t),o}_applyCustomTagsSupport(i){CKEDITOR?.dtd?.span&&CKEDITOR?.dtd?.div&&(CKEDITOR.dtd[i]={...CKEDITOR.dtd.span,div:1},CKEDITOR.dtd.$inline[i]=1,CKEDITOR.dtd.div[i]=1,CKEDITOR.dtd.$editable[i]=1)}onPanelElementCreated(i){const t=this._getDomElement(i.data.$.contentDocument,"head");if(t){const s=this.ckeditorUrl.replace("ckeditor.js","");ne.E.appendLink(t,s+"contents.css"),ne.E.appendLink(t,s+"skins/freedom/editor.css");const g=ne.E.getThemeCssLink(document,this.themeCssUrlSearchTemplate);g?ne.E.appendLink(t,g):console.warn(`Not found css-file by ${this.themeCssUrlSearchTemplate}`)}const o=this._getDomElement(i.data.$.contentDocument,"body");o&&(o.classList.contains(this._currentTheme.cssSelector)||o.classList.add(this._currentTheme.cssSelector))}handleFinishLoadViewModelAttributes(){super.handleFinishLoadViewModelAttributes(),this._currentRecordChanged&&(this._currentRecordChanged=!1,this._resetUndoCache())}ngOnInit(){this.editorConfig.name=this.name,this.editorConfig.language=this.matDateLocale?.split("-")[0],this.editorConfig.editorplaceholder=this.placeholder,this.editorConfig.fileStorageName=this.filesStorage.entitySchemaName,this.editorConfig.recordColumnName=this.filesStorage.recordColumnName,this.editorConfig.recordEntitySchemaName=this.filesStorage.recordEntitySchemaName,this._loadSkin(),this._useMentions&&(Object.assign(this.editorConfig,{mentions:[this.mentionsConfig]}),this.editorConfig.extraPlugins+=", mentions"),this._setAdditionalExtraPlugins(),this._disablePlugin(()=>!this.needHandleSave||!this._featureValues.UseRichTextUploadFile,"creatiouploadfile","CreatioFileUploadButton"),(0,J.$)(this.editorUrl).then(this._subscribeInstanceCreated.bind(this)),this._viewModel=this.control.parent?.value;const i=this._schemaService.schema?this._schemaService.getModelConfig():null;this._primaryDataSchemaName=i?i.dataSources[i.primaryDataSourceName]?.config?.entitySchemaName:""}ngAfterViewInit(){var i=()=>super.ngAfterViewInit,t=this;return(0,r.A)(function*(){i().call(t),t._currentTheme=yield(0,Q.firstValueFrom)(t._currentTheme$)})()}onEditorReady(i){i.editor.setActiveEnterMode(CKEDITOR.ENTER_DIV),this._applyCustomTagsSupport("signature"),this._subscribeEvents(i),i.editor.setReadOnly(this.readonly),this.editorName=i.editor.name;const t=document.querySelector(`#cke_${i.editor.name}.cke_float`);t?.classList.add(this._toolbarClassName),t?.classList.add("cdk-overlay-pane"),this.currentEditor=this._lastEditor=i.editor,i.editor.schemaRecordId=this._currentRecordId,i.editor.editable().changeAttr("aria-label",this.label),this._subscribeBeforeDestroyEvent(i),i.editor.needHandleSave=this.needHandleSave,this._overrideShowNotification(i),this.detectChanges(),this.isReady=!0}toggleLink(i){this.currentEditor.oldRanges=this.currentEditor.getSelectedRanges(),this._setToolbarVisibility(!i)}onEditorFocus(i){const t=document.querySelectorAll(":hover");if(t[t.length-1]instanceof HTMLAnchorElement){this._setContenteditable(i.editor,!1),this._setToolbarVisibility(!1);return}this.alwaysShowToolbar&&!this.readonly&&(this.showToolbar=!0),this.isFocused=!0,this.editorFocus.emit(),this.showToolbar?i.editor.focus():this._setToolbarVisibility(!1),this._setSpellcheck(i.editor,!0),this._selectionUtils.selectHighlighted(i.editor)}clearSelection(){this._selectionUtils.clearSelection(this.currentEditor)}focus(){this.currentEditor?.focus()}onEditorBlur(i){this._lastEditor=i.editor,i.editor?.editable()&&this._setSpellcheck(i.editor,!1),this.showToolbar=!1,this.lockBlur?i.stop():(this.isFocused&&(this.editorBlur.emit(),this.currentEditor?.focusManager?.blur?.(),this.isFocused=!1),this.readonly||(he.M.generateTableOfContents(this.currentEditor),this.currentEditor?.fire?.("change"),this._updateValidity()))}toggleToolbar(i=!1){this.lockBlur=!1,this.showToolbar=!this.showToolbar;const t=CKEDITOR.currentInstance||this._lastEditor;t?.focus(),i&&this.showToolbar&&t?.toolbox?.focus()}onClick(i){const t=i.target,o=t instanceof HTMLAnchorElement?t:t.parentElement;if(o instanceof HTMLAnchorElement&&!this.isFocused){const s=o.getAttribute("href");s&&(s.startsWith("#")||this._openUrl(s,o.target||"_blank"))}this.currentEditor?.readOnly||this._setContenteditable(CKEDITOR.currentInstance,!0)}tryBlurToggle(i,t){const o=this.isFocusingOutside(i,t);this.lockBlur&&o&&(this.lockBlur=!1,this.onEditorBlur({}))}onClipClicked(){this.selectAttachments.emit()}onSelectTemplateClicked(){this.selectTemplate.emit()}ngOnChanges(i){i.readonly&&this.currentEditor&&this.currentEditor.setReadOnly(i.readonly.currentValue)}removeReadyToUploadFile(i){const t=this.currentEditor?.uploadFilesData?.readyToUploadFiles;t&&(this.currentEditor.uploadFilesData.readyToUploadFiles=t.filter(o=>o.fileId!==i))}getLinkWindowTooltipConfig(){return new R.I({showEvent:"click",hideEvent:"blur",closeOnOutsideClick:!0,tooltipConfig:{value:{editor:this.currentEditor},onClose:this.onLinkWindowClosed.bind(this),onSave:this.onLinkSaved.bind(this),onUnlink:this.onLinkUnlink.bind(this)},preferredPositions:[{originX:"end",originY:"bottom",overlayX:"start",overlayY:"top",offsetY:this._tooltipOffset,offsetX:-this._tooltipOffset},{originX:"end",originY:"top",overlayX:"start",overlayY:"bottom",offsetY:-this._tooltipOffset,offsetX:-this._tooltipOffset}],componentType:fe.U})}getToggleTooltipConfig(i){return new R.I({showEvent:["focus","mouseenter"],hideEvent:["blur","mouseleave"],closeOnOutsideClick:!0,tooltipConfig:{value:i},componentType:f.x})}onLinkSaved(){this._hideTooltip(),this.focus(),this._updateValueInControl(this.currentEditor)}onLinkWindowClosed(){this.focus(),this._restoreSelectionRanges(),this._hideTooltip()}onLinkUnlink(){this._hideTooltip(),this._updateValueInControl(this.currentEditor)}onVideoSizeChanged(){this._isVideoSizeChanged=!0,this.currentEditor?.fire?.("change")}onBeforeUnload(){this._selectionUtils.removeHighlight(this.currentEditor),this._updateValueInControl(this.currentEditor)}setBlurLocked(){this.lockBlur=!0}tryCloseToolbar(i){this.showToolbar&&(this.showToolbar=!1,i?.stopPropagation())}static{this.\u0275fac=function(t){return new(t||De)(n.\u0275\u0275directiveInject(n.Injector),n.\u0275\u0275directiveInject(n.ChangeDetectorRef),n.\u0275\u0275directiveInject(M.MAT_DATE_LOCALE,8),n.\u0275\u0275directiveInject(v.ZP),n.\u0275\u0275directiveInject(X.i),n.\u0275\u0275directiveInject(se.C),n.\u0275\u0275directiveInject(T.r),n.\u0275\u0275directiveInject(F.d),n.\u0275\u0275directiveInject(L.j),n.\u0275\u0275directiveInject(z.C),n.\u0275\u0275directiveInject(l.Platform),n.\u0275\u0275directiveInject($.G),n.\u0275\u0275directiveInject(v.MV),n.\u0275\u0275directiveInject(K.T),n.\u0275\u0275directiveInject(x.H),n.\u0275\u0275directiveInject(Ee.H),n.\u0275\u0275directiveInject(E.f),n.\u0275\u0275directiveInject(d.o),n.\u0275\u0275directiveInject(ee))}}static{this.\u0275cmp=n.\u0275\u0275defineComponent({type:De,selectors:[["crt-rich-text-editor"]],viewQuery:function(t,o){if(t&1&&(n.\u0275\u0275viewQuery(We,5,n.ElementRef),n.\u0275\u0275viewQuery(je,5,n.ElementRef)),t&2){let s;n.\u0275\u0275queryRefresh(s=n.\u0275\u0275loadQuery())&&(o.tooltipLink=s.first),n.\u0275\u0275queryRefresh(s=n.\u0275\u0275loadQuery())&&(o.selectionActionsPanel=s.first)}},hostBindings:function(t,o){t&1&&n.\u0275\u0275listener("beforeunload",function(){return o.onBeforeUnload()},!1,n.\u0275\u0275resolveWindow)},inputs:{plainText:"plainText",extraPlugins:"extraPlugins",editorConfig:"editorConfig",mentionsConfig:"mentionsConfig",mentionsService:"mentionsService",editorType:"editorType",content:"content",editorUrl:"editorUrl",needHandleSave:"needHandleSave",alwaysShowToolbar:"alwaysShowToolbar",showClip:"showClip",useTemplates:"useTemplates",filesStorage:"filesStorage",selection:"selection",disableSelectionOptions:"disableSelectionOptions",useBodyFilesLinks:"useBodyFilesLinks",selectionActions:"selectionActions"},outputs:{plainTextChange:"plainTextChange",selectAttachments:"selectAttachments",selectionChange:"selectionChange",selectTemplate:"selectTemplate",filesUploaded:"filesUploaded",editorBlur:"editorBlur",editorFocus:"editorFocus",editorValueChanged:"editorValueChanged",newMention:"newMention"},features:[n.\u0275\u0275ProvidersFeature([b.I]),n.\u0275\u0275InheritDefinitionFeature,n.\u0275\u0275NgOnChangesFeature],ngContentSelectors:Ne,decls:11,vars:7,consts:[["selectionActionsPanel",""],["input",""],["tooltipLink",""],["iconsContainer",""],["tooltipIcon",""],[1,"rich-text-selection-actions"],[4,"ngTemplateOutlet"],[3,"label","minWidth",4,"ngIf"],[1,"crt-base-input-container"],["class","link-tooltip","crtTooltip","",3,"tooltipConfig",4,"ngIf"],["crtResizable","",1,"crt-input",3,"resized","ngClass","crtResizableDisabled"],[4,"ngIf","ngIfElse"],[3,"label","minWidth"],["crtTooltip","",1,"link-tooltip",3,"tooltipConfig"],[1,"crt-input-label-container"],["crtTextOverflowTitle","",1,"crt-input-label",3,"ngClass"],["floatLabel","never",1,"crt-input-control-container","rich-editor","mat-mdc-form-field",3,"ngClass"],[1,"crt-input-control"],[1,"rich-editor-wrapper"],["crtFullSizeImage","","crtBlockQuoteHighlight","","crtCodeSnippetHighlight","","crtVideoBlockResize","","class","rich-editor",3,"crtAnchorScrollHandler","ignoreImageClasses","toggleImageHandlers","resetHighlightCode","resetHighlightQuote","resetResizeVideo","enableSizeChanges","data","config","type","editorUrl","dataChange","configChange","ready","focus","blur","click","sizeChanged","keydown.escape",4,"ngIf"],[1,"icons"],["matSuffix","","class","clip-icon crt-input-icon","svgIcon","clip-filled","tabindex","0","role","button","aria-hidden","false",3,"crtTooltip","click","keyup.enter","mousedown","focus","blur",4,"ngIf"],["matSuffix","","svgIcon","select-template-icon","tabindex","0","role","button","aria-hidden","false","class","select-template-icon crt-input-icon",3,"crtTooltip","click","keyup.enter","focus","mousedown","blur",4,"ngIf"],["matSuffix","","crtTooltip","","tabindex","0","role","button","aria-hidden","false","svgIcon","richtext-toggle",3,"class","tooltipConfig","click","focus","blur","keyup.enter","mousedown",4,"ngIf"],["matSuffix","","svgIcon","lock","class","readonly-icon crt-input-icon",3,"title",4,"ngIf"],["crtFullSizeImage","","crtBlockQuoteHighlight","","crtCodeSnippetHighlight","","crtVideoBlockResize","",1,"rich-editor",3,"dataChange","configChange","ready","focus","blur","click","sizeChanged","keydown.escape","crtAnchorScrollHandler","ignoreImageClasses","toggleImageHandlers","resetHighlightCode","resetHighlightQuote","resetResizeVideo","enableSizeChanges","data","config","type","editorUrl"],["matSuffix","","svgIcon","clip-filled","tabindex","0","role","button","aria-hidden","false",1,"clip-icon","crt-input-icon",3,"click","keyup.enter","mousedown","focus","blur","crtTooltip"],["matSuffix","","svgIcon","select-template-icon","tabindex","0","role","button","aria-hidden","false",1,"select-template-icon","crt-input-icon",3,"click","keyup.enter","focus","mousedown","blur","crtTooltip"],["matSuffix","","crtTooltip","","tabindex","0","role","button","aria-hidden","false","svgIcon","richtext-toggle",3,"click","focus","blur","keyup.enter","mousedown","tooltipConfig"],["matSuffix","","svgIcon","lock",1,"readonly-icon","crt-input-icon",3,"title"],["type","error",3,"tooltip","ariaLabel"],[3,"tooltip","ariaLabel",4,"ngIf"],[3,"tooltip","ariaLabel"]],template:function(t,o){if(t&1){const s=n.\u0275\u0275getCurrentView();n.\u0275\u0275projectionDef(),n.\u0275\u0275elementStart(0,"div",5,0),n.\u0275\u0275projection(2),n.\u0275\u0275template(3,ze,1,0,"ng-container",6),n.\u0275\u0275elementEnd(),n.\u0275\u0275template(4,Ze,1,2,"crt-base-input-width-holder",7),n.\u0275\u0275elementStart(5,"div",8),n.\u0275\u0275template(6,Qe,2,1,"div",9),n.\u0275\u0275elementStart(7,"div",10),n.\u0275\u0275listener("resized",function(S){return n.\u0275\u0275restoreView(s),n.\u0275\u0275resetView(o.onResized(S))}),n.\u0275\u0275template(8,Ge,1,0,"crt-skeleton-loader",11)(9,ot,16,18,"ng-template",null,1,n.\u0275\u0275templateRefExtractor),n.\u0275\u0275elementEnd()()}if(t&2){const s=n.\u0275\u0275reference(10);n.\u0275\u0275advance(3),n.\u0275\u0275property("ngTemplateOutlet",o.selectionActions),n.\u0275\u0275advance(),n.\u0275\u0275property("ngIf",o.displayLabelPosition==="auto"),n.\u0275\u0275advance(2),n.\u0275\u0275property("ngIf",!o.loaderVisible),n.\u0275\u0275advance(),n.\u0275\u0275property("ngClass","label-position-"+o.displayLabelPosition+" appearance-"+o.appearance)("crtResizableDisabled",!o.isAutoLabelPosition||o.containerQueryMechanismAvailable),n.\u0275\u0275advance(),n.\u0275\u0275property("ngIf",o.loaderVisible)("ngIfElse",s)}},dependencies:[Y.NgClass,Y.NgIf,Y.NgTemplateOutlet,Ue.CKEditorComponent,y.MatIcon,Oe.W,Pe.d,Ie.b,ae.MatSuffix,Be.C,pe.q,oe.w,be.E,we.x,Ve.i,Fe.S,ke.y,Ke.TranslatePipe],styles:["body[_ngcontent-%COMP%]{--focus-outline-outer-color: var(--crt-palette-secondary-500);--focus-outline-inner-color: white}[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   .link-tooltip[_ngcontent-%COMP%], [_nghost-%COMP%]   .video-tooltip[_ngcontent-%COMP%]{width:0px;height:0px;position:relative}[_nghost-%COMP%]   .crt-input-control-container.rich-editor[_ngcontent-%COMP%]{pointer-events:none}[_nghost-%COMP%]   .crt-input-control-container.rich-editor[_ngcontent-%COMP%]   .crt-input-control[_ngcontent-%COMP%]{pointer-events:none}[_nghost-%COMP%]   .crt-input-control-container.rich-editor[_ngcontent-%COMP%]   .crt-input-control[_ngcontent-%COMP%]   .rich-editor[_ngcontent-%COMP%]{pointer-events:auto}[_nghost-%COMP%]   .rich-editor[_ngcontent-%COMP%]{width:100%;overflow:auto}[_nghost-%COMP%]   .rich-editor-wrapper[_ngcontent-%COMP%]{width:100%;float:left;overflow:hidden;display:flex;position:relative}[_nghost-%COMP%]   .rich-editor-wrapper.hasTooltip[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%]{min-width:48px;max-width:48px}[_nghost-%COMP%]   .rich-editor-wrapper[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%]{display:flex;align-self:flex-end;justify-content:flex-end;padding:0 0 4px;min-width:24px;max-width:24px;pointer-events:auto}[_nghost-%COMP%]   .rich-editor-wrapper[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%]   .select-template-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .rich-editor-wrapper[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%]   .clip-icon[_ngcontent-%COMP%]{cursor:pointer;color:var(--crt-palette-secondary-500)}[_nghost-%COMP%]   .rich-editor-wrapper[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%]   .select-template-icon[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .rich-editor-wrapper[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%]   .clip-icon[_ngcontent-%COMP%]:hover{color:var(--crt-palette-primary-500)}[_nghost-%COMP%]   .rich-editor-wrapper[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%]   .toggle-icon[_ngcontent-%COMP%]{cursor:pointer}[_nghost-%COMP%]   .rich-editor-wrapper[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%]   .toggle-icon[_ngcontent-%COMP%]   .hover-tooltip[_ngcontent-%COMP%]{width:100%;height:100%;position:relative;bottom:var(--crt-body-2-line-height)}[_nghost-%COMP%]   .rich-editor-wrapper[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{max-width:16px;max-height:16px}[_nghost-%COMP%]   .rich-editor-wrapper[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]:focus-visible{box-shadow:inset 0 0 0 1px var(--focus-outline-outer-color),inset 0 0 0 2px var(--focus-outline-inner-color);outline:none;border-radius:4px}.rich-text-selection-actions[_ngcontent-%COMP%]{position:fixed;display:none;z-index:2010}","body[_ngcontent-%COMP%]{--focus-outline-outer-color: var(--crt-palette-secondary-500);--focus-outline-inner-color: white}[_nghost-%COMP%]{max-width:100%}.crt-base-edit-input-responsible[_nghost-%COMP%]   .crt-base-input-container[_ngcontent-%COMP%]{container-type:inline-size}@container (width <= 320px){[_nghost-%COMP%]   .crt-input.label-position-auto[_ngcontent-%COMP%]{min-height:52px;flex-direction:column;padding-top:0}[_nghost-%COMP%]   .crt-input.label-position-auto[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .crt-input.label-position-auto[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]   .crt-input-label[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-top:8px}[_nghost-%COMP%]   .crt-input.label-position-auto.appearance-outline[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]{margin-bottom:8px}}@container (width > 320px){[_nghost-%COMP%]   .crt-input.label-position-auto[_ngcontent-%COMP%]{min-height:32px;flex-direction:row;padding-top:8px}[_nghost-%COMP%]   .crt-input.label-position-auto[_ngcontent-%COMP%]   .crt-input-control-container[_ngcontent-%COMP%]{align-self:baseline}[_nghost-%COMP%]   .crt-input.label-position-auto[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]{margin-inline-end:10px;display:flex;align-items:flex-start;align-self:baseline;word-break:break-word;width:136px;min-width:136px}[_nghost-%COMP%]   .crt-input.label-position-auto[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]   .crt-input-label[_ngcontent-%COMP%]{width:100%;margin:9px 0 4px;display:-webkit-box;overflow:hidden;-webkit-line-clamp:2;-webkit-box-orient:vertical}}[_nghost-%COMP%]   .crt-input[_ngcontent-%COMP%]{overflow:hidden;padding-bottom:1px}[_nghost-%COMP%]   .crt-input.label-position-left[_ngcontent-%COMP%], [_nghost-%COMP%]   .crt-input.label-position-hidden[_ngcontent-%COMP%]{min-height:32px;flex-direction:row;padding-top:8px}[_nghost-%COMP%]   .crt-input.label-position-left[_ngcontent-%COMP%]   .crt-input-control-container[_ngcontent-%COMP%], [_nghost-%COMP%]   .crt-input.label-position-hidden[_ngcontent-%COMP%]   .crt-input-control-container[_ngcontent-%COMP%]{align-self:baseline}[_nghost-%COMP%]   .crt-input.label-position-left[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%], [_nghost-%COMP%]   .crt-input.label-position-hidden[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]{margin-inline-end:10px;display:flex;align-items:flex-start;align-self:baseline;word-break:break-word;width:136px;min-width:136px}[_nghost-%COMP%]   .crt-input.label-position-left[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]   .crt-input-label[_ngcontent-%COMP%], [_nghost-%COMP%]   .crt-input.label-position-hidden[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]   .crt-input-label[_ngcontent-%COMP%]{width:100%;margin:9px 0 4px;display:-webkit-box;overflow:hidden;-webkit-line-clamp:2;-webkit-box-orient:vertical}[_nghost-%COMP%]   .crt-input.label-position-above[_ngcontent-%COMP%]{min-height:52px;flex-direction:column;padding-top:0}[_nghost-%COMP%]   .crt-input.label-position-above[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .crt-input.label-position-above[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]   .crt-input-label[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-top:8px}[_nghost-%COMP%]   .crt-input.label-position-above.appearance-outline[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]{margin-bottom:8px}[_nghost-%COMP%]   .crt-input.label-position-hidden[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]{width:0;min-width:0;margin:0}[_nghost-%COMP%]   .crt-input.label-position-hidden[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]   .crt-input-label[_ngcontent-%COMP%]{height:0;color:transparent}[_nghost-%COMP%]   .crt-input[_ngcontent-%COMP%]   .crt-input-control[_ngcontent-%COMP%]   .inner-tools-panel[_ngcontent-%COMP%]{opacity:1;display:inline-flex;flex-direction:row;flex-wrap:nowrap;justify-content:flex-end;align-items:center}[_nghost-%COMP%]   .crt-input[_ngcontent-%COMP%]:not(:hover)   .readonly-icon[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .crt-input[_ngcontent-%COMP%], [_nghost-%COMP%]   .crt-input[_ngcontent-%COMP%]   .crt-input-control[_ngcontent-%COMP%]{display:flex;padding-inline-end:2px}[_nghost-%COMP%]   .crt-input[_ngcontent-%COMP%]   textarea.mat-mdc-input-element[_ngcontent-%COMP%]{padding:0;margin:0}[_nghost-%COMP%]   .crt-input-control[_ngcontent-%COMP%]{display:flex;align-items:center;padding-inline-end:2px}"]})}};(0,a.__decorate)([(0,p.k)(),(0,a.__metadata)("design:type",String)],W.prototype,"plainText",void 0),(0,a.__decorate)([(0,p.k)(),(0,a.__metadata)("design:type",Array)],W.prototype,"extraPlugins",void 0),(0,a.__decorate)([(0,c.j)(),(0,a.__metadata)("design:type",Object)],W.prototype,"plainTextChange",void 0),(0,a.__decorate)([(0,p.k)(),(0,a.__metadata)("design:type",Object),(0,a.__metadata)("design:paramtypes",[Object])],W.prototype,"editorConfig",null),(0,a.__decorate)([(0,p.k)(),(0,a.__metadata)("design:type",Object),(0,a.__metadata)("design:paramtypes",[Object])],W.prototype,"mentionsConfig",null),(0,a.__decorate)([(0,p.k)(),(0,a.__metadata)("design:type",Object)],W.prototype,"mentionsService",void 0),(0,a.__decorate)([(0,p.k)(),(0,a.__metadata)("design:type",String)],W.prototype,"editorType",void 0),(0,a.__decorate)([(0,p.k)(),(0,a.__metadata)("design:type",Object),(0,a.__metadata)("design:paramtypes",[Object])],W.prototype,"content",null),(0,a.__decorate)([(0,p.k)(),(0,a.__metadata)("design:type",String)],W.prototype,"editorUrl",void 0),(0,a.__decorate)([(0,p.k)(),(0,a.__metadata)("design:type",Object)],W.prototype,"needHandleSave",void 0),(0,a.__decorate)([(0,p.k)(),(0,a.__metadata)("design:type",Object)],W.prototype,"alwaysShowToolbar",void 0),(0,a.__decorate)([(0,p.k)(),(0,a.__metadata)("design:type",Boolean)],W.prototype,"showClip",void 0),(0,a.__decorate)([(0,p.k)(),(0,a.__metadata)("design:type",Boolean)],W.prototype,"useTemplates",void 0),(0,a.__decorate)([(0,p.k)(),(0,a.__metadata)("design:type",Object)],W.prototype,"filesStorage",void 0),(0,a.__decorate)([(0,c.j)(),(0,a.__metadata)("design:type",Object)],W.prototype,"selectAttachments",void 0),(0,a.__decorate)([(0,p.k)(),(0,a.__metadata)("design:type",String)],W.prototype,"selection",void 0),(0,a.__decorate)([(0,c.j)(),(0,a.__metadata)("design:type",Object)],W.prototype,"selectionChange",void 0),(0,a.__decorate)([(0,p.k)(),(0,a.__metadata)("design:type",Boolean)],W.prototype,"disableSelectionOptions",void 0),(0,a.__decorate)([(0,c.j)(),(0,a.__metadata)("design:type",Object)],W.prototype,"selectTemplate",void 0),(0,a.__decorate)([(0,c.j)(),(0,a.__metadata)("design:type",Object)],W.prototype,"filesUploaded",void 0),(0,a.__decorate)([(0,p.k)(),(0,a.__metadata)("design:type",Object)],W.prototype,"useBodyFilesLinks",void 0),(0,a.__decorate)([(0,c.j)(),(0,a.__metadata)("design:type",Object)],W.prototype,"editorBlur",void 0),(0,a.__decorate)([(0,c.j)(),(0,a.__metadata)("design:type",Object)],W.prototype,"editorFocus",void 0),(0,a.__decorate)([(0,c.j)(),(0,a.__metadata)("design:type",Object)],W.prototype,"editorValueChanged",void 0),(0,a.__decorate)([(0,c.j)(),(0,a.__metadata)("design:type",Object)],W.prototype,"newMention",void 0),W=(0,a.__decorate)([(0,_.v)({type:"crt.RichTextEditor",contentSlots:["selectionActions"],formControlConfig:{relatesTo:"control"},reuseStrategy:m.B.Reuse}),(0,h.f)({toolbarConfig:{groupType:I.h.Inputs,position:41,icon:e(14560),defaultPropertyValues:{label:"",control:"",labelPosition:"auto",placeholder:"",tooltip:"",needHandleSave:!0,filesStorage:{masterRecordColumnValue:"$Id",entitySchemaName:"SysFile",recordColumnName:"RecordId",recordEntitySchemaName:""}},defaultLocalizableStrings:{caption:"Components.RichTextEditor.Caption",label:"Components.RichTextEditor.Caption"}},dataValueTypes:[C.r.RICH_TEXT],propertiesPanelComponentTypeName:"crt.RichTextPropertiesPanel",viewElementGroupType:P.J.Inputs,typeCaption:"Components.RichTextEditor.Caption"}),(0,a.__metadata)("design:paramtypes",[n.Injector,n.ChangeDetectorRef,String,Window,String,String,T.r,F.d,L.j,Q.Observable,l.Platform,k.x,Function,K.T,x.H,Ee.H,E.f,d.o,ee])],W)},3214:(B,D,e)=>{e.d(D,{U:()=>R});var r=e(5960),a=e(22307),l=e(59247),n=e(1034),M=e(79772),y=e(59969),u=e(62278),C=e(36486);class p{static{this.nameRegexPattern="^[a-zA-Z][a-zA-Z0-9._]*$"}static nameValidator(){return l.Validators.pattern(this.nameRegexPattern)}static linkValidator(){return l.Validators.pattern(/^[A-Za-z][A-Za-z\d.+-]*:\/*(?:\w+(?::\w+)?@)?[^\s/]+(?::\d+)?(?:\/[\w#!:.?+=&%@\-,~]*)*(?:\?[\w#!:.?+=&%@\-,~]*)?(?:#(?:[:~\w#!:.?+=&%@\-,]*)*)?$/)}static debounceValidator(d){return v=>(0,u.timer)(400).pipe((0,C.switchMap)(()=>d(v.value)))}static requiredWithPrefix(d){return v=>{const E=v.value,x=E?.startsWith(d);return d&&x?E.replace(d,"")?null:{requiredWithPrefix:{prefix:d}}:null}}static prefix(d){return v=>d&&!v.value?.startsWith(d)?{prefix:{requiredPrefix:d}}:null}static duplicate(d){return v=>{if(d){const E=d.map(O=>O.toLowerCase()),x=v.value?.toLowerCase();if(E.some(O=>x===O))return{duplicate:!0}}return null}}static duplicateAsync(d){return v=>d.pipe((0,C.map)(E=>{if(E){const x=E.map(T=>T.toLowerCase()),O=v.value?.toLowerCase();if(x.some(T=>O===T))return{duplicate:!0}}return null}))}}var c=e(97998),_=e(18046),m=e(67057),h=e(13232),I=e(19344);function P(f,d){if(f&1){const v=a.\u0275\u0275getCurrentView();a.\u0275\u0275elementStart(0,"crt-button",9),a.\u0275\u0275pipe(1,"translate"),a.\u0275\u0275listener("clicked",function(){a.\u0275\u0275restoreView(v);const x=a.\u0275\u0275nextContext();return a.\u0275\u0275resetView(x.unlink())}),a.\u0275\u0275elementEnd()}f&2&&a.\u0275\u0275property("caption",a.\u0275\u0275pipeBind1(1,1,"RichTextEditorLink.UnlinkLinkButtonCaption"))}let R=class Re{get linkControl(){return this.richTextLinkForm.get("linkControl")}get displayTextControl(){return this.richTextLinkForm.get("displayTextControl")}get editor(){return this._editor}set editor(d){!this._isEditorInitialize&&d&&(this._editor=d,this._isEditorInitialize=!0)}set tooltipConfig(d){this.editor=d.value.editor,this._tooltipConfig=d}constructor(d,v,E,x,O,T){this._translate=d,this.window=v,this._changeDetector=E,this._injector=x,this._crtControlStateAdapter=O,this._element=T,this._isEditorInitialize=!1,this.isUnlinkButtonVisible=!1,this.richTextLinkForm=new l.FormGroup({linkControl:new l.FormControl("",{validators:[this._crtControlStateAdapter.transform({instance:new c.Y(this._injector)}),this._createLinkPatternValidatorFn.bind(this)]}),displayTextControl:new l.FormControl("",{})})}_clearFields(){this.linkControl.reset(),this.linkControl.setErrors(null),this.linkControl.updateValueAndValidity(),this.displayTextControl.setValue(""),this.displayTextControl.updateValueAndValidity()}_createLinkPatternValidatorFn(d){return p.linkValidator()(d)!==null?this._createValidatorErrorsMessage("InvalidLink","Validators.Link.Message"):null}_createValidatorErrorsMessage(d,v){return{[d]:{message:this._translate.instant(`${v}`)}}}_initialize(){if(!this.editor)return;const d=this.editor.getSelection()?.getSelectedText(),v=CKEDITOR.plugins.link.getSelectedLink(this.editor,!0),E=v?.[0]||null;E?.is("a")?(this.displayTextControl.setValue(E.$.innerText),this.linkControl.setValue(E.getAttribute("href"))):d&&this.displayTextControl.setValue(d),this.isUnlinkButtonVisible=v?.length>0,this._changeDetector.detectChanges(),this.focusLink()}focusLink(){setTimeout(()=>this._element.nativeElement.querySelector(".rich-text-link-container .rich-text-link-field input").focus(),0)}closeLink(){this._clearFields(),this._tooltipConfig?.onClose?.()}openLink(){this.window.open(this.linkControl.value,"_blank")}unlink(){this.editor.execCommand("unlink"),this._tooltipConfig?.onUnlink?.()}save(){if(this.richTextLinkForm.updateValueAndValidity(),this.richTextLinkForm.valid){const d={url:this.linkControl.value,linkText:this.displayTextControl.value};CKEDITOR.plugins.creatiolink.insertOrUpdateLink(d,this.editor),this._clearFields(),this._tooltipConfig?.onSave?.()}}ngOnInit(){this._initialize()}static{this.\u0275fac=function(v){return new(v||Re)(a.\u0275\u0275directiveInject(M.TranslateService),a.\u0275\u0275directiveInject(y.ZP),a.\u0275\u0275directiveInject(a.ChangeDetectorRef),a.\u0275\u0275directiveInject(a.Injector),a.\u0275\u0275directiveInject(_.f),a.\u0275\u0275directiveInject(a.ElementRef))}}static{this.\u0275cmp=a.\u0275\u0275defineComponent({type:Re,selectors:[["crt-rich-text-link"]],inputs:{editor:"editor"},decls:14,vars:25,consts:[[1,"rich-text-link-page"],[1,"rich-text-link-container"],["data-qa","input-link",1,"rich-text-link-field",3,"keyup.enter","control","labelPosition","appearance","label"],["data-qa","input-displayText",3,"keyup.enter","control","labelPosition","appearance","label"],[1,"link-button-container"],["iconPosition","left-icon","icon","open-link","size","small","displayType","text","color","default",1,"open-link-button","link-button",3,"clicked","disabled","caption"],["class","unlink-link-button link-button","iconPosition","left-icon","icon","unlink-link","size","small","displayType","text","color","default",3,"caption","clicked",4,"ngIf"],["iconPosition","left-icon","icon","close-link","size","small","displayType","text","color","default",1,"close-link-button","link-button",3,"clicked","caption"],["icon","save-link","size","small","displayType","text","color","default",1,"save-link-button","link-button",3,"clicked","disabled","iconPosition","caption"],["iconPosition","left-icon","icon","unlink-link","size","small","displayType","text","color","default",1,"unlink-link-button","link-button",3,"clicked","caption"]],template:function(v,E){v&1&&(a.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"crt-input",2),a.\u0275\u0275pipe(3,"translate"),a.\u0275\u0275listener("keyup.enter",function(){return E.save()}),a.\u0275\u0275elementEnd(),a.\u0275\u0275elementStart(4,"crt-input",3),a.\u0275\u0275pipe(5,"translate"),a.\u0275\u0275listener("keyup.enter",function(){return E.save()}),a.\u0275\u0275elementEnd(),a.\u0275\u0275elementStart(6,"div",4)(7,"crt-button",5),a.\u0275\u0275pipe(8,"translate"),a.\u0275\u0275listener("clicked",function(){return E.openLink()}),a.\u0275\u0275elementEnd(),a.\u0275\u0275template(9,P,2,3,"crt-button",6),a.\u0275\u0275elementStart(10,"crt-button",7),a.\u0275\u0275pipe(11,"translate"),a.\u0275\u0275listener("clicked",function(){return E.closeLink()}),a.\u0275\u0275elementEnd(),a.\u0275\u0275elementStart(12,"crt-button",8),a.\u0275\u0275pipe(13,"translate"),a.\u0275\u0275listener("clicked",function(){return E.save()}),a.\u0275\u0275elementEnd()()()()),v&2&&(a.\u0275\u0275advance(2),a.\u0275\u0275property("control",E.richTextLinkForm.controls.linkControl)("labelPosition","above")("appearance","legacy")("label",a.\u0275\u0275pipeBind1(3,15,"RichTextEditorLink.LinkLabelCaption")),a.\u0275\u0275advance(2),a.\u0275\u0275property("control",E.richTextLinkForm.controls.displayTextControl)("labelPosition","above")("appearance","legacy")("label",a.\u0275\u0275pipeBind1(5,17,"RichTextEditorLink.TextLabelCaption")),a.\u0275\u0275advance(3),a.\u0275\u0275property("disabled",E.linkControl.invalid)("caption",a.\u0275\u0275pipeBind1(8,19,"RichTextEditorLink.OpenLinkButtonCaption")),a.\u0275\u0275advance(2),a.\u0275\u0275property("ngIf",E.isUnlinkButtonVisible),a.\u0275\u0275advance(),a.\u0275\u0275property("caption",a.\u0275\u0275pipeBind1(11,21,"RichTextEditorLink.CloseLinkButtonCaption")),a.\u0275\u0275advance(2),a.\u0275\u0275property("disabled",E.richTextLinkForm.invalid)("iconPosition","left-icon")("caption",a.\u0275\u0275pipeBind1(13,23,"RichTextEditorLink.SaveLinkButtonCaption")))},dependencies:[m.NgIf,h.B,I.j,M.TranslatePipe],styles:[".rich-text-link-page[_ngcontent-%COMP%]{width:500px;box-shadow:0 2px 4px #0003;border-radius:4px;padding:16px 16px 0}.link-button-container[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:center;justify-content:right;margin:12px 0}"]})}};R=(0,r.__decorate)([(0,n.v)({type:"crt.RichTextLinkComponent"}),(0,r.__metadata)("design:paramtypes",[M.TranslateService,Window,a.ChangeDetectorRef,a.Injector,_.f,a.ElementRef])],R)},9843:(B,D,e)=>{e.d(D,{_:()=>_});var r=e(22307),a=e.n(r),l=e(59247),n=e.n(l),M=e(62278),y=e.n(M),u=e(12444),C=e(19344),p=e(79772),c=e.n(p);class _ extends u.lx{constructor(){super(...arguments),this.embededControl=new l.FormControl("",{})}purifyEmbedCode(h){const R=new DOMParser().parseFromString(h,"text/html").getElementsByTagName("iframe");if(R.length===0)return"";const f=R[0];return f.style.position="relative",f.outerHTML}hasUnsavedChanges(){return this.embededControl.value}onSaveClick(){this.videoUploaded.emit(this.purifyEmbedCode(this.embededControl.value))}ngOnInit(){this.embededControl.valueChanges.pipe((0,M.takeUntil)(this.destroy$)).subscribe(h=>{this.valueChanged.emit(h)})}static{this.\u0275fac=(()=>{let h;return function(P){return(h||(h=r.\u0275\u0275getInheritedFactory(_)))(P||_)}})()}static{this.\u0275cmp=r.\u0275\u0275defineComponent({type:_,selectors:[["crt-rich-text-embed-video"]],features:[r.\u0275\u0275ProvidersFeature([{provide:u.lx,useExisting:(0,r.forwardRef)(()=>_)}]),r.\u0275\u0275InheritDefinitionFeature],decls:2,vars:7,consts:[[1,"rich-text-video__input",3,"control","labelPosition","appearance","placeholder","multiline"]],template:function(I,P){I&1&&(r.\u0275\u0275element(0,"crt-input",0),r.\u0275\u0275pipe(1,"translate")),I&2&&r.\u0275\u0275property("control",P.embededControl)("labelPosition","hidden")("appearance","outline")("placeholder",r.\u0275\u0275pipeBind1(1,5,"RichTextEditorVideo.InputPlaceholder"))("multiline",!0)},dependencies:[C.j,p.TranslatePipe],styles:[".rich-text-video[_ngcontent-%COMP%]{height:100%;border-radius:8px;padding:24px 32px 0}.rich-text-video__header[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between;width:100%;padding-bottom:16px}.rich-text-video__input[_ngcontent-%COMP%]{margin-top:1px;display:block;height:154px}.rich-text-video__buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;flex-flow:row nowrap;margin-top:16px;margin-bottom:32px}.rich-text-video__buttons_action[_ngcontent-%COMP%]{margin-left:16px}.rich-text-video__buttons_upload[_ngcontent-%COMP%]{margin-top:8px;margin-bottom:16px}"]})}}},75959:(B,D,e)=>{e.d(D,{i:()=>z});var r=e(22307),a=e.n(r),l=e(6530),n=e(79772),M=e.n(n),y=e(62278),u=e.n(y),C=e(12444),p=e(22592),c=e(6503),_=e(26628),m=e(83455),h=e(44945),I=e(54918),P=e(51025),R=e(67057),f=e.n(R),d=e(13232),v=e(37851),E=e.n(v),x=e(66459),O=e.n(x),T=e(22817),b=e(48264),U=e(59834);const j=["videoInput"];function H($,F){if($&1){const L=r.\u0275\u0275getCurrentView();r.\u0275\u0275elementContainerStart(0),r.\u0275\u0275element(1,"crt-placeholder",7),r.\u0275\u0275pipe(2,"translate"),r.\u0275\u0275elementStart(3,"crt-button",8),r.\u0275\u0275pipe(4,"translate"),r.\u0275\u0275listener("clicked",function(){r.\u0275\u0275restoreView(L);const K=r.\u0275\u0275nextContext();return r.\u0275\u0275resetView(K.onUploadClick())}),r.\u0275\u0275text(5),r.\u0275\u0275pipe(6,"translate"),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementContainerEnd()}$&2&&(r.\u0275\u0275advance(),r.\u0275\u0275property("image",null)("subhead",r.\u0275\u0275pipeBind1(2,4,"RichTextEditorVideo.DragAndDropPlaceholder")),r.\u0275\u0275advance(2),r.\u0275\u0275property("title",r.\u0275\u0275pipeBind1(4,6,"RichTextEditorVideo.UploadButton")),r.\u0275\u0275advance(2),r.\u0275\u0275textInterpolate1(" ",r.\u0275\u0275pipeBind1(6,8,"RichTextEditorVideo.UploadButton")," "))}function G($,F){if($&1){const L=r.\u0275\u0275getCurrentView();r.\u0275\u0275elementStart(0,"div",9),r.\u0275\u0275element(1,"mat-icon",10),r.\u0275\u0275elementStart(2,"span",11),r.\u0275\u0275text(3),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(4,"span",12),r.\u0275\u0275text(5),r.\u0275\u0275pipe(6,"memoryFormat"),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(7,"mat-icon",13),r.\u0275\u0275pipe(8,"translate"),r.\u0275\u0275listener("keydown.enter",function(){r.\u0275\u0275restoreView(L);const K=r.\u0275\u0275nextContext();return r.\u0275\u0275resetView(K.onClearClick())})("keydown.space",function(){r.\u0275\u0275restoreView(L);const K=r.\u0275\u0275nextContext();return r.\u0275\u0275resetView(K.onClearClick())})("click",function(){r.\u0275\u0275restoreView(L);const K=r.\u0275\u0275nextContext();return r.\u0275\u0275resetView(K.onClearClick())}),r.\u0275\u0275elementEnd()()}if($&2){const L=r.\u0275\u0275nextContext();r.\u0275\u0275advance(),r.\u0275\u0275property("svgIcon",L.selectedFileIcon),r.\u0275\u0275advance(2),r.\u0275\u0275textInterpolate(L.selectedFile.name),r.\u0275\u0275advance(2),r.\u0275\u0275textInterpolate(r.\u0275\u0275pipeBind1(6,4,L.selectedFile.size)),r.\u0275\u0275advance(2),r.\u0275\u0275property("crtAccessibleAttributes",r.\u0275\u0275pipeBind1(8,6,"ComboBox.ClearValue")+" "+L.ariaLabel)}}const X={elements:{video:function($){return $},source:function($){return $}}};class z extends C.lx{get selectedFileIcon(){return this._fileIconService.getFileIcon(this.selectedFile.name)}constructor(F,L,k,K,N,J,Z,Q){super(),this._maskService=F,this._notifyService=L,this._fileApiService=k,this._fileService=K,this._fileIconService=N,this._translateService=J,this._toFileLinkConverter=Z,this._fileUploadProcessingService=Q,this._defaultDuration=1e4,this.primaryDataSchemaName=""}_uploadedVideoToHtml(F){const L=new CKEDITOR.dom.element("video");L.setAttribute("controls","controls");const k=new CKEDITOR.dom.element("source");return k.setAttribute("src",F),k.setAttribute("type",this.selectedFile.type),L.append(k),L.getOuterHtml()}_getFileUploadObserver(F,L){return{next:k=>{if(k&&k[0]&&k[0].success){const K=this._toFileLinkConverter.convert(F,null,L.fileStorageName),N=this._uploadedVideoToHtml(K);this.videoUploaded.emit(N)}},complete:()=>{this._maskService.hideBodyMask()}}}_uploadVideoFile(){const F=this.dataValue.editorConfig,L=this.dataValue.viewModel,k=(0,l.qv)();let K=F.masterRecordColumnValue?L[F.masterRecordColumnValue.replace("$","")]:L.Id;if(K=K?.value?K.value:K,!K){const N=this._translateService.instant("InfoDialog.FileUpload.AttachedToUnsavedRecord");this._notifyService.show({message:N,duration:this._defaultDuration}),this._maskService.hideBodyMask();return}(0,y.from)(this._fileUploadProcessingService.processSelectedFiles([this.selectedFile],null)).pipe((0,y.map)(N=>{if(N?.errors?.length>0){const J=this._fileUploadProcessingService.createFileErrorMessageForLogs(N.errors);return this._notifyService.show({message:J,duration:this._defaultDuration}),!1}return!0}),(0,y.filter)(N=>N),(0,y.switchMap)(()=>this._fileService.read(this.selectedFile)),(0,y.map)(N=>({...N,id:k,fileEntitySchemaName:F.fileStorageName,recordColumnName:F.recordColumnName,recordEntitySchemaName:F.recordEntitySchemaName||this.primaryDataSchemaName,recordId:K})),(0,y.concatMap)(N=>this._fileApiService.upload(N)),(0,y.catchError)(N=>(N?.status!==200&&this._notifyService.show({message:N.message,duration:this._defaultDuration}),y.EMPTY)),(0,y.takeUntil)(this.destroy$)).subscribe(this._getFileUploadObserver(k,F))}_addProcessorRulesForVideo(){const F=this.editor.dataProcessor;F.dataFilter.addRules(X),F.htmlFilter.addRules(X)}_isVideoFileValid(F){if(!F.type.startsWith("video/")){const L=this._translateService.instant("RichTextEditorVideo.NotVideoFile");return this._notifyService.show({message:L,duration:this._defaultDuration}),!1}return!0}onUploadClick(){this.videoInput.nativeElement.click()}onClearClick(){this.selectedFile=null,this.valueChanged.emit()}hasUnsavedChanges(){return!!this.selectedFile}onVideoSelected(F){const k=(F instanceof Event?F.target.files:F.files)?.[0];k&&this._isVideoFileValid(k)&&(this.selectedFile=k,this.valueChanged.emit())}onSaveClick(){this._maskService.showBodyMask(),this.hasUnsavedChanges()&&(this._addProcessorRulesForVideo(),this._uploadVideoFile())}static{this.\u0275fac=function(L){return new(L||z)(r.\u0275\u0275directiveInject(p.s),r.\u0275\u0275directiveInject(c.F),r.\u0275\u0275directiveInject(_.k),r.\u0275\u0275directiveInject(m.d),r.\u0275\u0275directiveInject(I.H),r.\u0275\u0275directiveInject(n.TranslateService),r.\u0275\u0275directiveInject(P.G),r.\u0275\u0275directiveInject(h.T))}}static{this.\u0275cmp=r.\u0275\u0275defineComponent({type:z,selectors:[["crt-rich-text-local-video"]],viewQuery:function(L,k){if(L&1&&r.\u0275\u0275viewQuery(j,5),L&2){let K;r.\u0275\u0275queryRefresh(K=r.\u0275\u0275loadQuery())&&(k.videoInput=K.first)}},inputs:{dataValue:"dataValue",editor:"editor",primaryDataSchemaName:"primaryDataSchemaName"},features:[r.\u0275\u0275ProvidersFeature([{provide:C.lx,useExisting:(0,r.forwardRef)(()=>z)}]),r.\u0275\u0275InheritDefinitionFeature],decls:8,vars:6,consts:[["fileSelected",""],["videoInput",""],[3,"fileDropped","ngClass","showOverlay","multiple","disabled"],[1,"rich-text-video__file-drop"],[1,"rich-text-video__file-drop__placeholder"],[4,"ngIf","ngIfElse"],["type","file","accept","video/*",2,"display","none",3,"change"],[3,"image","subhead"],["size","large","color","primary","icon","upload-button-icon","iconPosition","left-icon",1,"rich-text-video__buttons_upload",3,"clicked","title"],[1,"rich-text-video__file"],["matSuffix","",1,"rich-text-video__file_icon",3,"svgIcon"],[1,"rich-text-video__file_name"],[1,"rich-text-video__file_size"],["matSuffix","","svgIcon","small-close",1,"rich-text-video__file_icon",3,"keydown.enter","keydown.space","click","crtAccessibleAttributes"]],template:function(L,k){if(L&1){const K=r.\u0275\u0275getCurrentView();r.\u0275\u0275elementStart(0,"crt-file-drop",2),r.\u0275\u0275listener("fileDropped",function(J){return r.\u0275\u0275restoreView(K),r.\u0275\u0275resetView(k.onVideoSelected(J))}),r.\u0275\u0275elementStart(1,"div",3)(2,"div",4),r.\u0275\u0275template(3,H,7,10,"ng-container",5)(4,G,9,8,"ng-template",null,0,r.\u0275\u0275templateRefExtractor),r.\u0275\u0275elementEnd()()(),r.\u0275\u0275elementStart(6,"input",6,1),r.\u0275\u0275listener("change",function(J){return r.\u0275\u0275restoreView(K),r.\u0275\u0275resetView(k.onVideoSelected(J))}),r.\u0275\u0275elementEnd()}if(L&2){const K=r.\u0275\u0275reference(5);r.\u0275\u0275property("ngClass","drop-placeholder")("showOverlay",!0)("multiple",!1)("disabled",!1),r.\u0275\u0275advance(3),r.\u0275\u0275property("ngIf",!k.selectedFile)("ngIfElse",K)}},dependencies:[R.NgClass,R.NgIf,d.B,v.MatIcon,x.MatSuffix,T.Q,b.U,U.l,n.TranslatePipe],styles:[".rich-text-video[_ngcontent-%COMP%]{height:100%;border-radius:8px;padding:24px 32px 0}.rich-text-video__header[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between;width:100%;padding-bottom:16px}.rich-text-video__input[_ngcontent-%COMP%]{margin-top:1px;display:block;height:154px}.rich-text-video__buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;flex-flow:row nowrap;margin-top:16px;margin-bottom:32px}.rich-text-video__buttons_action[_ngcontent-%COMP%]{margin-left:16px}.rich-text-video__buttons_upload[_ngcontent-%COMP%]{margin-top:8px;margin-bottom:16px}",".rich-text-video__file-drop[_ngcontent-%COMP%]{padding:8px;width:100%;height:136px;align-items:center}.rich-text-video__file-drop__placeholder[_ngcontent-%COMP%]{align-items:center;width:100%;height:100%;text-align:center;display:flex;flex-direction:column;justify-content:center}.rich-text-video__file[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;height:100%}.rich-text-video__file_icon[_ngcontent-%COMP%]{width:16px;height:16px}.rich-text-video__file_name[_ngcontent-%COMP%]{white-space:nowrap}"]})}}},35295:(B,D,e)=>{e.d(D,{g:()=>h});var r=e(22307),a=e.n(r),l=e(59247),n=e.n(l),M=e(76608),y=e.n(M),u=e(62278),C=e.n(u),p=e(12444),c=e(19344),_=e(79772),m=e.n(_);class h extends p.lx{constructor(P){super(),this._domSanitizer=P,this.urlControl=new l.FormControl("",{})}_convertToEmbedUrl(P){try{const R=new URL(P);return R.hostname.includes("youtube.com")&&R.searchParams.get("v")?`https://www.youtube.com/embed/${R.searchParams.get("v")}`:R.hostname.includes("youtu.be")?`https://www.youtube.com/embed/${R.pathname.substring(1)}`:R.hostname.includes("vimeo.com")?`https://player.vimeo.com/video/${R.pathname.split("/")[1]}`:P}catch{return""}}_getVideoTemplate(P){const R=this._domSanitizer.bypassSecurityTrustUrl(P),f=this._domSanitizer.sanitize(r.SecurityContext.URL,R);return'<iframe style="width: 100%; height: 100%;" src="'+CKEDITOR.tools.htmlEncode(this._convertToEmbedUrl(f))+'" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>'}hasUnsavedChanges(){return this.urlControl.value}onSaveClick(){const P=this._getVideoTemplate(this.urlControl.value);this.videoUploaded.emit(P)}ngOnInit(){this.urlControl.valueChanges.pipe((0,u.takeUntil)(this.destroy$)).subscribe(P=>{this.valueChanged.emit(P)})}static{this.\u0275fac=function(R){return new(R||h)(r.\u0275\u0275directiveInject(M.DomSanitizer))}}static{this.\u0275cmp=r.\u0275\u0275defineComponent({type:h,selectors:[["crt-rich-text-url-video"]],features:[r.\u0275\u0275ProvidersFeature([{provide:p.lx,useExisting:(0,r.forwardRef)(()=>h)}]),r.\u0275\u0275InheritDefinitionFeature],decls:2,vars:7,consts:[[1,"rich-text-video__input",3,"control","labelPosition","appearance","placeholder","multiline"]],template:function(R,f){R&1&&(r.\u0275\u0275element(0,"crt-input",0),r.\u0275\u0275pipe(1,"translate")),R&2&&r.\u0275\u0275property("control",f.urlControl)("labelPosition","hidden")("appearance","outline")("placeholder",r.\u0275\u0275pipeBind1(1,5,"RichTextEditorVideo.InputPlaceholder"))("multiline",!0)},dependencies:[c.j,_.TranslatePipe],styles:[".rich-text-video[_ngcontent-%COMP%]{height:100%;border-radius:8px;padding:24px 32px 0}.rich-text-video__header[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between;width:100%;padding-bottom:16px}.rich-text-video__input[_ngcontent-%COMP%]{margin-top:1px;display:block;height:154px}.rich-text-video__buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;flex-flow:row nowrap;margin-top:16px;margin-bottom:32px}.rich-text-video__buttons_action[_ngcontent-%COMP%]{margin-left:16px}.rich-text-video__buttons_upload[_ngcontent-%COMP%]{margin-top:8px;margin-bottom:16px}"]})}}},12444:(B,D,e)=>{e.d(D,{En:()=>d,Te:()=>E,lx:()=>v});var r=e(5960),a=e.n(r),l=e(22307),n=e.n(l),M=e(23681),y=e.n(M),u=e(1034),C=e(79772),p=e.n(C),c=e(6503),_=e(31774),m=e(95211),h=e(62278),I=e.n(h);function P(x,O){if(x&1){const T=l.\u0275\u0275getCurrentView();l.\u0275\u0275elementContainerStart(0),l.\u0275\u0275elementStart(1,"crt-rich-text-url-video",12),l.\u0275\u0275listener("valueChanged",function(){l.\u0275\u0275restoreView(T);const U=l.\u0275\u0275nextContext();return l.\u0275\u0275resetView(U.onValueChanged())})("videoUploaded",function(U){l.\u0275\u0275restoreView(T);const j=l.\u0275\u0275nextContext();return l.\u0275\u0275resetView(j.onVideoUploaded(U))}),l.\u0275\u0275elementEnd(),l.\u0275\u0275elementContainerEnd()}}function R(x,O){if(x&1){const T=l.\u0275\u0275getCurrentView();l.\u0275\u0275elementContainerStart(0),l.\u0275\u0275elementStart(1,"crt-rich-text-local-video",13),l.\u0275\u0275listener("valueChanged",function(){l.\u0275\u0275restoreView(T);const U=l.\u0275\u0275nextContext();return l.\u0275\u0275resetView(U.onValueChanged())})("videoUploaded",function(U){l.\u0275\u0275restoreView(T);const j=l.\u0275\u0275nextContext();return l.\u0275\u0275resetView(j.onVideoUploaded(U))}),l.\u0275\u0275elementEnd(),l.\u0275\u0275elementContainerEnd()}if(x&2){const T=l.\u0275\u0275nextContext();l.\u0275\u0275advance(),l.\u0275\u0275property("editor",T.editor)("dataValue",T.data==null?null:T.data.value)("primaryDataSchemaName",T.data==null?null:T.data.primaryDataSchemaName)}}function f(x,O){if(x&1){const T=l.\u0275\u0275getCurrentView();l.\u0275\u0275elementContainerStart(0),l.\u0275\u0275elementStart(1,"crt-rich-text-embed-video",12),l.\u0275\u0275listener("valueChanged",function(){l.\u0275\u0275restoreView(T);const U=l.\u0275\u0275nextContext();return l.\u0275\u0275resetView(U.onValueChanged())})("videoUploaded",function(U){l.\u0275\u0275restoreView(T);const j=l.\u0275\u0275nextContext();return l.\u0275\u0275resetView(j.onVideoUploaded(U))}),l.\u0275\u0275elementEnd(),l.\u0275\u0275elementContainerEnd()}}var d;(function(x){x[x.Url=0]="Url",x[x.Local=1]="Local",x[x.Embeded=2]="Embeded"})(d||(d={}));class v{constructor(){this.destroy$=new h.Subject,this.videoUploaded=new l.EventEmitter,this.valueChanged=new l.EventEmitter}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static{this.\u0275fac=function(T){return new(T||v)}}static{this.\u0275dir=l.\u0275\u0275defineDirective({type:v,outputs:{videoUploaded:"videoUploaded",valueChanged:"valueChanged"}})}}let E=class Ae{constructor(O,T,b,U,j){this.data=O,this._notifyService=T,this._translateService=b,this._messageDialogProvider=U,this._dialog=j,this._defaultDuration=1e4,this._destroy$=new h.Subject,this._initialWidth=640,this._initialHeight=360,this.tabItems=[],this.currentTabIndex=d.Url,this.hasUnsavedChanges=!1,this.TabType=d,this.editor=O?.value?.editor}_initDialogTabs(){const O=this._translateService.instant("RichTextEditorVideo.PasteUrlTab"),T=this._translateService.instant("RichTextEditorVideo.UploadFileTab"),b=this._translateService.instant("RichTextEditorVideo.EmbedCodeTab");this.tabItems=[{caption:O,name:"PasteUrlTab",iconPosition:m.q.OnlyText,type:"crt.GridContainer"},{caption:T,name:"UploadFileTab",iconPosition:m.q.OnlyText,type:"crt.GridContainer"},{caption:b,name:"EmbedCodeTab",iconPosition:m.q.OnlyText,type:"crt.GridContainer"}]}_checkUnsavedChanges(){return!this.currentTab||this.currentTab.hasUnsavedChanges()}_handleSecurityPolicyViolation(O){const T=`
			Blocked URI: ${O.blockedURI}
			Directive: ${O.violatedDirective}
			Document URI: ${O.documentURI}
		`;this._notifyService.show({message:T,duration:this._defaultDuration})}_insertVideo(O){if(!this.editor){console.warn("CKEditor is not initialized");return}const T=this.editor.document.createElement("div");T.setStyle("display","inline");const b=this.editor.document.createElement("span");b.setAttribute("contenteditable","false"),b.addClass("resizable-video-wrapper"),b.addClass("selectable"),b.setSize("width",this._initialWidth,!1),b.setSize("height",this._initialHeight,!1),b.setHtml(O),T.append(b),this.editor.insertElement(T)}onTabChanged(O){this.currentTabIndex=O}onSaveClick(){!this.currentTab||!this.currentTab.hasUnsavedChanges()||this.currentTab.onSaveClick()}onVideoUploaded(O){this._insertVideo(O),this._dialog.close()}onCloseClick(){if(this.currentTab)if(this.currentTab.hasUnsavedChanges()){const O=this._translateService.instant("RichTextEditorVideo.ConfirmMessage");this._messageDialogProvider.confirmation(O).pipe((0,h.takeUntil)(this._destroy$)).subscribe(T=>{T&&this._dialog.close()})}else this._dialog.close()}ngOnInit(){this._initDialogTabs(),document.addEventListener("securitypolicyviolation",this._handleSecurityPolicyViolation.bind(this))}onValueChanged(){this.hasUnsavedChanges=this._checkUnsavedChanges()}ngOnDestroy(){this._destroy$.next(),this._destroy$.complete(),document.removeEventListener("securitypolicyviolation",this._handleSecurityPolicyViolation.bind(this))}static{this.\u0275fac=function(T){return new(T||Ae)(l.\u0275\u0275directiveInject(M.MAT_DIALOG_DATA),l.\u0275\u0275directiveInject(c.F),l.\u0275\u0275directiveInject(C.TranslateService),l.\u0275\u0275directiveInject(_.r),l.\u0275\u0275directiveInject(M.MatDialogRef))}}static{this.\u0275cmp=l.\u0275\u0275defineComponent({type:Ae,selectors:[["crt-rich-text-video"]],viewQuery:function(T,b){if(T&1&&l.\u0275\u0275viewQuery(v,5),T&2){let U;l.\u0275\u0275queryRefresh(U=l.\u0275\u0275loadQuery())&&(b.currentTab=U.first)}},decls:20,vars:19,consts:[[1,"rich-text-video"],[1,"rich-text-video__container"],[1,"rich-text-video__header"],["labelType","headline-2","labelEllipsis","true","tabindex","0",1,"rich-text-video__header__title",3,"caption"],["icon","close-button-icon","iconPosition","icon-only","size","medium","color","default","clickMode","default",1,"rich-text-video__buttons_close",3,"clicked"],[3,"selectedTabIndexChange","items","showTabViewModelContent"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"rich-text-video__description",3,"innerHtml"],[1,"rich-text-video__buttons"],[1,"rich-text-video__buttons_action",3,"clicked"],["color","primary",1,"rich-text-video__buttons_action",3,"clicked","disabled"],[3,"valueChanged","videoUploaded"],[3,"valueChanged","videoUploaded","editor","dataValue","primaryDataSchemaName"]],template:function(T,b){T&1&&(l.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"div",2),l.\u0275\u0275element(3,"crt-label",3),l.\u0275\u0275pipe(4,"translate"),l.\u0275\u0275elementStart(5,"crt-button",4),l.\u0275\u0275listener("clicked",function(){return b.onCloseClick()}),l.\u0275\u0275elementEnd()(),l.\u0275\u0275elementStart(6,"crt-tab-panel",5),l.\u0275\u0275listener("selectedTabIndexChange",function(j){return b.onTabChanged(j)}),l.\u0275\u0275elementEnd(),l.\u0275\u0275elementContainerStart(7,6),l.\u0275\u0275template(8,P,2,0,"ng-container",7)(9,R,2,3,"ng-container",7)(10,f,2,0,"ng-container",7),l.\u0275\u0275elementContainerEnd(),l.\u0275\u0275element(11,"label",8),l.\u0275\u0275pipe(12,"translate"),l.\u0275\u0275elementStart(13,"div",9)(14,"crt-button",10),l.\u0275\u0275listener("clicked",function(){return b.onCloseClick()}),l.\u0275\u0275text(15),l.\u0275\u0275pipe(16,"translate"),l.\u0275\u0275elementEnd(),l.\u0275\u0275elementStart(17,"crt-button",11),l.\u0275\u0275listener("clicked",function(){return b.onSaveClick()}),l.\u0275\u0275text(18),l.\u0275\u0275pipe(19,"translate"),l.\u0275\u0275elementEnd()()()()),T&2&&(l.\u0275\u0275advance(3),l.\u0275\u0275property("caption",l.\u0275\u0275pipeBind1(4,11,"RichTextEditorVideo.DialogTitle")),l.\u0275\u0275advance(3),l.\u0275\u0275property("items",b.tabItems)("showTabViewModelContent",!1),l.\u0275\u0275advance(),l.\u0275\u0275property("ngSwitch",b.currentTabIndex),l.\u0275\u0275advance(),l.\u0275\u0275property("ngSwitchCase",b.TabType.Url),l.\u0275\u0275advance(),l.\u0275\u0275property("ngSwitchCase",b.TabType.Local),l.\u0275\u0275advance(),l.\u0275\u0275property("ngSwitchCase",b.TabType.Embeded),l.\u0275\u0275advance(),l.\u0275\u0275property("innerHtml",l.\u0275\u0275pipeBind1(12,13,"RichTextEditorVideo.DialogDescription"),l.\u0275\u0275sanitizeHtml),l.\u0275\u0275advance(4),l.\u0275\u0275textInterpolate1(" ",l.\u0275\u0275pipeBind1(16,15,"RichTextEditorVideo.CancelButton")," "),l.\u0275\u0275advance(2),l.\u0275\u0275property("disabled",!b.hasUnsavedChanges),l.\u0275\u0275advance(),l.\u0275\u0275textInterpolate1(" ",l.\u0275\u0275pipeBind1(19,17,"RichTextEditorVideo.SaveButton")," "))},styles:[".rich-text-video[_ngcontent-%COMP%]{height:100%;border-radius:8px;padding:24px 32px 0}.rich-text-video__header[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between;width:100%;padding-bottom:16px}.rich-text-video__input[_ngcontent-%COMP%]{margin-top:1px;display:block;height:154px}.rich-text-video__buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;flex-flow:row nowrap;margin-top:16px;margin-bottom:32px}.rich-text-video__buttons_action[_ngcontent-%COMP%]{margin-left:16px}.rich-text-video__buttons_upload[_ngcontent-%COMP%]{margin-top:8px;margin-bottom:16px}"]})}};E=(0,r.__decorate)([(0,u.v)({type:"crt.RichTextVideoComponent"}),(0,r.__metadata)("design:paramtypes",[Object,c.F,C.TranslateService,_.r,M.MatDialogRef])],E)},60471:(B,D,e)=>{e.d(D,{R:()=>u});var r=e(73308),a=e(5960),l=e.n(a),n=e(41287),M=e(844),y=e(50002);let u=class extends n.l{constructor(){super()}handle(p){var c=this;return(0,r.A)(function*(){const m=yield p.$context.Id;return window.CKEDITOR?.instances&&Object.values(CKEDITOR.instances).filter(I=>I.schemaRecordId===m&&I.uploadFilesData!==null).forEach(I=>{I.uploadFilesData=null}),yield c.next?.handle(p)})()}};u=(0,a.__decorate)([(0,M.l)({type:"crt.RichTextEditorCancelHandler",requestType:"crt.CancelRecordChangesRequest",scopes:[y.M.AllCards,"BasePageFreedomTemplate",y.M.AllSections]}),(0,a.__metadata)("design:paramtypes",[])],u)},6572:(B,D,e)=>{e.d(D,{y:()=>P});var r=e(73308),a=e(5960),l=e.n(a),n=e(41287),M=e(61541),y=e(844),u=e(22592),C=e(85040),p=e(48534),c=e(50002),_=e(62278),m=e.n(_),h=e(2122),I=e(75648);let P=class extends n.l{constructor(f,d,v){super(),this._service=f,this._maskService=d,this._copilotToEditorCommunicationService=v}_getEditors(f){return window.CKEDITOR?.instances?Object.values(CKEDITOR.instances).filter(v=>v.needHandleSave&&v.schemaRecordId===f):[]}_removeCopilotHighlighting(){this._copilotToEditorCommunicationService?.notify({editorAction:C.u.RemoveHighlighting})}_saveTableOfContents(f){f.forEach(d=>{I.M.generateTableOfContents(d),d.fire("change")})}_saveFiles(f,d,v){var E=this;return(0,r.A)(function*(){if(f.length>0){const x=E._service.uploadFile(f,{schemaName:d.name,recordId:v.$context.attributes.Id},v.$context.attributes).pipe((0,_.take)(1));yield(0,_.lastValueFrom)(x,{defaultValue:null}),f.forEach(O=>{O.uploadFilesData=null})}})()}_saveImages(f,d,v){var E=this;return(0,r.A)(function*(){if(f.length>0){const x=E._service.uploadImages(f,{schemaName:d,recordId:v.$context.attributes.Id}).pipe((0,_.take)(1)),O=yield(0,_.lastValueFrom)(x,{defaultValue:null});return E._service.removeImages(f),O}})()}handle(f){var d=this;return(0,r.A)(function*(){const v="RECORD_SAVING",E=f.$context,x=yield E.Id,O=yield E.getPrimaryDataSchema(),T=d._getEditors(x);if(!O||T.length===0)return d.next?.handle(f);yield d._maskService.showMask(v,f.$context);const b=yield f.$context.CardState;b===M.n.Edit&&(yield d._saveImages(T,O.name,f)),d._removeCopilotHighlighting(),d._saveTableOfContents(T);const U=yield d.next?.handle(f);if(U&&(yield d._saveFiles(T,O,f),b===M.n.Add&&(yield d._saveImages(T,O.name,f)))){const H=T.map(G=>{const X=E.getAttributeNameByViewItemName(G.config.name);return{name:E.getBoundDataSchemaAttributeByAttributePath(X).path,value:G.getData()}});yield(0,_.lastValueFrom)(d._service.updateColumnValue(O.name,x,H))}return yield d._maskService.hideMask(v,f.$context),U})()}};P=(0,a.__decorate)([(0,y.l)({type:"crt.RichTextEditorSaveHandler",requestType:"crt.SaveRecordRequest",scopes:[c.M.AllCards,"BasePageFreedomTemplate",c.M.AllSections]}),(0,a.__metadata)("design:paramtypes",[h.H,u.s,p.i])],P)},24726:(B,D,e)=>{e.d(D,{A:()=>y});var r=e(73308),a=e(22307),l=e.n(a),n=e(74368),M=e(12404);class y{constructor(C){this._selectionActionsMetadataService=C,this._metadataSchemaUtils=(0,a.inject)(n.u)}_getViewConfigs(C,p){return this._metadataSchemaUtils.getViewConfigInfoByProperty("type",p,C.viewConfig).map(c=>c?.viewConfig).filter(Boolean)}crtOnMetaDataInit(C){var p=this;return(0,r.A)(function*(){const c=C,_=p._getViewConfigs(c,"crt.RichTextEditor");for(const m of _)yield p._selectionActionsMetadataService.setRewriteOptions(c,m);return Promise.resolve(C)})()}static{this.\u0275fac=function(p){return new(p||y)(a.\u0275\u0275inject(M.S))}}static{this.\u0275prov=a.\u0275\u0275defineInjectable({token:y,factory:y.\u0275fac})}}},57463:(B,D,e)=>{e.d(D,{q:()=>ae});var r=e(5960),a=e.n(r),l=e(67057),n=e.n(l),M=e(59247),y=e.n(M),u=e(23681),C=e.n(u),p=e(66459),c=e.n(p),_=e(37851),m=e.n(_),h=e(49281),I=e.n(h),P=e(20637),R=e.n(P),f=e(76608),d=e.n(f),v=e(55642),E=e(79772),x=e.n(E),O=e(5476),T=e(56484),b=e(89199),U=e(69647),j=e(48067),H=e(66302),G=e(61832),X=e(31149),z=e(43981),$=e(57274),F=e(41276),L=e(53173),k=e(19879),K=e(53887),N=e(8625),J=e(30647),Z=e(96176),Q=e(69930),le=e(90983),ce=e(12841),fe=e(83455),re=e(8346),se=e(55801),ie=e(10990),Ee=e.n(ie),ve=e(26165),de=e(45093),_e=e(3214),ue=e(12444),me=e(35295),ge=e(75959),ee=e(9843),Ce=e(6572),xe=e(60471),ye=e(24726),Te=e(12404),Me=e(58001),he=e(2122),ne=e(21542),Y=e(22307),Ue=e.n(Y),Oe=e(13232),Pe=e(73565),Ie=e(12325);let ae=class Le{constructor(pe,oe){this._matIconRegistry=pe,this._domSanitizer=oe,this._registerIcons()}_registerIcons(){[{name:"clip-filled",icon:e(86142)},{name:"select-template-icon",icon:e(56148)},{name:"richtext-toggle",icon:e(54373)},{name:"open-link",icon:e(37480)},{name:"save-link",icon:e(42085)},{name:"unlink-link",icon:e(52655)},{name:"info-icon",icon:e(29759)}].forEach(({name:oe,icon:be})=>{this._matIconRegistry.addSvgIconLiteral(oe,this._domSanitizer.bypassSecurityTrustHtml(be))})}static{this.\u0275fac=function(oe){return new(oe||Le)(Y.\u0275\u0275inject(_.MatIconRegistry),Y.\u0275\u0275inject(f.DomSanitizer))}}static{this.\u0275mod=Y.\u0275\u0275defineNgModule({type:Le})}static{this.\u0275inj=Y.\u0275\u0275defineInjector({providers:[{provide:Q.i,useValue:(0,le.cI)()+"core/hash/CKEditor/ckeditor.js"},{provide:ve.C,useFactory:()=>window.Terrasoft?.isAngularHost?"shell/styles":"schema-view-component/styles.css"},{provide:ce.m,useClass:ye.A,multi:!0},Te.S,Me.O,he.H,fe.d,ne.O],imports:[l.CommonModule,ie.CKEditorModule,X.q,z.k,_.MatIconModule,P.MatTooltipModule,M.FormsModule,M.ReactiveFormsModule,O.q,G.V,T.S,p.MatFormFieldModule,h.MatInputModule,$.u,b.N,U.b,F.F,L.o,Z.c,u.MatDialogModule,k.T,re.d,E.TranslateModule,se.d,l.CommonModule,ie.CKEditorModule,X.q,z.k,_.MatIconModule,P.MatTooltipModule,M.FormsModule,M.ReactiveFormsModule,O.q,G.V,T.S,p.MatFormFieldModule,h.MatInputModule,$.u,b.N,U.b,F.F,L.o,Z.c,u.MatDialogModule,k.T,re.d,E.TranslateModule,se.d]})}};ae=(0,r.__decorate)([(0,v.g)({viewElements:[de.R,_e.U],requestHandlers:[Ce.y,xe.R]}),(0,r.__metadata)("design:paramtypes",[_.MatIconRegistry,f.DomSanitizer])],ae),function(){(typeof ngJitMode>"u"||ngJitMode)&&Y.\u0275\u0275setNgModuleScope(ae,{declarations:[de.R,_e.U,ue.Te,me.g,ge.i,ee._],imports:[l.CommonModule,ie.CKEditorModule,X.q,z.k,_.MatIconModule,P.MatTooltipModule,M.FormsModule,M.ReactiveFormsModule,O.q,G.V,T.S,p.MatFormFieldModule,h.MatInputModule,$.u,j.C,b.N,U.b,F.F,L.o,Z.c,u.MatDialogModule,k.T,re.d,K.E,N.x,H.i,J.S,E.TranslateModule,se.d],exports:[de.R,_e.U,ue.Te,l.CommonModule,ie.CKEditorModule,X.q,z.k,_.MatIconModule,P.MatTooltipModule,M.FormsModule,M.ReactiveFormsModule,O.q,G.V,T.S,p.MatFormFieldModule,h.MatInputModule,$.u,j.C,b.N,U.b,F.F,L.o,Z.c,u.MatDialogModule,k.T,re.d,K.E,N.x,H.i,J.S,E.TranslateModule,se.d]})}(),Y.\u0275\u0275setComponentScope(ue.Te,[l.NgSwitch,l.NgSwitchCase,Oe.B,Pe.Q,Ie.V,me.g,ge.i,ee._],[E.TranslatePipe])},2122:(B,D,e)=>{e.d(D,{H:()=>P});var r=e(6530),a=e(18587),l=e(58504),n=e(74709),M=e(86464),y=e(90983),u=e(62278),C=e.n(u),p=e(47243),c=e(22307),_=e.n(c),m=e(26628),h=e(83455),I=e(65751);class P{constructor(f,d,v){this._fileApiService=f,this._fileService=d,this.queryExecutor=v,this._sysDownloadMethod="/rest/FileService/Download"}_replaceSrc(f,d,v){f.removeAttribute("data-cke-saved-src"),f.setAttribute("src",d),f.setAttribute("data-uploaded-image-id",v)}_getFileType(f){const d=f.match(/data:(.*);base64/);return d?d[1]:null}_mapFileDto(f,d){return{...f,id:(0,r.qv)(),fileEntitySchemaName:d.fileSchemaName||"SysFile",recordColumnName:d.recordColumnName||"RecordId",recordEntitySchemaName:d.schemaName,recordId:d.recordId,tag:"inline"}}_getFile(f,d,v){const E=this._getFileData(f,d);return new File([E],v,{type:d})}_getFileData(f,d){const v=f.split(";base64,"),E=window.atob(v[1]),x=new Array(E.length);for(let b=0;b<E.length;b++)x[b]=E.charCodeAt(b);const O=new Uint8Array(x);return new Blob([O],{type:d})}_getImageIdentifiers(f){const d=/data-uploaded-image-id="([^"]*)"/gim,v=[];let E=d.exec(f);for(;E!=null;)v.push(E[1]),E=d.exec(f);return v}_catchErrorResponse(f){return console.error(f),(0,u.of)({success:!1,errorInfo:{errorCode:null,message:f.message,stackTrace:f.stack},result:null})}_getDeleteQuery(f){const d=new a.x("SysFile");return d.filters.addSchemaColumnInFilterWithParameters(l.H.Equal,"Id",f),d}getUploadUrl(f){const d=(0,y.uJ)((0,y.Xq)(),this._sysDownloadMethod,f.fileEntitySchemaName||"SysFile",f.id);return d.startsWith("/")?d:"/"+d}uploadImages(f,d){const v=f.map(E=>{const x=p.E.getEditorImages(E),O=[];d.fileSchemaName=d.fileSchemaName||E.config.fileStorageName,d.recordColumnName=d.recordColumnName||E.config.recordColumnName;for(let T=0;T<x?.length;T++){const b=x[T],U=b.getAttribute("src");if(!U)continue;const j=b.getAttribute("crt-file-name"),H=this._getFileType(U);if(H){const X=H.match(/\/(\w+)/)?.[1],z=(0,r.qv)();let $=j||`${d.schemaName}_${d.recordId}_${z}`;X&&!j&&($+=`.${X}`),O.push({element:b,file:this._getFile(U,H,$),fileId:z})}}return{editor:E,imageFiles:O}}).filter(E=>E.imageFiles.length>0);return v.length===0?(0,u.of)(!1):(0,u.from)(v).pipe((0,u.concatMap)(E=>(0,u.from)(E.imageFiles).pipe((0,u.concatMap)(x=>(0,u.zip)(this._fileService.read(x.file),(0,u.of)(x))),(0,u.map)(x=>({dto:this._mapFileDto(x[0],d),image:x[1]})),(0,u.concatMap)(x=>this._fileApiService.upload(x.dto).pipe((0,u.map)(()=>(this._replaceSrc(x.image.element,this.getUploadUrl(x.dto),x.dto.id),E.editor.fire("change"),!0)),(0,u.catchError)(O=>this._catchErrorResponse(O).pipe((0,u.map)(T=>T.success))))),(0,u.toArray)(),(0,u.map)(x=>x.some(O=>O===!0)))),(0,u.toArray)(),(0,u.map)(E=>E.some(x=>x===!0)))}removeImages(f){f.forEach(d=>{const v=this._getImageIdentifiers(p.E.getLastSnapshotContent(d)),E=this._getImageIdentifiers(d.getData()),x=v.filter(O=>!E.includes(O));if(x.length>0){const O=this._getDeleteQuery(x);this.queryExecutor.execute(O).pipe((0,u.map)(()=>({success:!0,errorInfo:null,result:[]})),(0,u.catchError)(T=>this._catchErrorResponse(T))).subscribe()}})}uploadFile(f,d,v){const E=f.filter(x=>x.uploadFilesData);return(0,u.from)(E).pipe((0,u.concatMap)(x=>{const{readyToUploadFiles:O,uploadEvent:T}=x.uploadFilesData,b=x.uploadFilesData.filesStorage;return T.stop(),(0,u.from)(O).pipe((0,u.concatMap)(U=>this._fileService.read(U.file).pipe((0,u.map)(j=>{let H=b.masterRecordColumnValue?v[b.masterRecordColumnValue.replace("$","")]:d.recordId;return H=H?.value?H.value:H,{...j,id:U.fileId,fileEntitySchemaName:b.entitySchemaName,recordColumnName:b.recordColumnName,recordEntitySchemaName:b.recordEntitySchemaName||d.schemaName,recordId:H}}),(0,u.concatMap)(j=>this._fileApiService.upload(j).pipe((0,u.catchError)(H=>(H?.status!==200&&x.fire("CreatioFileUploadFailed",{fileName:j.file.name}),this._catchErrorResponse(H))))))),(0,u.toArray)())}),(0,u.toArray)())}updateColumnValue(f,d,v){const E=new n.N(f);return v.forEach(x=>{E.addColumn(x.name,x.value,M.r.Text)}),E.filters.addSchemaColumnFilterWithParameter(l.H.Equal,"Id",d),this.queryExecutor.executeUpdateQuery(E)}static{this.\u0275fac=function(d){return new(d||P)(c.\u0275\u0275inject(m.k),c.\u0275\u0275inject(h.d),c.\u0275\u0275inject(I.w))}}static{this.\u0275prov=c.\u0275\u0275defineInjectable({token:P,factory:P.\u0275fac,providedIn:"any"})}}},12404:(B,D,e)=>{e.d(D,{S:()=>p});var r=e(73308),a=e(79772),l=e(26594),n=e(95211),M=e(28399);const y=["EmailMiniPage","CommunicationsPanel_FeedsTab"];var u=e(22307),C=e(21928);class p{constructor(_,m,h){this._translateService=_,this._sysSettingsService=m,this._featureValues=h}_createAttribute(_,m,h){const I=_.viewModelConfig.attributes;return I[m]={value:h},m}_rewriteOptionsAvailable(_,m){var h=this;return(0,r.A)(function*(){return h._featureValues.SelectionRewriteActions&&h._featureValues["GenAIFeatures.Copilot"]&&h._featureValues.SidebarExtensions&&!m.disableSelectionOptions&&(yield h._useNewShell())&&!y.includes(_)})()}_useNewShell(){var _=this;return(0,r.A)(function*(){return(yield _._sysSettingsService.getByCode("UseNewShell"))?.value})()}setRewriteOptions(_,m){var h=this;return(0,r.A)(function*(){if(!(yield h._rewriteOptionsAvailable(_.name,m))){m.disableSelectionOptions=!0;return}const I=(0,M.isEmpty)(m.selection)?h._createAttribute(_,`${m.name}_Selection`,""):m.selection.replace("$","");m.selection=`$${I}`,(0,M.isEmpty)(m.selectionActions)&&(m.selectionActions=[{type:"crt.Button",icon:"copilot-rewrite-btn-icon",color:"outline",iconPosition:n.q.OnlyIcon,clickMode:"menu",menuItems:[{type:"crt.MenuLabel",caption:h._translateService.instant("RichTextEditor.SelectionActions.RewriteCaption")},{type:"crt.MenuItem",caption:h._translateService.instant("RichTextEditor.SelectionActions.Friendly"),icon:"copilot-rewrite-friendly-icon",clicked:{request:"crt.SelectionActionRequest",params:{selectionAttributeName:I,rewriteAction:"Friendly"}}},{type:"crt.MenuItem",caption:h._translateService.instant("RichTextEditor.SelectionActions.Formal"),icon:"copilot-rewrite-formal-icon",clicked:{request:"crt.SelectionActionRequest",params:{selectionAttributeName:I,rewriteAction:"Formal"}}},{type:"crt.MenuItem",caption:h._translateService.instant("RichTextEditor.SelectionActions.Shorten"),icon:"copilot-rewrite-shorten-icon",clicked:{request:"crt.SelectionActionRequest",params:{selectionAttributeName:I,rewriteAction:"Shorten"}}},{type:"crt.MenuItem",caption:h._translateService.instant("RichTextEditor.SelectionActions.Extend"),icon:"copilot-rewrite-extend-icon",clicked:{request:"crt.SelectionActionRequest",params:{selectionAttributeName:I,rewriteAction:"Extend"}}},{type:"crt.MenuItem",caption:h._translateService.instant("RichTextEditor.SelectionActions.Rephrase"),icon:"copilot-rewrite-rephrase-icon",clicked:{request:"crt.SelectionActionRequest",params:{selectionAttributeName:I,rewriteAction:"Rephrase"}}},{type:"crt.MenuDivider"},{type:"crt.MenuItem",caption:h._translateService.instant("RichTextEditor.SelectionActions.AskCopilot"),icon:"copilot-action-button-icon",clicked:{request:"crt.SelectionActionRequest",params:{selectionAttributeName:I,rewriteAction:"AskCopilot"}}}]}])})()}static{this.\u0275fac=function(m){return new(m||p)(u.\u0275\u0275inject(a.TranslateService),u.\u0275\u0275inject(C.A),u.\u0275\u0275inject(l.G))}}static{this.\u0275prov=u.\u0275\u0275defineInjectable({token:p,factory:p.\u0275fac,providedIn:"any"})}}},58001:(B,D,e)=>{e.d(D,{O:()=>l});var r=e(22307),a=e.n(r);class l{constructor(){this._editorClassName=".cke_editable"}_setSelectionActionsVisibility(M,y){if(M){const u=this._getSelectionActionsPanelPosition();y.nativeElement.style.display="unset",y.nativeElement.style.top=u.clientY,y.nativeElement.style.left=u.clientX}else y.nativeElement.style.display="none"}_getSelectionActionsPanelPosition(){return this._getPositionFromSelection()||{clientX:"50%",clientY:"50%"}}_getPositionFromSelection(){const M=getSelection()?.getRangeAt(0)?.getClientRects(),y=Array.from(M||[]);if(y.length===0)return null;let u=y[0];const C=getSelection()?.getRangeAt(0)?.getBoundingClientRect();return y.forEach(p=>{(p.top>u.top||p.top===u.top&&p.right>u.right)&&(u=p)}),{clientX:`${Math.min(u.right,C.right)}px`,clientY:`${u.bottom}px`}}updatePosition(M,y){if(!M)return!1;const u=getSelection(),C=u?.type==="Range",p=y?.contains(u?.focusNode),_=!!(u.focusNode?.nodeType===Node.ELEMENT_NODE?u.focusNode:u.focusNode?.parentElement)?.closest(this._editorClassName),m=C&&p&&_;return this._setSelectionActionsVisibility(m,M),m}static{this.\u0275fac=function(y){return new(y||l)}}static{this.\u0275prov=r.\u0275\u0275defineInjectable({token:l,factory:l.\u0275fac,providedIn:"any"})}}},47243:(B,D,e)=>{e.d(D,{E:()=>r});class r{static{this.fileIconImageCssClass="file-icon-system-image"}static getLastSnapshotContent(l){const n=l.undoManager.snapshots;return n[n.length-1].contents}static getEditorImages(l){const n=l.editable().$.getElementsByTagName("img");return Array.from(n).filter(M=>!M.classList.contains(this.fileIconImageCssClass))}static getThemeCssLink(l,n){const M=l.styleSheets;let y;for(let u=0;u<M.length;u++)if(M[u].href&&(y=y??M[u].href,M[u].href?.toLowerCase().indexOf(n)>-1))return M[u].href;return y}static appendLink(l,n){function M(u){const C=document.createElement("link");return C.rel="stylesheet",C.type="text/css",C.href=u,C.media="all",C}function y(u,C){function p(m){const h=m.indexOf("?");return h>=0?m.substr(0,h):m}const c=p(C),_=u.getElementsByTagName("link");for(let m=0;m<_.length;m++)if(p(_[m].href).endsWith(c.replace("./","")))return!0;return!1}n&&!y(l,n)&&l.appendChild(M(n))}}},21542:(B,D,e)=>{e.d(D,{O:()=>C});var r=e(57156),a=e(28399),l=e.n(a),n=e(51521),M=e.n(n),y=e(22307),u=e.n(y);class C{constructor(c){this._markdownService=c,this._highlightClass="rich-editor-highlight",this._wrapperClass="rich-editor-highlight-wrapper"}_highlightElements(c){const _=[],m=new CKEDITOR.dom.walker(c);let h;for(;h=m.next();)if(h.type===CKEDITOR.NODE_TEXT)_.push(h);else if(h.contains(c.endContainer)){_.push(h);break}_.forEach(I=>{this._wrapElements(I,c)})}_wrapElements(c,_){if(c.type===CKEDITOR.NODE_TEXT){const m=c.getUniqueId()===_.startContainer.getUniqueId()?_.startOffset:0,h=c.getUniqueId()===_.endContainer.getUniqueId()?_.endOffset:0;this._wrapTextElement(c,m,h)}else{const m=c.getChildren();for(let h=0;h<m.count();h++)this._wrapElements(m.getItem(h),_)}}_wrapTextElement(c,_=0,m=0){const h=this._createWrapElement(this._wrapperClass),I=c.getText();if(_>0&&m===0){const P=I.slice(0,_),R=new CKEDITOR.dom.text(P);h.append(R);const f=I.slice(_),d=this._createWrapElement();d.setHtml(f),h.append(d)}else if(_===0&&m>0){const P=I.slice(0,m),R=this._createWrapElement();R.setHtml(P),h.append(R);const f=I.slice(m),d=new CKEDITOR.dom.text(f);h.append(d)}else if(_>0&&m>0){const P=I.slice(0,_),R=new CKEDITOR.dom.text(P);h.append(R);const f=I.slice(_,m),d=this._createWrapElement();d.setHtml(f),h.append(d);const v=I.slice(m),E=new CKEDITOR.dom.text(v);h.append(E)}else if(_===0||m===0){const P=this._createWrapElement();P.setHtml(I),h.append(P)}h.replace(c)}_createWrapElement(c=this._highlightClass){const _=new CKEDITOR.dom.element("span");return(0,a.isEmpty)(c)||_.setAttribute("class",c),_}_removeHighlighting(c){this._getElementsBySelector(c,this._highlightClass).toArray().forEach(h=>{h.remove(!0)}),this._getElementsBySelector(c,this._wrapperClass).toArray().forEach(h=>{h.remove(!0)})}_removeSelection(c){if(!this.isEditorContainingSelection(c))return;c.getSelection()?.removeAllRanges(),getSelection()?.empty()}_getElementsBySelector(c,_){return c.editable().find("."+_)}_createRange(c,_,m){const h=c.createRange();return h.setStartBefore(_),h.setEndAfter(m),h}_cleanUpRange(c){const _=["ul","ol"],m=h=>{h.getText()===""&&_.includes(h.getName())&&h.remove(!1)};c?.deleteContents(),c.startContainer?.getChildren().toArray().forEach(h=>m(h))}_retrieveSelectionNodes(c){const _=document.createElement("div");_.innerHTML=c;const m=[];return Array.from(_.childNodes).forEach(h=>{const I=new CKEDITOR.dom.element(h),P=new CKEDITOR.dom.node(I.$);m.push(P)}),m}_sanitizeHtmlSelection(c){let _=c.replace(/&#10;/g,"");const m=["p"];for(const h of m)_=this._trimStartTag(_,h);return _}_trimStartTag(c,_){const m=new RegExp(`^<${_}>(.*?)</${_}>`),h=new RegExp(`(<${_}>[^<]*</${_}>)(?!.*<${_}>[^<]*</${_}>)`,"i");return c.replace(m,"$1").replace(h,I=>I.replace(/<\/?p>/gi,""))}highlightSelection(c){if(!c||c.readOnly)return;this._removeHighlighting(c),c.getSelection().getRanges().forEach(h=>{c.fire("saveSnapshot"),this._highlightElements(h)}),this.clearSelection(c),c.fire("saveSnapshot")}removeHighlight(c){!c||c.readOnly||(this._removeHighlighting(c),this._removeSelection(c))}isEditorContainingSelection(c){const _=getSelection();return!_||!c?!1:!!c?.container?.$?.contains(_?.focusNode)}clearSelection(c){!c||c.readOnly||this._removeSelection(c)}replaceSelection(c,_){if(!c||c.readOnly)return;const m=this._getElementsBySelector(c,this._highlightClass);if(m.count()===0)return;const h=m.getItem(0),I=m.getItem(m.count()-1),P=this._markdownService.parse(_.selection),R=this._sanitizeHtmlSelection(P),f=this._retrieveSelectionNodes(R);switch(_.editorAction){case r.U.Replace:{const d=this._createRange(c,h,I);this._cleanUpRange(d);for(let v=f.length-1;v>=0;v--)d.insertNode(f[v]);break}case r.U.InsertAbove:for(let d=0;d<f.length;d++)h.insertBeforeMe(f[d]);break;case r.U.InsertBelow:for(let d=f.length-1;d>=0;d--)f[d].insertAfter(I);break}this.removeHighlight(c)}selectHighlighted(c){if(!c||c.readOnly)return;const _=this._getElementsBySelector(c,this._highlightClass),m=_.getItem(0),h=_.getItem(_.count()-1);if(!m||!h)return;this._removeSelection(c);const I=this._createRange(c,m,h),P=c.getSelection();P.selectRanges([I]);const R=P.createBookmarks(I);this._removeHighlighting(c),P.selectBookmarks(R),c.fire("saveSnapshot")}static{this.\u0275fac=function(_){return new(_||C)(y.\u0275\u0275inject(n.MarkdownService))}}static{this.\u0275prov=y.\u0275\u0275defineInjectable({token:C,factory:C.\u0275fac})}}},75648:(B,D,e)=>{e.d(D,{M:()=>M});var r=e(22307),a=e.n(r),l=e(79772),n=e.n(l);class M{static{this._wrapperClass="crt-table-of-contents"}static{this._translatePrefix="RichTextEditor"}static _getTranslate(u){return this._translateService.instant(`${this._translatePrefix}.${u}`)}static _insertTableOfContentsPlaceholder(u){const C=`<div contenteditable="false" class="${this._wrapperClass}">
		<div class="placeholder">
			<div class="title-wrapper">
				<img src="${CKEDITOR.plugins.getPath("crtTableOfContents")+"icon.svg"}"></img>
				<span class="title">${this._getTranslate("TableOfContents.Title")}</span>
			</div>
			${this._getTranslate("TableOfContents.Placeholder")}
		</div></div><br/>`;u.editor.insertHtml(C)}static _buildNestedList(u){const C=this._renderer.createElement("ul"),p=[{level:0,list:C}];return u.forEach(c=>{if(!c.id)return;const _=parseInt(c.tagName[1]),m=this._renderer.createElement("li"),h=this._createLink(c);this._appendLinkToItem(m,h),this._updateStack(p,_),this._appendItemToList(p,m,_)}),C}static _createLink(u){const C=this._renderer.createElement("a");return this._renderer.setAttribute(C,"href",`#${u.id}`),this._renderer.setProperty(C,"textContent",u.textContent),this._renderer.setAttribute(C,"tabIndex","0"),C}static _appendLinkToItem(u,C){this._renderer.appendChild(u,C)}static _updateStack(u,C){for(;u.length>1&&u[u.length-1].level>=C;)u.pop()}static _appendItemToList(u,C,p){if(u[u.length-1].level<p){const c=this._renderer.createElement("ul");this._renderer.appendChild(u[u.length-1].list,c),this._renderer.appendChild(c,C),u.push({level:p,list:c})}else this._renderer.appendChild(u[u.length-1].list,C),u.push({level:p,list:u[u.length-1].list})}static init(u){this._translateService=u.get(l.TranslateService);const C=u.get(r.RendererFactory2);this._renderer=C.createRenderer(null,null)}static subscribeEvents(u){u.on("CrtInsertTableOfContentsPlaceholder",this._insertTableOfContentsPlaceholder.bind(this))}static generateTableOfContents(u){const C=u?.editable?.()?.$,p=C?.getElementsByClassName(this._wrapperClass)||[];if(p.length<1)return;const c=C.querySelectorAll("h1, h2, h3, h4, h5, h6");c.length!==0&&(Array.from(c).filter(_=>_?.innerText?.trim()?.length>0).forEach((_,m)=>{_.id||(_.id=`crtHeader${m+1}`)}),Array.from(p).forEach(_=>{_.innerHTML="",_.appendChild(this._buildNestedList(c)),setTimeout(()=>{_.setAttribute("contenteditable","false")},0)}))}}},4092:(B,D,e)=>{e.d(D,{U:()=>r});var r;(function(a){a[a.General=0]="General",a[a.External=1]="External"})(r||(r={}))},57156:(B,D,e)=>{e.d(D,{U:()=>r});var r;(function(a){a.Replace="replace",a.InsertAbove="insertAbove",a.InsertBelow="insertBelow"})(r||(r={}))},85040:(B,D,e)=>{e.d(D,{u:()=>r});var r;(function(a){a.SetHighlighting="setHighlighting",a.RemoveHighlighting="removeHighlighting"})(r||(r={}))},48534:(B,D,e)=>{e.d(D,{i:()=>y});var r=e(62278),a=e.n(r),l=e(85040),n=e(22307),M=e.n(n);class y{constructor(){this._currentSubscriptionIdentifier=null,this._currentSubscription=null,this._replaceSelectionSubject=new r.Subject}_unsubscribeLastEditor(){if(this._currentSubscription){const C={editorAction:l.u.RemoveHighlighting};this._replaceSelectionSubject?.next(C),this._currentSubscriptionIdentifier=null,this._currentSubscription.unsubscribe()}}subscribeToNotifications(C,p){this._currentSubscriptionIdentifier!==C&&(this._unsubscribeLastEditor(),this._currentSubscriptionIdentifier=C,this._currentSubscription=this._replaceSelectionSubject.subscribe(p))}notify(C){this._replaceSelectionSubject?.next(C)}static{this.\u0275fac=function(p){return new(p||y)}}static{this.\u0275prov=n.\u0275\u0275defineInjectable({token:y,factory:y.\u0275fac,providedIn:"root"})}}},86142:B=>{B.exports=`<svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">\r
<path fill-rule="evenodd" clip-rule="evenodd" d="M9.91327 3.69279C9.53448 3.69279 9.17121 3.84326 8.90337 4.1111L4.46517 8.54931C3.98313 9.03135 3.71232 9.68513 3.71232 10.3668C3.71232 11.0485 3.98313 11.7023 4.46517 12.1844C4.94721 12.6664 5.60099 12.9372 6.2827 12.9372C6.96441 12.9372 7.6182 12.6664 8.10024 12.1844L12.5384 7.74617C12.8728 7.41182 13.4149 7.41182 13.7492 7.74617C14.0836 8.08052 14.0836 8.62261 13.7492 8.95696L9.31103 13.3952C8.50787 14.1983 7.41854 14.6495 6.2827 14.6495C5.14686 14.6495 4.05754 14.1983 3.25437 13.3952C2.45121 12.592 2 11.5027 2 10.3668C2 9.231 2.45121 8.14168 3.25437 7.33851L7.69258 2.90031C8.28154 2.31134 9.08035 1.98047 9.91327 1.98047C10.7462 1.98047 11.545 2.31134 12.1339 2.90031C12.7229 3.48927 13.0538 4.28807 13.0538 5.12099C13.0538 5.95391 12.7229 6.75271 12.1339 7.34167L7.69003 11.7799C7.3153 12.1544 6.80683 12.3652 6.27699 12.3652C5.747 12.3652 5.23871 12.1546 4.86395 11.7799C4.48919 11.4051 4.27865 10.8968 4.27865 10.3668C4.27865 9.83685 4.48919 9.32856 4.86395 8.9538L8.90298 4.92049C9.23753 4.58633 9.77962 4.58665 10.1138 4.9212C10.4479 5.25575 10.4476 5.79784 10.1131 6.13199L6.07475 10.1646C6.02116 10.2182 5.99097 10.291 5.99097 10.3668C5.99097 10.4427 6.02111 10.5154 6.07475 10.5691C6.12839 10.6227 6.20114 10.6529 6.27699 10.6529C6.35285 10.6529 6.4256 10.6227 6.47924 10.5691L10.9232 6.13088C11.191 5.86305 11.3415 5.49974 11.3415 5.12099C11.3415 4.74221 11.191 4.37894 10.9232 4.1111C10.6553 3.84326 10.292 3.69279 9.91327 3.69279Z" fill="currentColor"/>\r
</svg>\r
`},29759:B=>{B.exports=`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\r
    <path fill-rule="evenodd" clip-rule="evenodd" d="M13.1592 7.99998C13.1592 5.15064 10.8494 2.84079 8.00004 2.84079C5.1507 2.84079 2.84085 5.15064 2.84085 7.99998C2.84085 10.8493 5.1507 13.1592 8.00004 13.1592C10.8494 13.1592 13.1592 10.8493 13.1592 7.99998ZM8.00004 1.50079C11.5894 1.50079 14.4992 4.41058 14.4992 7.99998C14.4992 11.5894 11.5894 14.4992 8.00004 14.4992C4.41064 14.4992 1.50085 11.5894 1.50085 7.99998C1.50085 4.41058 4.41064 1.50079 8.00004 1.50079ZM7.16167 5.39671C7.16167 4.93555 7.53551 4.56171 7.99667 4.56171H8.00333C8.46449 4.56171 8.83833 4.93555 8.83833 5.39671C8.83833 5.85786 8.46449 6.23171 8.00333 6.23171H7.99667C7.53551 6.23171 7.16167 5.85786 7.16167 5.39671ZM7.99979 6.95437C8.46095 6.95477 8.83447 7.32893 8.83407 7.79009L8.83163 10.6063C8.83123 11.0674 8.45706 11.4409 7.9959 11.4405C7.53475 11.4401 7.16123 11.066 7.16163 10.6048L7.16407 7.78864C7.16447 7.32749 7.53864 6.95397 7.99979 6.95437Z" fill="currentColor"/>\r
</svg>\r
`},37480:B=>{B.exports=`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\r
<path fill-rule="evenodd" clip-rule="evenodd" d="M8.67553 3.30182C8.67553 2.85899 9.03452 2.5 9.47735 2.5H12.6017C13.0975 2.5 13.4995 2.90198 13.4995 3.39784V6.52217C13.4995 6.965 13.1405 7.32398 12.6977 7.32398C12.2549 7.32398 11.8959 6.965 11.8959 6.52217V5.23993L7.61104 9.53408C7.29825 9.84755 6.79057 9.8481 6.4771 9.53531C6.16363 9.22252 6.16308 8.71484 6.47587 8.40137L10.7643 4.10363H9.47735C9.03452 4.10363 8.67553 3.74465 8.67553 3.30182ZM5.22234 4.10363C4.60449 4.10363 4.10363 4.60449 4.10363 5.22234V10.7776C4.10363 11.3954 4.60449 11.8963 5.22234 11.8963H10.7776C11.3954 11.8963 11.8963 11.3954 11.8963 10.7776V9.78139C11.8963 9.33856 12.2553 8.97958 12.6981 8.97958C13.1409 8.97958 13.4999 9.33856 13.4999 9.78139V10.7776C13.4999 12.2811 12.2811 13.4999 10.7776 13.4999H5.22234C3.71883 13.4999 2.5 12.2811 2.5 10.7776V5.22234C2.5 3.71883 3.71883 2.5 5.22234 2.5H6.18746C6.63029 2.5 6.98928 2.85899 6.98928 3.30182C6.98928 3.74465 6.63029 4.10363 6.18746 4.10363H5.22234Z" fill="currentColor"/>\r
</svg>\r
`},54373:B=>{B.exports=`<svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">\r
<g>\r
<path d="M13.7355 1.48633H3.73547C2.6309 1.48633 1.73547 2.38176 1.73547 3.48633V13.4863C1.73547 14.5909 2.6309 15.4863 3.73547 15.4863H13.7355C14.84 15.4863 15.7355 14.5909 15.7355 13.4863V3.48633C15.7355 2.38176 14.84 1.48633 13.7355 1.48633Z" stroke="currentColor" stroke-width="2" stroke-miterlimit="10"/>\r
<path d="M9.73547 12.4863H7.73547V6.48633H4.73547V4.48633H12.7355V6.48633H9.73547V12.4863Z" fill="currentColor"/>\r
</g>\r
</svg>\r
`},42085:B=>{B.exports=`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\r
<path fill-rule="evenodd" clip-rule="evenodd" d="M3.69231 2C3.24348 2 2.81303 2.1783 2.49567 2.49567C2.1783 2.81303 2 3.24348 2 3.69231V12.3077C2 12.7565 2.1783 13.187 2.49567 13.5043C2.81303 13.8217 3.24348 14 3.69231 14H12.3077C12.7565 14 13.187 13.8217 13.5043 13.5043C13.8217 13.187 14 12.7565 14 12.3077V5.53846C14 5.41605 13.9514 5.29866 13.8648 5.2121L10.7879 2.13518C10.7013 2.04863 10.5839 2 10.4615 2H3.69231ZM11.2653 7.25728C11.6058 6.95867 11.6397 6.44059 11.3411 6.10011C11.0425 5.75963 10.5244 5.72569 10.1839 6.0243L6.7897 9.00114L5.80197 8.05396C5.4751 7.74051 4.95601 7.75139 4.64257 8.07826C4.32912 8.40514 4.34 8.92422 4.66687 9.23767L6.19742 10.7054C6.5045 10.9998 6.98579 11.0105 7.30565 10.73L11.2653 7.25728Z" fill="currentColor"/>\r
</svg>\r
`},56148:B=>{B.exports=`<svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">\r
<path fill-rule="evenodd" clip-rule="evenodd" d="M2.5 3.31445C2.5 2.76217 2.94772 2.31445 3.5 2.31445H13.5C14.0523 2.31445 14.5 2.76217 14.5 3.31445V4.28496C14.5 4.83725 14.0523 5.28496 13.5 5.28496H3.5C2.94772 5.28496 2.5 4.83724 2.5 4.28496V3.31445ZM7.44922 7.32042C7.44922 6.76813 7.89693 6.31768 8.44922 6.31768H13.4492C14.0015 6.31768 14.4492 6.76813 14.4492 7.32042C14.4492 7.8727 14.0015 8.32316 13.4492 8.32316H8.44922C7.89693 8.32316 7.44922 7.8727 7.44922 7.32042ZM14.4492 10.3161C14.4492 9.76378 14.0015 9.31332 13.4492 9.31332H8.44922C7.89693 9.31332 7.44922 9.76378 7.44922 10.3161C7.44922 10.8683 7.89693 11.3188 8.44922 11.3188H13.4492C14.0015 11.3188 14.4492 10.8683 14.4492 10.3161ZM7.44922 13.3117C7.44922 12.7594 7.89693 12.309 8.44922 12.309H13.4492C14.0015 12.309 14.4492 12.7594 14.4492 13.3117C14.4492 13.864 14.0015 14.3145 13.4492 14.3145H8.44922C7.89693 14.3145 7.44922 13.864 7.44922 13.3117ZM6.5 7.29254C6.5 6.74025 6.05228 6.29254 5.5 6.29254H3.5C2.94772 6.29254 2.5 6.74025 2.5 7.29254V13.2139C2.5 13.7662 2.94772 14.2139 3.5 14.2139H5.5C6.05228 14.2139 6.5 13.7662 6.5 13.2139V7.29254Z" fill="currentColor"/>\r
</svg>\r
`},52655:B=>{B.exports=`<svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">\r
<path fill-rule="evenodd" clip-rule="evenodd" d="M14.8054 3.54116C15.0664 3.27893 15.0655 2.85471 14.8033 2.59364C14.5411 2.33256 14.1168 2.33349 13.8558 2.59572L13.0894 3.36548C12.848 3.19009 12.5809 3.04244 12.2943 2.95882C12.0236 2.87985 11.7237 2.85474 11.4149 2.92959C11.1043 3.00489 10.8272 3.17115 10.5891 3.40989L8.50246 5.50488C8.26429 5.744 8.09908 6.02184 8.02434 6.33239C7.95008 6.64101 7.97498 6.94087 8.05342 7.21173C8.20418 7.73228 8.56447 8.18891 8.91972 8.54519C9.27452 8.90182 9.72985 9.26456 10.2498 9.4164C10.5206 9.49549 10.8208 9.5206 11.1298 9.44543C11.4405 9.36985 11.7176 9.20319 11.9555 8.96413L14.0418 6.86944C14.2799 6.63038 14.4451 6.35262 14.5199 6.0421C14.5942 5.7335 14.5692 5.43367 14.4908 5.16285C14.4008 4.85233 14.2363 4.56451 14.0427 4.30714L14.8054 3.54116ZM12.1243 4.33479L11.3749 5.08754C11.1138 5.34976 11.1147 5.77398 11.377 6.03506C11.6392 6.29613 12.0634 6.2952 12.3245 6.03298L13.0814 5.27274C13.1403 5.36906 13.181 5.45731 13.2037 5.53572C13.2296 5.62497 13.2275 5.68522 13.2171 5.72848C13.2071 5.76981 13.1801 5.83569 13.0923 5.92382L11.006 8.0185C10.9181 8.10689 10.8527 8.13376 10.8131 8.1434C10.7716 8.15349 10.7132 8.15576 10.6254 8.13012C10.4282 8.07253 10.1664 7.89836 9.86944 7.59987C9.57303 7.30265 9.39836 7.03864 9.34053 6.83896C9.31466 6.74964 9.31672 6.68928 9.32715 6.64591C9.33712 6.60447 9.36416 6.53857 9.45188 6.4505L11.5379 4.35612C11.6256 4.26822 11.6908 4.24152 11.7306 4.23186C11.7723 4.22175 11.831 4.21953 11.919 4.24519C11.9813 4.26337 12.0501 4.29316 12.1243 4.33479Z" fill="currentColor"/>\r
<path fill-rule="evenodd" clip-rule="evenodd" d="M4.68883 14.8904C4.39456 14.8045 4.12097 14.651 3.87456 14.4693L3.1448 15.2023C2.88373 15.4645 2.45951 15.4655 2.19728 15.2044C1.93506 14.9433 1.93412 14.5191 2.1952 14.2569L2.92612 13.5227C2.73833 13.2699 2.57926 12.9881 2.49137 12.6847C2.41289 12.4137 2.38799 12.1137 2.46228 11.805C2.53704 11.4943 2.70232 11.2164 2.94059 10.9771L5.02824 8.88111C5.26643 8.64226 5.54401 8.47564 5.8547 8.40031C6.16356 8.32543 6.46362 8.35055 6.73441 8.42955C7.25451 8.58128 7.71012 8.94371 8.0653 9.30031C8.42058 9.65701 8.78117 10.1139 8.93203 10.6347C9.01052 10.9056 9.03545 11.2056 8.96113 11.5143C8.88634 11.8249 8.72104 12.1028 8.48283 12.342L6.39549 14.4377C6.15749 14.6768 5.88001 14.8439 5.56923 14.9195C5.26011 14.9947 4.95979 14.9696 4.68883 14.8904ZM5.97749 9.8269C6.06532 9.73887 6.13047 9.71227 6.17043 9.70258C6.21224 9.69245 6.27105 9.69023 6.35912 9.71592C6.55676 9.77358 6.81888 9.94774 7.11588 10.2459C7.41279 10.544 7.58706 10.8077 7.64496 11.0076C7.67085 11.0969 7.66879 11.1573 7.65835 11.2007C7.64837 11.2421 7.62129 11.3081 7.53341 11.3963L5.44577 13.4924C5.35774 13.5809 5.29224 13.6078 5.25248 13.6175C5.21093 13.6276 5.15238 13.6298 5.06447 13.6042C4.99616 13.5842 4.92011 13.5503 4.83756 13.5021L5.62511 12.7111C5.88618 12.4489 5.88525 12.0246 5.62303 11.7636C5.3608 11.5025 4.93658 11.5034 4.6755 11.7656L3.88909 12.5555C3.83644 12.4667 3.79967 12.385 3.77848 12.3119C3.75258 12.2225 3.75462 12.162 3.76509 12.1185C3.77508 12.0769 3.80218 12.0109 3.89001 11.9228L5.97749 9.8269Z" fill="currentColor"/>\r
</svg>\r
`},14560:B=>{B.exports=`<svg width="72" height="40" viewBox="0 0 72 40" fill="none" xmlns="http://www.w3.org/2000/svg">\r
<rect x="8.5" y="8.5" width="55" height="23" rx="0.5" fill="white" stroke="#0D2E4E"/>\r
<path d="M37 17H19C17.3431 17 16 18.3431 16 20C16 21.6569 17.3431 23 19 23H37C38.6569 23 40 21.6569 40 20C40 18.3431 38.6569 17 37 17Z" fill="#D1D1D1"/>\r
<path d="M57 13H47C45.8954 13 45 13.8954 45 15V25C45 26.1046 45.8954 27 47 27H57C58.1046 27 59 26.1046 59 25V15C59 13.8954 58.1046 13 57 13Z" stroke="#FF4013" stroke-width="2" stroke-miterlimit="10"/>\r
<path d="M53 24H51V18H48V16H56V18H53V24Z" fill="#FF4013"/>\r
</svg>\r
`}}]);
