(self.webpackChunkapp_studio_enterprise_schema_view=self.webpackChunkapp_studio_enterprise_schema_view||[]).push([[7513],{7513:(C,Wt,o)=>{o.r(Wt),o.d(Wt,{AcceptChatHandler:()=>ot,AcceptChatRequest:()=>Mt,AgentInboxModeHandler:()=>ht,AgentInboxModeRequest:()=>Ut,BaseAgentItemClickedHandler:()=>ut,BaseAgentItemClickedRequest:()=>kt,BaseLoadInProgressChatsConverter:()=>$,CallAiContextService:()=>R,CallSelectionService:()=>B,ClearCallDetailsHandler:()=>st,ClearCallDetailsRequest:()=>rt,CloseCallDetailsHandler:()=>ct,CloseCallDetailsRequest:()=>Pt,ContactSearchService:()=>L,CrtAgentInboxPreprocessor:()=>j,CrtContactCenterModule:()=>gt,CrtIncomingItemListPreprocessor:()=>H,CtiActionsService:()=>U,CtiStateService:()=>S,IsCallActiveConverter:()=>nt,IsCallDetailsChangedAndWrapUpConverter:()=>lt,IsCallDetailsChangedConverter:()=>at,IsCallDetailsUnchangedConverter:()=>it,LoadInProgressChatsConverter:()=>G,LoadNotAcceptedChatsConverter:()=>q,MergeIncomingItemsConverter:()=>tt,RunCtiProcessActionHandler:()=>dt,RunCtiProcessActionRequest:()=>Et,SaveCallDetailsHandler:()=>mt,SaveCallDetailsRequest:()=>Dt,SubscribeToChatUpdateHandler:()=>Ct,SubscribeToChatUpdateRequest:()=>Tt,SubscribeToCtiEventsHandler:()=>pt,SubscribeToCtiEventsRequest:()=>Nt,ViewModelCollectionToIncomingItemsArray:()=>et,WrapUpService:()=>I});var r=o(5960),vt=o(30421),f=o(67057),ft=o(37851),D=o(50725),fe=o(55642),k=o(79772),Zt=o(5476),zt=o(50663),Kt=o(61832),Qt=o(42656),Yt=o(48629),Jt=o(90895),Xt=o(65269),Gt=o(69015),qt=o(17371),te=o(24091),W=o(31149),ee=o(53173),ne=o(40203),ae=o(57274),ie=o(61148),le=o(75034),oe=o(12841),e=o(22307),b=o(34760),E=o(77592),Z=o(1034),z=o(96677),K=o(68712),ye=o(12325),m=o(73308),yt=o(6530),Ie=o(91775),be=o(56027),xe=o(2703),It=o(41314),we=o(90983),bt=o(23092),u=o(28399),Se=o(30046),Oe=o.n(Se),Ae=o(53703),re=o(95588),Me=o(80615),Pe=o(20405),se=o(96079),xt=o(13232);const Ee=i=>({"item-outdated":i});function Te(i,t){i&1&&(e.\u0275\u0275elementStart(0,"crt-chip",12),e.\u0275\u0275text(1," Input due "),e.\u0275\u0275elementEnd())}function Ne(i,t){if(i&1){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",13)(1,"crt-button",14),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(n);const l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.onAcceptClick())}),e.\u0275\u0275elementEnd()()}i&2&&(e.\u0275\u0275advance(),e.\u0275\u0275property("caption",e.\u0275\u0275pipeBind1(2,1,"IncomingItemList.AcceptButtonLabel")))}let F=class Ht extends K.K{set data(t){this._incomingItem=t,this.incomingItem&&!this.incomingItem.createdOn&&(this.incomingItem.createdOn=this._getCurrentDateWithProfileTimezone().toDate()),this._setOutdateTimer()}get isOutdated(){const t=this._getTimeBeforeOutdate();return!!t&&t>=this._outdateDelay}set outdateDelay(t){this._outdateDelay=t*60,this._setOutdateTimer()}get incomingItem(){return this._incomingItem}get icon(){let t=this._incomingItem?.schemaName?.toLowerCase();return be.z.includes(t)||(t="default"),`${t}-entity-icon`}get tileIconKey(){return this._incomingItem?.schemaName||"omnichat"}get ownerId(){return this._incomingItem?.contact?.value}get ownerName(){return this._incomingItem?.contact?.displayValue?.toString()}get ownerNamePlaceholder(){const t=this.ownerName;return(0,u.isEmpty)(t)?"":t[0]}get photoUrl(){const t=this._incomingItem?.contact?.primaryImageValue;return t&&t!==yt.To?(0,It.Mc)(t):""}get createdOn(){return this._incomingItem?new Date(this._incomingItem.createdOn):null}get isNeedAccept(){return this._incomingItem?.accepted===!1}get isPendingDetails(){return!0}get description(){return this._incomingItem?.itemTitle}constructor(t,n){super(t),this.injector=t,this._userInfo=n,this._outdateDelay=0,this.timerType=xe.a.Stopwatch,this.acceptClick=new e.EventEmitter}_openDefaultPage(t,n){return(0,m.A)(function*(){const a={type:"crt.UpdateRecordRequest",entityName:t,recordId:n,$context:null};yield Ie.t.instance.process(a)})()}_getTimeBeforeOutdate(){return!this._incomingItem?.createdOn||!this._outdateDelay?null:this._getCurrentDateWithProfileTimezone().diff(this._incomingItem?.createdOn,"seconds",!1)}_getCurrentDateWithProfileTimezone(){const t=new Date;return Oe()().add(this._userInfo.timeZoneOffsetHours,"hours").add(t.getTimezoneOffset(),"minutes")}_setOutdateTimer(){const t=this._getTimeBeforeOutdate();t===null||t>=this._outdateDelay||setTimeout(()=>{this.changeDetectorRef.detectChanges()},(this._outdateDelay-t+1)*1e3)}onLinkClick(t,n){var a=this;return(0,m.A)(function*(){yield a._openDefaultPage(t,n)})()}get ownerLink(){const t=this.ownerId;return t?(0,we.TX)("Contact",t):""}onAcceptClick(){this.acceptClick.emit(this._incomingItem)}static{this.\u0275fac=function(n){return new(n||Ht)(e.\u0275\u0275directiveInject(e.Injector),e.\u0275\u0275directiveInject(bt.oq))}}static{this.\u0275cmp=e.\u0275\u0275defineComponent({type:Ht,selectors:[["crt-incoming-item"]],inputs:{data:"data",outdateDelay:"outdateDelay"},outputs:{acceptClick:"acceptClick"},features:[e.\u0275\u0275InheritDefinitionFeature],decls:15,vars:18,consts:[[1,"icoming-item-tile",3,"ngClass"],[1,"icoming-item-tile-header"],[1,"icoming-item-tile-icon"],[3,"tileKey","icon"],[1,"icoming-item-tile-caption",3,"title"],["class","icoming-item-tile-caption-chip","color","Orange",4,"ngIf"],[1,"icoming-item-tile-footer"],[1,"icoming-item-tile-owner"],["readonly","true","placeholderMode","abbreviation","borderRadius","large","positioning","scale-down","size","none",1,"icoming-item-tile-owner-photo",3,"value","placeholder","colorId"],["mode","'preventDefault'",1,"icoming-item-tile-owner-link",3,"clicked","href"],[1,"icoming-item-tile-date",3,"timerType","control"],["class","icoming-item-tile-actions",4,"ngIf"],["color","Orange",1,"icoming-item-tile-caption-chip"],[1,"icoming-item-tile-actions"],["size","medium","color","accent",3,"clicked","caption"]],template:function(n,a){n&1&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"div",2),e.\u0275\u0275element(3,"crt-entity-icon",3),e.\u0275\u0275pipe(4,"lowercase"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"div",4),e.\u0275\u0275text(6),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(7,Te,2,0,"crt-chip",5),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"div",6)(9,"div",7),e.\u0275\u0275element(10,"crt-image-input",8),e.\u0275\u0275elementStart(11,"crt-link",9),e.\u0275\u0275listener("clicked",function(){return a.onLinkClick("Contact",a.ownerId)}),e.\u0275\u0275text(12),e.\u0275\u0275elementEnd()(),e.\u0275\u0275element(13,"crt-timer",10),e.\u0275\u0275template(14,Ne,3,3,"div",11),e.\u0275\u0275elementEnd()()),n&2&&(e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(16,Ee,a.isOutdated)),e.\u0275\u0275advance(3),e.\u0275\u0275property("tileKey",e.\u0275\u0275pipeBind1(4,14,a.tileIconKey))("icon",a.icon),e.\u0275\u0275advance(2),e.\u0275\u0275property("title",a.description),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",a.description," "),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",!1),e.\u0275\u0275advance(3),e.\u0275\u0275property("value",a.photoUrl)("placeholder",a.ownerNamePlaceholder)("colorId",a.ownerId),e.\u0275\u0275advance(),e.\u0275\u0275property("href",a.ownerLink),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",a.ownerName," "),e.\u0275\u0275advance(),e.\u0275\u0275property("timerType",a.timerType)("control",a.createdOn),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",a.isNeedAccept))},dependencies:[f.NgClass,f.NgIf,Ae.h,re.g,Me.j,Pe.N,se.k,xt.B,f.LowerCasePipe,k.TranslatePipe],styles:["body[_ngcontent-%COMP%]{--focus-outline-outer-color: var(--crt-palette-secondary-500);--focus-outline-inner-color: white}.icoming-item-tile[_ngcontent-%COMP%]{height:96px;max-width:100%;border:1px solid var(--crt-palette-interaction-900);border-radius:8px;overflow:auto;background:var(--crt-palette-background-400);padding:5px}.icoming-item-tile.item-outdated[_ngcontent-%COMP%]{border-color:var(--crt-palette-error-500);box-shadow:1px 1px 5px var(--crt-palette-error-500)}.icoming-item-tile[_ngcontent-%COMP%]   crt-chip.icoming-item-tile-caption-chip[_ngcontent-%COMP%]{font-family:var(--crt-body-2-font-family);font-size:var(--crt-body-2-font-size);line-height:var(--crt-body-2-line-height);font-weight:var(--crt-body-2-font-weight);letter-spacing:var(--crt-body-2-letter-spacing);text-transform:var(--crt-body-2-text-transform);-webkit-font-smoothing:antialiased;margin-top:6px;max-width:67px}.icoming-item-tile[_ngcontent-%COMP%]   crt-chip.icoming-item-tile-caption-chip[_ngcontent-%COMP%]   .crt-chip-focus-overlay[_ngcontent-%COMP%]{background-color:#ffd9d0;opacity:.2}.icoming-item-tile.selected[_ngcontent-%COMP%]{background-color:var(--crt-palette-interaction-900)}.icoming-item-tile[_ngcontent-%COMP%]:hover{background-color:var(--crt-palette-interaction-700)}.icoming-item-tile[_ngcontent-%COMP%]:hover   .icoming-item-tile-actions[_ngcontent-%COMP%]{width:100px;display:inline-block}.icoming-item-tile[_ngcontent-%COMP%]:hover   .icoming-item-tile-date[_ngcontent-%COMP%]{display:none}.icoming-item-tile-header[_ngcontent-%COMP%]{display:flex}.icoming-item-tile-footer[_ngcontent-%COMP%]{display:flex;margin:12px 8px 0;align-items:center;height:24px}.icoming-item-tile-caption[_ngcontent-%COMP%]{font-family:var(--crt-body-1-font-family);font-size:var(--crt-body-1-font-size);line-height:var(--crt-body-1-line-height);font-weight:var(--crt-body-1-font-weight);letter-spacing:var(--crt-body-1-letter-spacing);text-transform:var(--crt-body-1-text-transform);-webkit-font-smoothing:antialiased;width:calc(100% - 32px);overflow:hidden;height:2.8em;margin-top:6px;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;text-overflow:ellipsis;cursor:pointer}.icoming-item-tile-owner[_ngcontent-%COMP%]{font-family:var(--crt-caption-font-family);font-size:var(--crt-caption-font-size);line-height:var(--crt-caption-line-height);font-weight:var(--crt-caption-font-weight);letter-spacing:var(--crt-caption-letter-spacing);text-transform:var(--crt-caption-text-transform);-webkit-font-smoothing:antialiased;width:100%;display:inline-flex;overflow:hidden;margin-inline-end:3em}.icoming-item-tile-owner-photo[_ngcontent-%COMP%]{width:16px;display:flex;height:16px;margin-inline-end:8px}.icoming-item-tile-owner-photo[_ngcontent-%COMP%]   .placeholder-abbreviation.no-photo[_ngcontent-%COMP%]{min-width:unset;min-height:unset;line-height:16px;height:16px;width:16px;font-size:8px}.icoming-item-tile-owner-photo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{object-fit:unset}.icoming-item-tile-owner-link[_ngcontent-%COMP%]{max-width:calc(100% - 24px)}.icoming-item-tile-actions[_ngcontent-%COMP%]{display:none}"]})}};F=(0,r.__decorate)([(0,Z.v)({type:"crt.IncomingItem",reuseStrategy:z.B.Reuse}),(0,r.__metadata)("design:paramtypes",[e.Injector,bt.oq])],F);function De(i,t){i&1&&(e.\u0275\u0275elementStart(0,"div",3),e.\u0275\u0275element(1,"crt-label",4),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"crt-label",5),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd()),i&2&&(e.\u0275\u0275advance(),e.\u0275\u0275property("caption",e.\u0275\u0275pipeBind1(2,2,"IncomingItemList.NoDataLabel")),e.\u0275\u0275advance(2),e.\u0275\u0275property("caption",e.\u0275\u0275pipeBind1(4,4,"IncomingItemList.NoDataDescription")))}function ke(i,t){if(i&1){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div")(1,"div",7)(2,"crt-incoming-item",8),e.\u0275\u0275listener("click",function(){const l=e.\u0275\u0275restoreView(n).$implicit,s=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(s.onItemClick(l))})("acceptClick",function(l){e.\u0275\u0275restoreView(n);const s=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(s.onItemAccept(l))}),e.\u0275\u0275elementEnd()()()}if(i&2){const n=t.$implicit,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(2),e.\u0275\u0275property("data",n)("outdateDelay",a.outdateDelay)}}function Ue(i,t){if(i&1&&e.\u0275\u0275template(0,ke,3,2,"div",6),i&2){const n=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngForOf",n.items)}}let x=class _t extends K.K{constructor(){super(...arguments),this.tileClick=new e.EventEmitter,this.itemAccept=new e.EventEmitter,this.outdateDelay=0}set items(t){this._items=t,window.requestAnimationFrame(()=>{this.changeDetectorRef.detectChanges()})}get items(){return this._items}onItemClick(t){this.tileClick.emit(t)}onItemAccept(t){this.itemAccept.emit(t)}static{this.\u0275fac=(()=>{let t;return function(a){return(t||(t=e.\u0275\u0275getInheritedFactory(_t)))(a||_t)}})()}static{this.\u0275cmp=e.\u0275\u0275defineComponent({type:_t,selectors:[["crt-incoming-item-list"]],inputs:{outdateDelay:"outdateDelay",items:"items"},outputs:{tileClick:"tileClick",itemAccept:"itemAccept"},features:[e.\u0275\u0275InheritDefinitionFeature],decls:4,vars:2,consts:[["incoming_items",""],[1,"incoming-item-list"],["class","incoming-item-list-no-data",4,"ngIf","ngIfElse"],[1,"incoming-item-list-no-data"],[1,"incoming-item-list-no-data-label",3,"caption"],[1,"incoming-item-list-no-data-description",3,"caption"],[4,"ngFor","ngForOf"],[1,"incoming-item-wrapper"],[3,"click","acceptClick","data","outdateDelay"]],template:function(n,a){if(n&1&&(e.\u0275\u0275elementStart(0,"div",1),e.\u0275\u0275template(1,De,5,6,"div",2)(2,Ue,1,1,"ng-template",null,0,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),n&2){const l=e.\u0275\u0275reference(3);e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",(a.items==null?null:a.items.length)===0)("ngIfElse",l)}},dependencies:[f.NgForOf,f.NgIf,ye.V,F,k.TranslatePipe],styles:[".incoming-item-list[_ngcontent-%COMP%]{width:100%}.incoming-item-list[_ngcontent-%COMP%]   .incoming-item-wrapper[_ngcontent-%COMP%]{padding:5px}.incoming-item-list-no-data[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;height:100%}.incoming-item-list-no-data-label[_ngcontent-%COMP%]{margin-top:35px}.incoming-item-list-no-data-description[_ngcontent-%COMP%]{margin-top:16px}"]})}};(0,r.__decorate)([(0,b.j)(),(0,r.__metadata)("design:type",Object)],x.prototype,"tileClick",void 0),(0,r.__decorate)([(0,b.j)(),(0,r.__metadata)("design:type",Object)],x.prototype,"itemAccept",void 0),(0,r.__decorate)([(0,E.k)(),(0,r.__metadata)("design:type",Object)],x.prototype,"outdateDelay",void 0),(0,r.__decorate)([(0,E.k)({reuseStrategy:{resetValue:!0}}),(0,r.__metadata)("design:type",Array),(0,r.__metadata)("design:paramtypes",[Array])],x.prototype,"items",null),x=(0,r.__decorate)([(0,Z.v)({type:"crt.IncomingItems",reuseStrategy:z.B.Reuse})],x);var c=o(62278),Ve=o(89422);const Le="OmniChat",Be="1d96a65f-2131-4916-8825-2d142b1000b2",Rn="53f71b5f-7e17-4cf5-bf14-6a59212db422",ce=20;var g;(function(i){i.Zero="0",i.One="1",i.Two="2",i.Three="3",i.Four="4",i.Five="5",i.Six="6",i.Seven="7",i.Eight="8",i.Nine="9",i.Asterisk="*",i.Hashtag="#"})(g||(g={}));var T;(function(i){i[i.CAN_NOTHING=0]="CAN_NOTHING",i[i.CAN_RECALL=1]="CAN_RECALL",i[i.CAN_DIAL=2]="CAN_DIAL",i[i.CAN_ANSWER=4]="CAN_ANSWER",i[i.CAN_DROP=8]="CAN_DROP",i[i.CAN_HOLD=16]="CAN_HOLD",i[i.CAN_UNHOLD=32]="CAN_UNHOLD",i[i.CAN_SETUP_TRANSFER=64]="CAN_SETUP_TRANSFER",i[i.CAN_COMPLETE_TRANSFER=128]="CAN_COMPLETE_TRANSFER",i[i.CAN_CANCEL_COMPLETE_TRANSFER=8192]="CAN_CANCEL_COMPLETE_TRANSFER",i[i.CAN_BLIND_TRANSFER=256]="CAN_BLIND_TRANSFER",i[i.CAN_MAKE_CONSULT_CALL=512]="CAN_MAKE_CONSULT_CALL",i[i.CAN_DTMF=1024]="CAN_DTMF",i[i.CAN_VIDEO=2048]="CAN_VIDEO",i[i.CAN_MUTE=4096]="CAN_MUTE"})(T||(T={}));var w;(function(i){i[i.NONE=0]="NONE",i[i.ALERTING=1]="ALERTING",i[i.CONNECTED=2]="CONNECTED",i[i.HOLDED=3]="HOLDED",i[i.CONFERENCED=4]="CONFERENCED",i[i.UNKNOWN=5]="UNKNOWN",i[i.BUSY=6]="BUSY"})(w||(w={}));var de=o(59969);class U{constructor(t){this._customEventService=t,this._actionsChannelName="FreedomCtiAction",this._ctiEventsChannelName="CtiModelEvents",this._callInfoChannelName="CurrentCallUpdates"}_sendCtiAction(t,n){const a=n?[t,...n]:[t];this._customEventService.createOutboundChannel(this._actionsChannelName).next(a)}getCtiEvents(){return this._customEventService.subscribe(this._ctiEventsChannelName)}getCurrentCallUpdates(){return this._customEventService.subscribe(this._callInfoChannelName)}getCtiState(){this._sendCtiAction("get_cti_state")}answerCall(){this._sendCtiAction("answer")}declineCall(){this._sendCtiAction("decline")}toggleHoldCall(){this._sendCtiAction("toggleHold")}toggleMuteCall(){this._sendCtiAction("toggleMute")}startTransfer(){this._sendCtiAction("start_transfer")}endTransfer(){this._sendCtiAction("end_transfer")}cancelTransfer(){this._sendCtiAction("cancel_transfer")}sendDtmf(t){this._sendCtiAction("dtmf",[t])}makeCall(t){this._sendCtiAction("make_call",[t])}makeConsultCall(t){this._sendCtiAction("make_consult_call",[t])}blindTransfer(t){this._sendCtiAction("blind_transfer",[t])}updateCallIdentity(t,n){this._sendCtiAction("update_call_identity",[t,n])}static{this.\u0275fac=function(n){return new(n||U)(e.\u0275\u0275inject(de.Dj))}}static{this.\u0275prov=e.\u0275\u0275defineInjectable({token:U,factory:U.\u0275fac,providedIn:"root"})}}var Q=o(49973),V=o(58504),wt=o(65751);class L{constructor(t){this._queryExecutor=t}_createQueryContactCommunication(t){const n=new Q.s("ContactCommunication");return n.addSchemaColumn("Number","number"),n.addSchemaColumn("Contact","contact"),n.addSchemaColumn("CommunicationType","communicationType"),n.filters.addSchemaColumnFilterWithParameter(V.H.Equal,"[ComTypebyCommunication:CommunicationType:CommunicationType].Communication","E037F25A-D7BC-DF11-B00F-001D60E938C6"),n.rowCount=10,n.filters.addSchemaColumnFilterWithParameter(V.H.Contain,"Contact.Name",t),n}_createQueryAccountCommunication(t){const n=new Q.s("AccountCommunication");return n.addSchemaColumn("Number","number"),n.addSchemaColumn("Account","contact"),n.addSchemaColumn("CommunicationType","communicationType"),n.filters.addSchemaColumnFilterWithParameter(V.H.Equal,"[ComTypebyCommunication:CommunicationType:CommunicationType].Communication","E037F25A-D7BC-DF11-B00F-001D60E938C6"),n.rowCount=10,n.filters.addSchemaColumnFilterWithParameter(V.H.Contain,"Account.Name",t),n}search(t){var n=this;return(0,m.A)(function*(){const a=n._createQueryAccountCommunication(t),l=n._createQueryContactCommunication(t);try{const s=yield(0,c.firstValueFrom)(n._queryExecutor.executeSelectQuery(a).pipe((0,c.catchError)(()=>(0,c.of)([])))),d=yield(0,c.firstValueFrom)(n._queryExecutor.executeSelectQuery(l).pipe((0,c.catchError)(()=>(0,c.of)([]))));return[...s,...d].map(p=>({id:p.contact.value,contactName:p.contact.displayValue,contactPhoto:p.contact.primaryImageValue!==yt.To?(0,It.Mc)(p.contact.primaryImageValue):"",number:p.number,communicationType:p.communicationType.displayValue}))}catch{return[]}})()}static{this.\u0275fac=function(n){return new(n||L)(e.\u0275\u0275inject(wt.w))}}static{this.\u0275prov=e.\u0275\u0275defineInjectable({token:L,factory:L.\u0275fac})}}var St=o(36486);class Ot{constructor(t){this.id=t?.Id,this.name=t?.Name,this.number=t?.Number,this.photo=(0,It.Mc)(t?.Photo),this.entityName=t?.Type,this.fields=[],t?.AccountName&&this.fields.push({caption:"CallConversation.Account",value:t?.AccountName}),t?.Job&&this.fields.push({caption:"CallConversation.JobTitle",value:t?.Job}),this.fields.push({caption:t?.CommunicationType,value:t?.Number,isHighlighted:!0})}}class Re{get dtmfInput(){return this._dtmfInput?.length>ce?this._dtmfInput.substring(this._dtmfInput.length-ce):this._dtmfInput}constructor(t){this.identity=new Ot(t)}_getIdentityId(t){return t?this._getFieldValue(t,"Contact")||this._getFieldValue(t,"Account"):null}_getFieldValue(t,n){return t.findByFn(l=>l.name===n)?.value}selectIdentity(t,n){const a=this._getIdentityId(t);this.identity=a?this.identityOptions?.find(l=>l.id===a):{id:(0,yt.qv)(),name:n,number:n,isDefault:!0}}appendDtmfInput(t){t&&(this._dtmfInput=(this._dtmfInput??"")+t)}}class Ce{constructor(t){Object.assign(this,t)}_getSubscribers(){return[...this.subscribers??[]]}convertToCallConversation(){const t=this.direction.toLowerCase()===Be,n=this._getSubscribers(),a=t?this.callerId:this.calledId,l=new Re(null);return l.callId=this.id,l.startedOn=this.commutationStartedOn,l.lineFeatures=this.callFeaturesSet,l.state=this.state,l.identityOptions=n.map(s=>new Ot(s)),l.selectIdentity(this.identificationData,a),l.databaseUId=this.databaseUId,l.isCallIncoming=t,l.appendDtmfInput(this.dtmfInput),l}}class S{constructor(t){this._ctiActionsService=t,this._destroyed$=new c.Subject,this._activeCalls=[],this._activeCallsSubject=new c.BehaviorSubject([]),this.activeCalls$=this._activeCallsSubject.asObservable(),this._subscribeCtiEvents()}_subscribeCtiEvents(){this._ctiActionsService.getCtiEvents().pipe((0,c.takeUntil)(this._destroyed$)).subscribe(t=>{switch(t[0]){case"callSaved":this._handleCallSaved(t);break;case"lineStateChanged":this._handleLineStateChanged(t);break;case"callFinished":this._handleCallFinished(t);break;case"ctiState":this._handleLoadCtiState(t);break;case"callIdentificationOptions":this._handleCallIdentificationOptions(t);break;case"callIdentificationSaved":this._handleCallIdentification(t);break;case"commutationStarted":this._handleCallCommutationStarted(t);break;case"dtmfEntered":this._handleDtmfEntered(t);break}}),this._ctiActionsService.getCurrentCallUpdates().pipe((0,c.filter)(t=>!!t),(0,c.takeUntil)(this._destroyed$)).subscribe(t=>{this._addCallItem(new Ce(t)),this._updateCallFields(t),this._activeCallsSubject.next(this._activeCalls)}),this._ctiActionsService.getCtiState()}_addCallItem(t){if(!t?.state||this._findConversation(t.id))return;const n=t.convertToCallConversation(),a=t.parentCallId?this._findConversation(t.parentCallId):null;a?a.consultCall=n:this._activeCalls.push(n)}_updateCallFields(t){const n=this._findConversation(t.id);n&&(n.lineFeatures=t.callFeaturesSet,n.state=t.state)}_findConversation(t){const n=this._activeCalls.find(a=>a.callId===t||a.consultCall?.callId===t);return n?n.callId===t?n:n.consultCall:null}_findMainConversation(t){return this._activeCalls.find(n=>n.callId===t||n.consultCall?.callId===t)}_handleCallSaved(t){const n=t[1],a=this._findConversation(n?.id);!a||!n.databaseUId||(a.databaseUId=n.databaseUId,this._activeCallsSubject.next(this._activeCalls))}_handleLineStateChanged(t){const n=t[1],a=n.callId?this._findConversation(n.callId):this._activeCalls[0];!a||!n.callFeaturesSet||(a.lineFeatures=n.callFeaturesSet,this._activeCallsSubject.next(this._activeCalls))}_handleCallFinished(t){const n=t[1],a=n.id?this._findMainConversation(n.id):null;a&&(a.callId===n.id&&a.consultCall?(this._activeCalls.splice(this._activeCalls.indexOf(a),1),this._activeCalls.push(a.consultCall)):a.callId===n.id?this._activeCalls.splice(this._activeCalls.indexOf(a),1):a.consultCall.callId===n.id&&(a.consultCall=null),this._activeCallsSubject.next(this._activeCalls))}_handleLoadCtiState(t){const n=t[1];if(n?.length){for(const a of n)this._addCallItem(new Ce(a));this._activeCallsSubject.next(this._activeCalls)}}_handleCallIdentificationOptions(t){const n=t[1],a=t[2],l=this._findConversation(n);l&&a&&(l.identityOptions=a.map(s=>new Ot(s)),l.identityOptions.length===1&&(l.identity=l.identityOptions[0]),this._activeCallsSubject.next(this._activeCalls))}_handleCallIdentification(t){const n=t[1],a=t[2],l=this._findConversation(n);l&&a&&(l.selectIdentity(a,l.identity?.number),this._activeCallsSubject.next(this._activeCalls))}_handleCallCommutationStarted(t){const n=t[1];if(!n)return;const a=this._findConversation(n.id);a&&(a.startedOn=n.commutationStartedOn,this._activeCallsSubject.next(this._activeCalls))}_handleDtmfEntered(t){const n=t[1],a=this._activeCalls.length>0?this._activeCalls[0]:null;a&&a.appendDtmfInput(n)}ngOnDestroy(){this._destroyed$.next(),this._destroyed$.complete()}static{this.\u0275fac=function(n){return new(n||S)(e.\u0275\u0275inject(U))}}static{this.\u0275prov=e.\u0275\u0275defineInjectable({token:S,factory:S.\u0275fac,providedIn:"root"})}}var He=o(21928),je=o(26594);class I{constructor(t){this._wrapUpStates=new Map,this._activeConversations=new Map,this._prevSnapshots=new Map,this._wrapUpStartedSubject=new c.BehaviorSubject(null),this._wrapUpTickSubject=new c.BehaviorSubject(null),this._wrapUpEndedSubject=new c.BehaviorSubject(null),this._period=0,this.wrapUpStarted$=this._wrapUpStartedSubject.asObservable(),this.wrapUpTick$=this._wrapUpTickSubject.asObservable(),this.wrapUpEnded$=this._wrapUpEndedSubject.asObservable(),this._featureValues=t.get(je.G,{optional:!0}),this._ctiStateService=t.get(S),this._sysSettingsService=t.get(He.A),this._subscribeActiveCalls(),this._loadWrapUpPeriod()}_loadWrapUpPeriod(){this._sysSettingsService.getByCode("CallWrapUpPeriod").then(t=>{this._period=t?.value||0})}_emitWrapUpStarted(t){this.isWrapUpEnabled&&this._wrapUpStartedSubject.next(t)}_emitWrapUpTick(t){this.isWrapUpEnabled&&this._wrapUpTickSubject.next(t)}_emitWrapUpEnded(t){this.isWrapUpEnabled&&this._wrapUpEndedSubject.next(t)}_subscribeActiveCalls(){this._activeCallsSub=this._ctiStateService.activeCalls$.subscribe(t=>{const n=this._mapSnapshots(t);this._wrapUpFinishedMainCalls(n),this._updateActiveConversationMap(t),this._updatePrevSnapshotMap(n)})}_mapSnapshots(t){return t.map(n=>({callId:n.callId,consultId:n.consultCall?.callId}))}_wrapUpFinishedMainCalls(t){const n=new Map(this._activeConversations);for(const[a,l]of this._prevSnapshots.entries()){if(t.some(p=>p.callId===a))continue;const d=!!l;if(!(d&&t.find(p=>p.callId===l))&&!d){const p=n.get(a);this._startWrapUp(a,p)}}}_updateActiveConversationMap(t){this._activeConversations.clear();for(const n of t)n.callId&&this._activeConversations.set(n.callId,n),n.consultCall?.callId&&this._activeConversations.set(n.consultCall.callId,n.consultCall)}_updatePrevSnapshotMap(t){this._prevSnapshots.clear();for(const n of t)this._prevSnapshots.set(n.callId,n.consultId)}_findConversation(t){return this._activeConversations.get(t)||null}_cloneConversation(t){return t?{databaseUId:t.databaseUId,callId:t.callId,lineFeatures:t.lineFeatures,state:t.state,isCallIncoming:t.isCallIncoming,dtmfInput:t.dtmfInput,identity:t.identity?{...t.identity}:null,identityOptions:t.identityOptions?t.identityOptions.map(n=>({...n})):void 0,consultCall:t.consultCall?this._cloneConversation(t.consultCall):void 0,selectIdentity:t.selectIdentity?.bind(t),appendDtmfInput:t.appendDtmfInput?.bind(t),isWrapUp:!0}:null}_startWrapUp(t,n){if(!this.isWrapUpEnabled||this._wrapUpStates.has(t))return;const a=this._period,l=new Date,s=n||this._findConversation(t),d=this._cloneConversation(s),h={callId:t,startedOn:l,periodSec:a,conversation:d,remainingSec:a,typing:!1};this._wrapUpStates.set(t,h),this._emitWrapUpStarted({callId:t,startedOn:l,periodSec:a,conversation:d}),a>0&&this._scheduleTimers(h)}_scheduleTimers(t){this.isWrapUpEnabled&&(t.timerId=window.setInterval(()=>{t.typing||(t.remainingSec-=1,!(t.remainingSec<0)&&this._emitWrapUpTick({callId:t.callId,remainingSec:t.remainingSec,conversation:t.conversation}))},1e3),t.endTimerId=window.setTimeout(()=>{t.typing||this._endWrapUp(t.callId,"auto")},t.periodSec*1e3))}_endWrapUp(t,n){const a=this._wrapUpStates.get(t);if(!a)return;a.timerId&&clearInterval(a.timerId),a.endTimerId&&clearTimeout(a.endTimerId);const l=Math.max(0,Math.round((Date.now()-a.startedOn.getTime())/1e3));this._wrapUpStates.delete(t),this._emitWrapUpEnded({callId:t,reason:n,durationSec:l,comment:a.comment,resultId:a.resultId,conversation:a.conversation})}typing(t){if(!this.isWrapUpEnabled)return;const n=this._wrapUpStates.get(t);!n||n.typing||(n.typing=!0,n.timerId&&(clearInterval(n.timerId),n.timerId=void 0),n.endTimerId&&(clearTimeout(n.endTimerId),n.endTimerId=void 0))}complete(t){this.isWrapUpEnabled&&this._endWrapUp(t,"complete")}save(t,n,a){if(!this.isWrapUpEnabled)return;const l=this._wrapUpStates.get(t);l&&(l.comment=n,l.resultId=a),this._endWrapUp(t,"save")}close(t){this.isWrapUpEnabled&&this._endWrapUp(t,"close")}isCallWrappedUp(t){return this._wrapUpStates.has(t)}getConversation(t){return this._wrapUpStates.get(t)?.conversation||null}ngOnDestroy(){for(const t of this._wrapUpStates.values())t.timerId&&clearInterval(t.timerId),t.endTimerId&&clearTimeout(t.endTimerId);this._wrapUpStates.clear(),this._activeCallsSub&&this._activeCallsSub.unsubscribe(),this._wrapUpStartedSubject.complete(),this._wrapUpTickSubject.complete(),this._wrapUpEndedSubject.complete()}get isWrapUpEnabled(){return!this._featureValues?.CallWrapUpDisabled}static{this.\u0275fac=function(n){return new(n||I)(e.\u0275\u0275inject(e.Injector))}}static{this.\u0275prov=e.\u0275\u0275defineInjectable({token:I,factory:I.\u0275fac,providedIn:"root"})}}class B{constructor(t,n){this._ctiState=t,this._wrapUp=n,this._selectedCallId=new c.BehaviorSubject(null),this.selectedCallId=this._selectedCallId.asObservable(),this.selectedCall$=this._createDisplayedCallObservable(),this._subscribeWrapUpEnded()}_createDisplayedCallObservable(){return(0,c.combineLatest)([this._ctiState.activeCalls$.pipe((0,St.debounceTime)(10)),this.selectedCallId]).pipe((0,St.map)(([t,n])=>{if(n){if(this._wrapUp.isWrapUpEnabled&&this._wrapUp.isCallWrappedUp(n))return this._wrapUp.getConversation(n);const a=t.find(l=>l.callId===n);if(a)return a}return t.length>0?t[0]:null}),(0,St.shareReplay)({bufferSize:1,refCount:!0}))}_subscribeWrapUpEnded(){this._wrapUp.wrapUpEnded$.subscribe(t=>{this._selectedCallId.value===t.callId&&this.clearSelection()})}clearSelection(){this._selectedCallId.next(null)}selectCall(t){t&&this._selectedCallId.next(t)}static{this.\u0275fac=function(n){return new(n||B)(e.\u0275\u0275inject(S),e.\u0275\u0275inject(I))}}static{this.\u0275prov=e.\u0275\u0275defineInjectable({token:B,factory:B.\u0275fac,providedIn:"root"})}}var pe=o(58433);const Fe=["dtmfButton"],$e=["*"],me=i=>({highlight:i}),Y=()=>["color-call-btn"];function We(i,t){i&1&&e.\u0275\u0275element(0,"crt-skeleton-loader")}function Ze(i,t){if(i&1&&(e.\u0275\u0275element(0,"crt-button",32),e.\u0275\u0275pipe(1,"translate"),e.\u0275\u0275pipe(2,"translate")),i&2){const n=e.\u0275\u0275nextContext(3);e.\u0275\u0275propertyInterpolate("title",e.\u0275\u0275pipeBind1(1,4,"CallConversation.CallIdentityOptions")),e.\u0275\u0275propertyInterpolate("ariaLabel",e.\u0275\u0275pipeBind1(2,6,"CallConversation.CallIdentityOptions")),e.\u0275\u0275property("menuItems",n.currentCallMenuItems),e.\u0275\u0275attribute("data-item-marker","current-call-identity")}}function ze(i,t){i&1&&e.\u0275\u0275element(0,"mat-icon",33)}function Ke(i,t){if(i&1&&(e.\u0275\u0275elementStart(0,"div",34)(1,"div",35),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",36),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd()()),i&2){const n=t.$implicit;e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,3,n.caption)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(5,me,n.isHighlighted)),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",n.value," ")}}function Qe(i,t){if(i&1&&(e.\u0275\u0275elementStart(0,"div",37)(1,"div",35),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",38),e.\u0275\u0275element(5,"crt-timer",39),e.\u0275\u0275elementEnd()()),i&2){const n=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,4,"CallConversation.Duration")),e.\u0275\u0275advance(3),e.\u0275\u0275property("timerType","stopwatch")("control",n.currentCallConversation.startedOn)("adjustToUserTimezone",!0)}}function Ye(i,t){if(i&1&&(e.\u0275\u0275element(0,"crt-button",42),e.\u0275\u0275pipe(1,"translate"),e.\u0275\u0275pipe(2,"translate")),i&2){const n=e.\u0275\u0275nextContext(4);e.\u0275\u0275propertyInterpolate("title",e.\u0275\u0275pipeBind1(1,4,"CallConversation.ConsultCallIdentityOptions")),e.\u0275\u0275propertyInterpolate("ariaLabel",e.\u0275\u0275pipeBind1(2,6,"CallConversation.ConsultCallIdentityOptions")),e.\u0275\u0275property("menuItems",n.consultCallMenuItems),e.\u0275\u0275attribute("data-item-marker","consult-call-identity")}}function Je(i,t){if(i&1&&(e.\u0275\u0275elementStart(0,"div",40),e.\u0275\u0275element(1,"crt-image-input",8),e.\u0275\u0275elementStart(2,"div",9),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,Ye,3,8,"crt-button",41),e.\u0275\u0275elementEnd()),i&2){const n=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(),e.\u0275\u0275property("value",n.currentCallConversation.consultCall.identity==null?null:n.currentCallConversation.consultCall.identity.photo)("placeholder",n.getPhotoPlaceholder(n.currentCallConversation.consultCall.identity))("crtTooltip",n.currentCallConversation.consultCall.identity==null?null:n.currentCallConversation.consultCall.identity.name),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",n.currentCallConversation.consultCall.identity==null?null:n.currentCallConversation.consultCall.identity.name," "),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",n.consultCallMenuItems&&n.consultCallMenuItems.length>0)}}function Xe(i,t){if(i&1&&(e.\u0275\u0275elementStart(0,"div",34)(1,"div",35),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",36),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd()()),i&2){const n=t.$implicit;e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,3,n.caption)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(5,me,n.isHighlighted)),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",n.value," ")}}function Ge(i,t){if(i&1&&(e.\u0275\u0275elementStart(0,"div",37)(1,"div",35),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",38),e.\u0275\u0275element(5,"crt-timer",39),e.\u0275\u0275elementEnd()()),i&2){const n=e.\u0275\u0275nextContext(4);e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,4,"CallConversation.Duration")),e.\u0275\u0275advance(3),e.\u0275\u0275property("timerType","stopwatch")("control",n.currentCallConversation.consultCall.startedOn)("adjustToUserTimezone",!0)}}function qe(i,t){if(i&1&&(e.\u0275\u0275elementStart(0,"div",43),e.\u0275\u0275template(1,Xe,6,7,"div",14)(2,Ge,6,6,"div",15),e.\u0275\u0275elementEnd()),i&2){const n=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(),e.\u0275\u0275property("ngForOf",n.currentCallConversation==null||n.currentCallConversation.consultCall.identity==null?null:n.currentCallConversation.consultCall.identity.fields),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",n.currentCallConversation.consultCall.startedOn)}}function tn(i,t){if(i&1){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"crt-button",44),e.\u0275\u0275pipe(1,"translate"),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(n);const l=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(l.onButtonClick("answer"))}),e.\u0275\u0275elementEnd()}i&2&&(e.\u0275\u0275propertyInterpolate("title",e.\u0275\u0275pipeBind1(1,4,"CallConversation.Buttons.Accept")),e.\u0275\u0275propertyInterpolate("ariaLabel",e.\u0275\u0275pipeBind1(2,6,"CallConversation.Buttons.Accept")),e.\u0275\u0275property("classes",e.\u0275\u0275pureFunction0(8,Y)),e.\u0275\u0275attribute("data-item-marker","answer-call"))}function en(i,t){if(i&1){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"crt-button",45),e.\u0275\u0275pipe(1,"translate"),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(n);const l=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(l.onButtonClick("complete-transfer"))}),e.\u0275\u0275elementEnd()}i&2&&(e.\u0275\u0275propertyInterpolate("title",e.\u0275\u0275pipeBind1(1,4,"CallConversation.Buttons.CompleteTransfer")),e.\u0275\u0275propertyInterpolate("ariaLabel",e.\u0275\u0275pipeBind1(2,6,"CallConversation.Buttons.CompleteTransfer")),e.\u0275\u0275property("classes",e.\u0275\u0275pureFunction0(8,Y)),e.\u0275\u0275attribute("data-item-marker","complete-transfer-call"))}function nn(i,t){if(i&1){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"crt-button",46),e.\u0275\u0275pipe(1,"translate"),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(n);const l=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(l.onButtonClick("toggleHold"))}),e.\u0275\u0275elementEnd()}if(i&2){const n=e.\u0275\u0275nextContext(3);e.\u0275\u0275classProp("pressed",n.hold),e.\u0275\u0275propertyInterpolate("title",e.\u0275\u0275pipeBind1(1,6,n.getIsCallOnHold()?"CallConversation.Buttons.Unhold":"CallConversation.Buttons.Hold")),e.\u0275\u0275propertyInterpolate("ariaLabel",e.\u0275\u0275pipeBind1(2,8,n.getIsCallOnHold()?"CallConversation.Buttons.Unhold":"CallConversation.Buttons.Hold")),e.\u0275\u0275property("icon",n.getIsCallOnHold()?"unhold-call":"hold-call"),e.\u0275\u0275attribute("data-item-marker",n.getIsCallOnHold()?"unhold-call":"hold-call")}}function an(i,t){if(i&1){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"crt-button",47),e.\u0275\u0275pipe(1,"translate"),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(n);const l=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(l.onButtonClick("start-transfer"))}),e.\u0275\u0275elementEnd()}i&2&&(e.\u0275\u0275propertyInterpolate("title",e.\u0275\u0275pipeBind1(1,3,"CallConversation.Buttons.StartTransfer")),e.\u0275\u0275propertyInterpolate("ariaLabel",e.\u0275\u0275pipeBind1(2,5,"CallConversation.Buttons.StartTransfer")),e.\u0275\u0275attribute("data-item-marker","transfer-call"))}function ln(i,t){if(i&1){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"crt-button",48,1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(n);const l=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(l.onButtonClick("dtmf-call"))}),e.\u0275\u0275elementEnd()}i&2&&(e.\u0275\u0275propertyInterpolate("title",e.\u0275\u0275pipeBind1(2,3,"CallConversation.Buttons.OpenDialPanel")),e.\u0275\u0275propertyInterpolate("ariaLabel",e.\u0275\u0275pipeBind1(3,5,"CallConversation.Buttons.OpenDialPanel")),e.\u0275\u0275attribute("data-item-marker","dtmf-call"))}function on(i,t){if(i&1){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"crt-button",49),e.\u0275\u0275pipe(1,"translate"),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(n);const l=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(l.onButtonClick("toggle-mute"))}),e.\u0275\u0275elementEnd()}i&2&&(e.\u0275\u0275propertyInterpolate("title",e.\u0275\u0275pipeBind1(1,2,"CallConversation.Buttons.Mute")),e.\u0275\u0275propertyInterpolate("ariaLabel",e.\u0275\u0275pipeBind1(2,4,"CallConversation.Buttons.Mute")))}function rn(i,t){if(i&1){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"crt-button",50),e.\u0275\u0275pipe(1,"translate"),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(n);const l=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(l.onButtonClick("cancel-transfer"))}),e.\u0275\u0275elementEnd()}i&2&&(e.\u0275\u0275propertyInterpolate("title",e.\u0275\u0275pipeBind1(1,4,"CallConversation.Buttons.CancelTransfer")),e.\u0275\u0275propertyInterpolate("ariaLabel",e.\u0275\u0275pipeBind1(2,6,"CallConversation.Buttons.CancelTransfer")),e.\u0275\u0275property("classes",e.\u0275\u0275pureFunction0(8,Y)),e.\u0275\u0275attribute("data-item-marker","cancel-transfer-call"))}function sn(i,t){if(i&1){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"crt-button",51),e.\u0275\u0275pipe(1,"translate"),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(n);const l=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(l.onButtonClick("decline"))}),e.\u0275\u0275elementEnd()}i&2&&(e.\u0275\u0275propertyInterpolate("title",e.\u0275\u0275pipeBind1(1,4,"CallConversation.Buttons.Drop")),e.\u0275\u0275propertyInterpolate("ariaLabel",e.\u0275\u0275pipeBind1(2,6,"CallConversation.Buttons.Drop")),e.\u0275\u0275property("classes",e.\u0275\u0275pureFunction0(8,Y)),e.\u0275\u0275attribute("data-item-marker","decline-call"))}function cn(i,t){if(i&1&&(e.\u0275\u0275elementStart(0,"div",56)(1,"span",57),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd()()),i&2){const n=e.\u0275\u0275nextContext(4);e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(n.currentCallConversation.dtmfInput)}}function dn(i,t){if(i&1){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"crt-button",58),e.\u0275\u0275listener("clicked",function(){const l=e.\u0275\u0275restoreView(n).$implicit,s=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(s.onDtmfClick(l))}),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()}if(i&2){const n=t.$implicit;e.\u0275\u0275attribute("data-item-marker","dtmf-"+n),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",n," ")}}function Cn(i,t){if(i&1&&(e.\u0275\u0275elementStart(0,"div",52),e.\u0275\u0275template(1,cn,3,1,"div",53),e.\u0275\u0275elementStart(2,"div",54),e.\u0275\u0275template(3,dn,2,2,"crt-button",55),e.\u0275\u0275elementEnd()()),i&2){const n=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",n.currentCallConversation.dtmfInput),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",n.dtmfChars)}}function pn(i,t){if(i&1){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",59)(1,"div",60),e.\u0275\u0275element(2,"mat-icon",61),e.\u0275\u0275elementStart(3,"div",62)(4,"input",63,2),e.\u0275\u0275pipe(6,"translate"),e.\u0275\u0275pipe(7,"translate"),e.\u0275\u0275listener("keyup",function(l){e.\u0275\u0275restoreView(n);const s=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(s.search(l.target.value))})("keyup.enter",function(l){e.\u0275\u0275restoreView(n);const s=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(s.onButtonClick("make-consult-call",l.target.value))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"mat-icon",64),e.\u0275\u0275pipe(9,"translate"),e.\u0275\u0275pipe(10,"translate"),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);const l=e.\u0275\u0275reference(5),s=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(s.onButtonClick("make-consult-call",l.value))}),e.\u0275\u0275elementEnd()()()()}i&2&&(e.\u0275\u0275advance(4),e.\u0275\u0275property("aria-placeholder",e.\u0275\u0275pipeBind1(6,4,"CallConversation.Search"))("placeholder",e.\u0275\u0275pipeBind1(7,6,"CallConversation.Search")),e.\u0275\u0275advance(4),e.\u0275\u0275propertyInterpolate("title",e.\u0275\u0275pipeBind1(9,8,"CallConversation.Call")),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(10,10,"CallConversation.Call")))}function mn(i,t){if(i&1){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-list-item",71)(1,"div",72),e.\u0275\u0275listener("click",function(){const l=e.\u0275\u0275restoreView(n).$implicit,s=e.\u0275\u0275nextContext(5);return e.\u0275\u0275resetView(s.onButtonClick("make-consult-call",l.number))}),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"mat-icon",73),e.\u0275\u0275listener("click",function(){const l=e.\u0275\u0275restoreView(n).$implicit,s=e.\u0275\u0275nextContext(5);return e.\u0275\u0275resetView(s.onButtonClick("make-consult-call",l.number))}),e.\u0275\u0275elementEnd()()}if(i&2){const n=t.$implicit;e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate2(" ",n.communicationType," ",n.number," ")}}function un(i,t){if(i&1&&(e.\u0275\u0275elementStart(0,"mat-list-item",67)(1,"div",68),e.\u0275\u0275element(2,"crt-image-input",8),e.\u0275\u0275elementStart(3,"div",69),e.\u0275\u0275text(4),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(5,"mat-list"),e.\u0275\u0275template(6,mn,4,2,"mat-list-item",70),e.\u0275\u0275elementEnd()()),i&2){const n=t.$implicit;e.\u0275\u0275advance(2),e.\u0275\u0275property("value",n.contactPhoto)("placeholder",n.contactName)("crtTooltip",n.contactName),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(n.contactName),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",n.phoneNumbers)}}function hn(i,t){if(i&1&&(e.\u0275\u0275elementStart(0,"mat-list",65),e.\u0275\u0275template(1,un,7,5,"mat-list-item",66),e.\u0275\u0275elementEnd()),i&2){const n=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(),e.\u0275\u0275property("ngForOf",n.transferContacts)}}function gn(i,t){if(i&1){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",5)(2,"div",6)(3,"div",7),e.\u0275\u0275element(4,"crt-image-input",8),e.\u0275\u0275elementStart(5,"div",9),e.\u0275\u0275text(6),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(7,Ze,3,8,"crt-button",10),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"div",11),e.\u0275\u0275template(9,ze,1,0,"mat-icon",12),e.\u0275\u0275elementStart(10,"div",13),e.\u0275\u0275template(11,Ke,6,7,"div",14)(12,Qe,6,6,"div",15),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(13,Je,5,5,"div",16)(14,qe,3,2,"div",17),e.\u0275\u0275elementStart(15,"div",18),e.\u0275\u0275template(16,tn,3,9,"crt-button",19)(17,en,3,9,"crt-button",20)(18,nn,3,10,"crt-button",21)(19,an,3,7,"crt-button",22)(20,ln,4,7,"crt-button",23)(21,on,3,6,"crt-button",24)(22,rn,3,9,"crt-button",25)(23,sn,3,9,"crt-button",26),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(24,Cn,4,2,"ng-template",27),e.\u0275\u0275listener("backdropClick",function(){e.\u0275\u0275restoreView(n);const l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.showDialPanel=!1)})("overlayKeydown",function(l){e.\u0275\u0275restoreView(n);const s=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(s.onDialPanelOverlayKeyDown(l))}),e.\u0275\u0275template(25,pn,11,12,"div",28)(26,hn,2,1,"mat-list",29),e.\u0275\u0275elementEnd()(),e.\u0275\u0275element(27,"div",30),e.\u0275\u0275elementStart(28,"div",31),e.\u0275\u0275projection(29),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(i&2){const n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(4),e.\u0275\u0275property("value",n.currentCallConversation.identity==null?null:n.currentCallConversation.identity.photo)("placeholder",n.getPhotoPlaceholder(n.currentCallConversation.identity))("crtTooltip",n.currentCallConversation.identity==null?null:n.currentCallConversation.identity.name),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(n.currentCallConversation.identity==null?null:n.currentCallConversation.identity.name),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",n.currentCallMenuItems&&n.currentCallMenuItems.length>0),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",n.currentCallConversation==null?null:n.currentCallConversation.consultCall),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",n.currentCallConversation.identity==null?null:n.currentCallConversation.identity.fields),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",n.currentCallConversation.startedOn),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",n.currentCallConversation==null?null:n.currentCallConversation.consultCall),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",n.currentCallConversation==null?null:n.currentCallConversation.consultCall),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",n.isLineFeatureVisible(n.lineFeatures.CAN_ANSWER)),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",n.isLineFeatureVisible(n.lineFeatures.CAN_COMPLETE_TRANSFER)),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",n.getCanHoldOrUnhold()),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",n.getCanStartTransfer()),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",n.isLineFeatureVisible(n.lineFeatures.CAN_DTMF)),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",n.isLineFeatureVisible(n.lineFeatures.CAN_MUTE)),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",n.getCanCancelTransfer()),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",n.isLineFeatureVisible(n.lineFeatures.CAN_DROP)),e.\u0275\u0275advance(),e.\u0275\u0275property("cdkConnectedOverlayOrigin",n.dtmfButtonElement)("cdkConnectedOverlayOpen",n.showDialPanel)("cdkConnectedOverlayPositions",n.dtmfOverlayPositions),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",n.transfer),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",n.transfer)}}function _n(i,t){if(i&1&&e.\u0275\u0275template(0,gn,30,23,"ng-container",4),i&2){const n=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngIf",n.currentCallConversation)}}let _=class jt extends K.K{get currentCall(){return this.currentCallConversation?.databaseUId?{value:this.currentCallConversation.databaseUId,displayValue:this.currentCallConversation.identity?.number,state:this.currentCallConversation.state,isWrapUp:this.currentCallConversation.isWrapUp,callId:this.currentCallConversation.callId}:null}set currentCall(t){}get currentCallContact(){return this._getIdentityValue("Contact")||this._getIdentityValue("Employee")}set currentCallContact(t){}get currentCallAccount(){return this._getIdentityValue("Account")}set currentCallAccount(t){}constructor(t){super(t),this._debounceUpdateIdentityMenus=(0,u.debounce)(()=>this._updateIdentityMenus(),500),this.useBlindTransfer=!1,this.transfer=!1,this.lineFeatures=T,this.transferContacts=[],this.showDialPanel=!1,this.dtmfChars=[g.One,g.Two,g.Three,g.Four,g.Five,g.Six,g.Seven,g.Eight,g.Nine,g.Asterisk,g.Zero,g.Hashtag],this.dtmfOverlayPositions=[{originX:"center",originY:"bottom",overlayX:"center",overlayY:"top",offsetY:4},{originX:"center",originY:"top",overlayX:"center",overlayY:"bottom",offsetY:-4}],this.search=(0,u.debounce)(n=>{if(n.length<3||/^\d+$/.test(n)){this.transferContacts=null;return}this._contactSearchService.search(n).then(a=>{this.transferContacts=this._mapToSearchedContacts(a),this.changeDetectorRef.detectChanges()})},500),this.currentCallChange=new e.EventEmitter,this.currentCallContactChange=new e.EventEmitter,this.currentCallAccountChange=new e.EventEmitter,this.callConversationChange=new e.EventEmitter,this._ctiActionsService=t.get(U),this._contactSearchService=t.get(L),this._callSelectionService=t.get(B)}_getIdentityValue(t){return this.currentCall&&this.currentCallConversation.identity&&this.currentCallConversation.identity.entityName===t?{value:this.currentCallConversation.identity.id,displayValue:this.currentCallConversation.identity.name,primaryImageValue:this.currentCallConversation.identity.photo}:null}_changeCallIdentity(t,n){this._ctiActionsService.updateCallIdentity(t,n)}_emitCallChanges(){this.currentCallChange.emit(this.currentCall),this.currentCallContactChange.emit(this.currentCallContact),this.currentCallAccountChange.emit(this.currentCallAccount),this.callConversationChange.emit(this.currentCallConversation)}_updateIdentityMenus(){this.currentCallMenuItems=this._mapIdentityMenu(this.currentCallConversation),this.consultCallMenuItems=this._mapIdentityMenu(this.currentCallConversation?.consultCall),this.changeDetectorRef.detectChanges()}_mapIdentityMenu(t){if(!t?.identityOptions)return null;const n=t.identityOptions.filter(a=>a.id!==t.identity?.id).map(a=>({type:"crt.MenuItem",caption:a.name,name:a.name,handleItemClick:()=>this._changeCallIdentity(t.callId,a.id)}));return!t?.identity||t.identity.isDefault||(n.length>0&&n.push({type:"crt.MenuDivider"}),n.push({type:"crt.MenuItem",name:"ClearIdentity",caption:"CallConversation.ClearIdentity",handleItemClick:()=>this._changeCallIdentity(t.callId,null)})),n}_mapToSearchedContacts(t){const n=t.reduce((a,l)=>(a[l.id]||(a[l.id]={contactName:l.contactName,contactPhoto:l.contactPhoto,phoneNumbers:[]}),(l.number||l.communicationType)&&a[l.id].phoneNumbers?.push({number:l.number,communicationType:l.communicationType}),a),{});return Object.values(n)}_clearTransfer(){this.transfer=!1,this.transferContacts=null}_resetDialPanel(){this.showDialPanel=this.showDialPanel&&this.isLineFeatureVisible(T.CAN_DTMF)}_subscribeToCallStateChanges(){this._callSelectionService.selectedCall$.pipe((0,c.takeUntil)(this.destroyed$)).subscribe(t=>{this.currentCallConversation=t,this._refreshAfterCallStateChange()})}_refreshAfterCallStateChange(){this._debounceUpdateIdentityMenus(),this._emitCallChanges(),this._resetDialPanel(),this.changeDetectorRef.detectChanges()}ngOnInit(){this._subscribeToCallStateChanges()}onButtonClick(t,n){switch(t){case"dtmf-call":this.showDialPanel=!0,this._clearTransfer();break;case"answer":this._ctiActionsService.answerCall();break;case"decline":this._ctiActionsService.declineCall(),this._clearTransfer();break;case"toggleHold":this._ctiActionsService.toggleHoldCall();break;case"toggle-mute":this._ctiActionsService.toggleMuteCall();break;case"start-transfer":this.transfer=!this.transfer,this._ctiActionsService.startTransfer();break;case"make-consult-call":this.useBlindTransfer?this._ctiActionsService.blindTransfer(n):this._ctiActionsService.makeConsultCall(n),this._clearTransfer();break;case"complete-transfer":this._ctiActionsService.endTransfer();break;case"cancel-transfer":this._ctiActionsService.cancelTransfer(),this._clearTransfer();break;default:break}}onDtmfClick(t){t&&this._ctiActionsService.sendDtmf(t)}getIsCallOnHold(){return this.currentCallConversation?.state===w.HOLDED}getCanStartTransfer(){return this.getCanMakeConsultCall()}getCanCancelTransfer(){return this.isLineFeatureVisible(T.CAN_COMPLETE_TRANSFER)||this.currentCallConversation?.consultCall!=null}getCanHoldOrUnhold(){return this.isLineFeatureVisible(T.CAN_HOLD)||this.isLineFeatureVisible(T.CAN_UNHOLD)}getCanMakeConsultCall(){return this.isLineFeatureVisible(T.CAN_MAKE_CONSULT_CALL)}isLineFeatureVisible(t){return!!(this.currentCallConversation?.lineFeatures&t)}getPhotoPlaceholder(t){return!t||t.name===t.number?"?":t.name}onDialPanelOverlayKeyDown(t){t.code===Ve.Key.Escape&&(this.showDialPanel=!1)}static{this.\u0275fac=function(n){return new(n||jt)(e.\u0275\u0275directiveInject(e.Injector))}}static{this.\u0275cmp=e.\u0275\u0275defineComponent({type:jt,selectors:[["crt-call-conversation"]],viewQuery:function(n,a){if(n&1&&e.\u0275\u0275viewQuery(Fe,5,e.ElementRef),n&2){let l;e.\u0275\u0275queryRefresh(l=e.\u0275\u0275loadQuery())&&(a.dtmfButtonElement=l.first)}},inputs:{currentCall:"currentCall",currentCallContact:"currentCallContact",currentCallAccount:"currentCallAccount"},outputs:{currentCallChange:"currentCallChange",currentCallContactChange:"currentCallContactChange",currentCallAccountChange:"currentCallAccountChange",callConversationChange:"callConversationChange"},features:[e.\u0275\u0275InheritDefinitionFeature],ngContentSelectors:$e,decls:3,vars:2,consts:[["call_conversation_template",""],["dtmfButton",""],["searchInput",""],[4,"ngIf","ngIfElse"],[4,"ngIf"],[1,"call-tile-wrapper"],[1,"call-tile"],[1,"main-call","contact-info"],["readonly","true","placeholderMode","abbreviation","borderRadius","large","positioning","cover","size","small","customBorderWidth","1px",1,"user-photo",3,"value","placeholder","crtTooltip"],[1,"contact-name"],["icon","call-icon","displayMenuIcon","true","displayType","text","iconPosition","only-icon",3,"menuItems","title","ariaLabel",4,"ngIf"],[1,"contact-info"],["class","call-transferred","svgIcon","call-transferred-to",4,"ngIf"],[1,"main-call","fields-table"],["class","field-row",4,"ngFor","ngForOf"],["class","field-row duration-field-row",4,"ngIf"],["class","consult-call contact-info",4,"ngIf"],["class","consult-call fields-table",4,"ngIf"],[1,"buttons-row"],["icon","answer-call","class","call-btn","iconPosition","only-icon","size","large","color","accent",3,"classes","title","ariaLabel","clicked",4,"ngIf"],["icon","complete-transfer-call","class","call-btn","contentAlign","center","iconPosition","only-icon","size","large","color","accent",3,"classes","title","ariaLabel","clicked",4,"ngIf"],["class","call-btn colored-grey","iconPosition","only-icon","size","large",3,"pressed","icon","title","ariaLabel","clicked",4,"ngIf"],["icon","transfer-call","class","call-btn colored-grey","contentAlign","center","iconPosition","only-icon","size","large",3,"title","ariaLabel","clicked",4,"ngIf"],["icon","dtmf-call","class","call-btn colored-grey","contentAlign","center","iconPosition","only-icon","size","large",3,"title","ariaLabel","clicked",4,"ngIf"],["icon","mute-call","data-item-marker","mute-call","class","call-btn colored-grey","contentAlign","center","size","large","iconPosition","only-icon",3,"title","ariaLabel","clicked",4,"ngIf"],["icon","cancel-transfer-call","class","call-btn","contentAlign","center","iconPosition","only-icon","size","large","color","warn",3,"classes","title","ariaLabel","clicked",4,"ngIf"],["icon","decline-call","class","call-btn decline-call","contentAlign","center","iconPosition","only-icon","size","large","color","warn",3,"classes","title","ariaLabel","clicked",4,"ngIf"],["cdkConnectedOverlay","","cdkConnectedOverlayHasBackdrop","","cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop","cdkConnectedOverlayPanelClass","dtmf-overlay-panel",3,"backdropClick","overlayKeydown","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen","cdkConnectedOverlayPositions"],["class","crt-search-container",4,"ngIf"],["class","search-results",4,"ngIf"],[1,"divider"],[1,"controls-slot"],["icon","call-icon","displayMenuIcon","true","displayType","text","iconPosition","only-icon",3,"menuItems","title","ariaLabel"],["svgIcon","call-transferred-to",1,"call-transferred"],[1,"field-row"],[1,"field-label"],[1,"field-value",3,"ngClass"],[1,"field-row","duration-field-row"],[1,"field-value"],[1,"highlight",3,"timerType","control","adjustToUserTimezone"],[1,"consult-call","contact-info"],["icon","call-icon","iconPosition","only-icon","displayMenuIcon","true","displayType","text",3,"menuItems","title","ariaLabel",4,"ngIf"],["icon","call-icon","iconPosition","only-icon","displayMenuIcon","true","displayType","text",3,"menuItems","title","ariaLabel"],[1,"consult-call","fields-table"],["icon","answer-call","iconPosition","only-icon","size","large","color","accent",1,"call-btn",3,"clicked","classes","title","ariaLabel"],["icon","complete-transfer-call","contentAlign","center","iconPosition","only-icon","size","large","color","accent",1,"call-btn",3,"clicked","classes","title","ariaLabel"],["iconPosition","only-icon","size","large",1,"call-btn","colored-grey",3,"clicked","icon","title","ariaLabel"],["icon","transfer-call","contentAlign","center","iconPosition","only-icon","size","large",1,"call-btn","colored-grey",3,"clicked","title","ariaLabel"],["icon","dtmf-call","contentAlign","center","iconPosition","only-icon","size","large",1,"call-btn","colored-grey",3,"clicked","title","ariaLabel"],["icon","mute-call","data-item-marker","mute-call","contentAlign","center","size","large","iconPosition","only-icon",1,"call-btn","colored-grey",3,"clicked","title","ariaLabel"],["icon","cancel-transfer-call","contentAlign","center","iconPosition","only-icon","size","large","color","warn",1,"call-btn",3,"clicked","classes","title","ariaLabel"],["icon","decline-call","contentAlign","center","iconPosition","only-icon","size","large","color","warn",1,"call-btn","decline-call",3,"clicked","classes","title","ariaLabel"],[1,"dtmf-panel"],["class","dtmf-input-row",4,"ngIf"],[1,"dtmf-buttons"],["class","dtmf-button colored-grey",3,"clicked",4,"ngFor","ngForOf"],[1,"dtmf-input-row"],[1,"dtmf-input"],[1,"dtmf-button","colored-grey",3,"clicked"],[1,"crt-search-container"],[1,"crt-search-input-container"],["svgIcon","search",1,"crt-search-icon"],[1,"crt-search-minify-container"],["matInput","","crtTextOverflowTitle","","type","text","spellcheck","false","autocomplete","off","labelPosition","hidden",3,"keyup","keyup.enter","aria-placeholder","placeholder"],["svgIcon","call-icon","role","button","aria-hidden","false",3,"click","title"],[1,"search-results"],["tabindex","0",4,"ngFor","ngForOf"],["tabindex","0"],[2,"display","flex","align-items","center"],["matListItemTitle","",2,"margin-left","8px"],["tabindex","0","class","number",4,"ngFor","ngForOf"],["tabindex","0",1,"number"],["matListItemLine","",3,"click"],["matListItemIcon","","svgIcon","call-icon",3,"click"]],template:function(n,a){if(n&1&&(e.\u0275\u0275projectionDef(),e.\u0275\u0275template(0,We,1,0,"crt-skeleton-loader",3)(1,_n,1,1,"ng-template",null,0,e.\u0275\u0275templateRefExtractor)),n&2){const l=e.\u0275\u0275reference(2);e.\u0275\u0275property("ngIf",a.loading)("ngIfElse",l)}},dependencies:[f.NgClass,f.NgForOf,f.NgIf,re.g,se.k,xt.B,ft.MatIcon,pe.W,D.MatList,D.MatListItem,D.MatListItemIcon,D.MatListItemLine,D.MatListItemTitle,vt.CdkConnectedOverlay,k.TranslatePipe],styles:["body[_ngcontent-%COMP%]{--focus-outline-outer-color: var(--crt-palette-secondary-500);--focus-outline-inner-color: white}.dtmf-panel[_ngcontent-%COMP%]{width:fit-content;border-radius:8px;padding:16px}.dtmf-panel[_ngcontent-%COMP%]   .dtmf-buttons[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;align-items:center;justify-content:center}.dtmf-panel[_ngcontent-%COMP%]   .dtmf-buttons[_ngcontent-%COMP%]   .dtmf-button[_ngcontent-%COMP%]{width:42px;border-radius:4px}.dtmf-panel[_ngcontent-%COMP%]   .dtmf-input-row[_ngcontent-%COMP%]{width:100%;white-space:nowrap;min-height:1.4em;margin-bottom:16px}.dtmf-panel[_ngcontent-%COMP%]   .dtmf-input-row[_ngcontent-%COMP%]   .dtmf-input[_ngcontent-%COMP%]{display:inline-block;min-width:100%;text-align:center;line-height:16px;color:#000}[_nghost-%COMP%]{--crt-search-icons-size: 16px;--crt-search-component-height: 32px;max-width:400px;display:flex;flex-direction:column;gap:16px;margin-top:6px}[_nghost-%COMP%]   .call-tile-wrapper[_ngcontent-%COMP%]{margin-bottom:8px}[_nghost-%COMP%]   .call-tile[_ngcontent-%COMP%]{background:#fff;border-radius:8px;display:grid;grid-template-columns:42px 1fr 34px}[_nghost-%COMP%]   .call-tile[_ngcontent-%COMP%]   .contact-info[_ngcontent-%COMP%]{grid-column:1/span 3;display:grid;grid-template-columns:42px 1fr 34px;align-items:center}[_nghost-%COMP%]   .call-tile[_ngcontent-%COMP%]   .call-transferred[_ngcontent-%COMP%]{grid-column:1;align-self:center;width:10px;height:10px;margin:4px 8px}[_nghost-%COMP%]   .call-tile[_ngcontent-%COMP%]   .call-identity-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:34px 1fr 34px;grid-auto-rows:auto;row-gap:8px}[_nghost-%COMP%]   .call-tile[_ngcontent-%COMP%]   .contact-name[_ngcontent-%COMP%]{line-height:22px;margin-top:2px;margin-bottom:6px}[_nghost-%COMP%]   .call-tile[_ngcontent-%COMP%]   .fields-table[_ngcontent-%COMP%]{display:grid;gap:2px;grid-column:2/span 2}[_nghost-%COMP%]   .call-tile[_ngcontent-%COMP%]   .fields-table[_ngcontent-%COMP%]   .field-row[_ngcontent-%COMP%]{display:grid;column-gap:12px;grid-template-columns:1fr 1fr}[_nghost-%COMP%]   .call-tile[_ngcontent-%COMP%]   .search-results[_ngcontent-%COMP%]{grid-column:1/span 3;max-width:350px}[_nghost-%COMP%]   .call-tile[_ngcontent-%COMP%]   .search-results[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{cursor:pointer;border-radius:4px;outline:none;height:30px}[_nghost-%COMP%]   .call-tile[_ngcontent-%COMP%]   .search-results[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]:hover{background-color:#f1f1f1}[_nghost-%COMP%]   .call-tile[_ngcontent-%COMP%]   .search-results[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]:focus{background-color:#90caf9}[_nghost-%COMP%]   .call-tile[_ngcontent-%COMP%]   .search-results[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]   .number.selected[_ngcontent-%COMP%]{background-color:#90caf9;font-weight:700}[_nghost-%COMP%]   .call-tile[_ngcontent-%COMP%]   .search-results[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin:0}[_nghost-%COMP%]   .call-tile[_ngcontent-%COMP%]   .buttons-row[_ngcontent-%COMP%]{margin-top:8px;display:flex;gap:8px;grid-column:2/span 2;justify-content:center}[_nghost-%COMP%]   .call-tile[_ngcontent-%COMP%]   .buttons-row[_ngcontent-%COMP%]   .call-btn[_ngcontent-%COMP%]{cursor:pointer;border-radius:4px;width:50%;display:grid}[_nghost-%COMP%]   mat-icon[_ngcontent-%COMP%]{display:flex;cursor:pointer;width:var(--crt-search-icons-size);height:var(--crt-search-icons-size);min-width:var(--crt-search-icons-size);min-height:var(--crt-search-icons-size)}[_nghost-%COMP%]   mat-icon[_ngcontent-%COMP%]:focus-visible{box-shadow:inset 0 0 0 1px var(--focus-outline-outer-color),inset 0 0 0 2px var(--focus-outline-inner-color);outline:none;border-radius:4px}[_nghost-%COMP%]   .crt-search-container[_ngcontent-%COMP%]{margin-top:8px;min-height:inherit;grid-column:2/span 2;justify-content:center}[_nghost-%COMP%]   .crt-search-container[_ngcontent-%COMP%]   .crt-search-input-container[_ngcontent-%COMP%]{display:flex;min-height:calc(var(--crt-search-component-height) - 1px);min-width:290px;box-sizing:border-box;align-items:center;border:1px solid #ccc;border-radius:8px;padding:4px 8px;background-color:#fff;width:100%}[_nghost-%COMP%]   .crt-search-container[_ngcontent-%COMP%]   .crt-search-input-container[_ngcontent-%COMP%]   .crt-search-icon[_ngcontent-%COMP%]{margin-inline-end:var(--crt-search-mat-icons-end-margin)}[_nghost-%COMP%]   .crt-search-container[_ngcontent-%COMP%]   .crt-search-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;outline:none;background:none;padding:2px 0;text-overflow:ellipsis;width:100%;min-width:200px}[_nghost-%COMP%]   .crt-search-minify-container[_ngcontent-%COMP%]{display:flex;align-items:center;overflow:hidden;margin-inline-start:4px;flex:1}[_nghost-%COMP%]   .controls-slot[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;gap:8px}[_nghost-%COMP%]:has(.controls-slot:not(:empty))   .divider[_ngcontent-%COMP%]{border-bottom:1px solid var(--crt-palette-border-500, #e3e3e3)}"]})}};(0,r.__decorate)([(0,E.k)(),(0,r.__metadata)("design:type",Object),(0,r.__metadata)("design:paramtypes",[Object])],_.prototype,"currentCall",null),(0,r.__decorate)([(0,b.j)(),(0,r.__metadata)("design:type",Object)],_.prototype,"currentCallChange",void 0),(0,r.__decorate)([(0,E.k)(),(0,r.__metadata)("design:type",Object),(0,r.__metadata)("design:paramtypes",[Object])],_.prototype,"currentCallContact",null),(0,r.__decorate)([(0,b.j)(),(0,r.__metadata)("design:type",Object)],_.prototype,"currentCallContactChange",void 0),(0,r.__decorate)([(0,E.k)(),(0,r.__metadata)("design:type",Object),(0,r.__metadata)("design:paramtypes",[Object])],_.prototype,"currentCallAccount",null),(0,r.__decorate)([(0,b.j)(),(0,r.__metadata)("design:type",Object)],_.prototype,"currentCallAccountChange",void 0),(0,r.__decorate)([(0,b.j)(),(0,r.__metadata)("design:type",Object)],_.prototype,"callConversationChange",void 0),_=(0,r.__decorate)([(0,Z.v)({type:"crt.CallConversation",contentSlots:["callControlsPanel"],reuseStrategy:z.B.Reuse}),(0,r.__metadata)("design:paramtypes",[e.Injector])],_);var J=o(23872),At=o(56704),vn=o(15959);class X extends vn.H{constructor(t,n){if(super(),this.isWrapUp=!1,!t)return;const a=t.isCallIncoming?"AgentInbox.IncomingCallTpl":"AgentInbox.OutgoingCallTpl";this.id=t.callId,this.date=t.startedOn,this.author=t.identity?new J.B(t.identity.id,t.identity.name):new J.B(null,"?"),this.author.photo=t.identity?t.identity.photo:null,this.caption=t.identity?t.identity.name:null,this.preview=n?.instant(a,{number:t.identity?.number}),this.previewFromServer=t.identity?.number,this.isWrapUp=t.isWrapUp||!1}}var fn=o(83463),yn=o(81207);const In=[[["","slot","callcontrolspanel"]],[["","slot","centerpanel"]],[["","slot","footerpanel"]]],bn=["[slot='callControlsPanel']","[slot='centerPanel']","[slot='footerPanel']"],ue=i=>({number:i});function xn(i,t){i&1&&e.\u0275\u0275element(0,"crt-skeleton-loader")}function wn(i,t){if(i&1){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",2)(1,"div",3)(2,"div",4),e.\u0275\u0275element(3,"crt-button",5),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275pipe(5,"translate"),e.\u0275\u0275pipe(6,"translate"),e.\u0275\u0275element(7,"crt-button",5),e.\u0275\u0275pipe(8,"translate"),e.\u0275\u0275pipe(9,"translate"),e.\u0275\u0275pipe(10,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(11,"crt-expansion-panel",6),e.\u0275\u0275pipe(12,"translate"),e.\u0275\u0275element(13,"crt-chat-list",7),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(14,"crt-expansion-panel",6),e.\u0275\u0275pipe(15,"translate"),e.\u0275\u0275elementStart(16,"crt-chat-list",8),e.\u0275\u0275listener("chatClicked",function(l){e.\u0275\u0275restoreView(n);const s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.onChatClicked(l))}),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(17,"div",9)(18,"div",10)(19,"div",11)(20,"crt-call-conversation",12),e.\u0275\u0275listener("currentCallChange",function(l){e.\u0275\u0275restoreView(n);const s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.onCurrentCallChange(l))})("currentCallContactChange",function(l){e.\u0275\u0275restoreView(n);const s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.onCurrentCallContactChange(l))})("currentCallAccountChange",function(l){e.\u0275\u0275restoreView(n);const s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.onCurrentCallAccountChange(l))}),e.\u0275\u0275projection(21),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(22,"div",13),e.\u0275\u0275projection(23,1),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(24,"div",14),e.\u0275\u0275projection(25,2),e.\u0275\u0275elementEnd()()()()}if(i&2){const n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275property("icon","flag-button-icon")("ariaLabel",e.\u0275\u0275pipeBind1(4,22,"AgentInbox.RealTime"))("title",e.\u0275\u0275pipeBind1(5,24,"AgentInbox.RealTime"))("caption",e.\u0275\u0275pipeBind1(6,26,"AgentInbox.RealTime")),e.\u0275\u0275advance(4),e.\u0275\u0275property("icon","queued-tasks")("ariaLabel",e.\u0275\u0275pipeBind1(8,28,"AgentInbox.QueuedTasks"))("title",e.\u0275\u0275pipeBind1(9,30,"AgentInbox.QueuedTasks"))("caption",e.\u0275\u0275pipeBind1(10,32,"AgentInbox.QueuedTasks")),e.\u0275\u0275advance(4),e.\u0275\u0275property("title",e.\u0275\u0275pipeBind2(12,34,"AgentInbox.NewItems",e.\u0275\u0275pureFunction1(40,ue,n.newChatLength)))("expanded",!0),e.\u0275\u0275attribute("data-item-marker","New items"),e.\u0275\u0275advance(2),e.\u0275\u0275property("chats",n.newItems)("searchFilter","")("showNoDataBlankState",!1),e.\u0275\u0275advance(),e.\u0275\u0275property("title",e.\u0275\u0275pipeBind2(15,37,"AgentInbox.InProgress",e.\u0275\u0275pureFunction1(42,ue,n.chatLength)))("expanded",!0),e.\u0275\u0275attribute("data-item-marker","In progress"),e.\u0275\u0275advance(2),e.\u0275\u0275property("chats",n.inProgressItems)("searchFilter","")("showNoDataBlankState",!1),e.\u0275\u0275advance(2),e.\u0275\u0275styleProp("display",n.isCallConversationOpened?"flex":"none")}}let y=class Ft extends K.K{get chatLength(){return this.inProgressItems?.length||0}get newChatLength(){return this.newItems?.length||0}set currentCall(t){}set currentCallContact(t){}set currentCallAccount(t){}constructor(t,n,a){super(t),this.el=n,this.renderer=a,this._wrapUpMeta=new Map,this._wrapUpSubscriptions=[],this.inProgressItems=[],this.newItems=[],this.isCallConversationOpened=!1,this.currentCallChange=new e.EventEmitter,this.currentCallContactChange=new e.EventEmitter,this.currentCallAccountChange=new e.EventEmitter,this._omnichannelChatService=t.get(At.I),this._translate=t.get(k.TranslateService),this._ctiStateService=t.get(S),this._wrapUpService=t.get(I),this._callSelectionService=t.get(B)}_loadChats(){var t=this;return(0,m.A)(function*(){const n=yield t._getChats();t.inProgressItems=t.inProgressItems.concat(n.filter(a=>a.operator?.value).map(a=>t._mapChatPreview(a))),t.newItems=t.newItems.concat(n.filter(a=>!a.operator?.value).map(a=>t._mapChatPreview(a)))})()}_mapChatPreview(t){return{id:t.id,date:t.lastMessageTime,author:t.contact?new J.B(t.contact.id,t.contact.name,t.contact.photoId):new J.B,caption:t.chatPreview,preview:t.chatPreview,previewFromServer:t.chatPreview,previewMessageId:null,unreadMessagesCount:0}}_getChats(){return(0,c.lastValueFrom)(this._omnichannelChatService.getOperatorChats().pipe((0,c.filter)(t=>t.success),(0,c.map)(t=>t.result)))}_emitCallChanges(t){this.currentCallChange.emit(t?this._currentCallInternal:null),this.currentCallContactChange.emit(t?this._currentCallContactInternal:null),this.currentCallAccountChange.emit(t?this._currentCallAccountInternal:null)}_onCallConversationChanged(t){if(!t?.state)this._clearCallsInProgressItems(),this.isCallConversationOpened=this._wrapUpService.isWrapUpEnabled||!1;else{const n=new X(t,this._translate);this._updateInProgressItems(n),this.isCallConversationOpened=!0}this._emitCallChanges(this.isCallConversationOpened),this.changeDetectorRef.detectChanges()}_updateInProgressItems(t){const n=this.inProgressItems.findIndex(a=>a.id===t.id);n===-1?this.inProgressItems.unshift(t):this.inProgressItems.splice(n,1,t)}_clearCallsInProgressItems(){this.inProgressItems=this.inProgressItems.filter(t=>!(t instanceof X)||t.isWrapUp)}_subscribeToCallStateChanges(){this._ctiStateService.activeCalls$.pipe((0,c.takeUntil)(this.destroyed$)).subscribe(t=>{const n=t.length>0?t[0]:null;this._onCallConversationChanged(n)})}_subscribeToWrapUp(){this._wrapUpSubscriptions.push(this._wrapUpService.wrapUpStarted$.pipe((0,c.takeUntil)(this.destroyed$)).subscribe(t=>{const n=new X(t.conversation,this._translate);n.isWrapUp=!0,this._wrapUpMeta.set(t.callId,{isWrapUp:!0,isActive:!1,remainingSec:t.periodSec}),n.preview=this._translate?.instant("AgentInbox.IncomingListItemCallTileTpl",{sec:t.periodSec}),this._updateInProgressItems(n),this._callSelectionService.selectCall(n.id),this.changeDetectorRef.detectChanges()})),this._wrapUpSubscriptions.push(this._wrapUpService.wrapUpTick$.pipe((0,c.takeUntil)(this.destroyed$)).subscribe(t=>{const n=this._wrapUpMeta.get(t.callId);n&&(n.remainingSec=t.remainingSec);const a=this.inProgressItems.findIndex(l=>l.id===t.callId);if(a!==-1){const l=this.inProgressItems[a];l.preview=this._translate?.instant("AgentInbox.IncomingListItemCallTileTpl",{sec:t.remainingSec}),this.inProgressItems.splice(a,1,l),this.changeDetectorRef.detectChanges()}})),this._wrapUpSubscriptions.push(this._wrapUpService.wrapUpEnded$.pipe((0,c.takeUntil)(this.destroyed$)).subscribe(t=>{this._wrapUpMeta.delete(t.callId),this.inProgressItems=this.inProgressItems.filter(n=>n.id!==t.callId),this.isCallConversationOpened=!1,this.changeDetectorRef.detectChanges()}))}ngOnInit(){this._loadChats(),this._subscribeToCallStateChanges(),this._subscribeToWrapUp()}ngAfterViewInit(){const t=this.el.nativeElement.querySelector(".container"),n=this.el.nativeElement.querySelector(".conversation-panel");new ResizeObserver(l=>{for(const s of l)s.contentRect.width>600?this.renderer.setStyle(n,"display","block"):this.renderer.setStyle(n,"display","none")}).observe(t)}onChatClicked(t){this.isCallConversationOpened=t instanceof X,this._callSelectionService.selectCall(t.id),this._emitCallChanges(this.isCallConversationOpened)}onCurrentCallChange(t){this._currentCallInternal=t,this.currentCallChange.emit(this.isCallConversationOpened?this._currentCallInternal:null)}onCurrentCallContactChange(t){this._currentCallContactInternal=t,this.currentCallContactChange.emit(this.isCallConversationOpened?this._currentCallContactInternal:null)}onCurrentCallAccountChange(t){this._currentCallAccountInternal=t,this.currentCallAccountChange.emit(this.isCallConversationOpened?this._currentCallAccountInternal:null)}ngOnDestroy(){for(const t of this._wrapUpSubscriptions)t.unsubscribe();this._wrapUpSubscriptions=[]}static{this.\u0275fac=function(n){return new(n||Ft)(e.\u0275\u0275directiveInject(e.Injector),e.\u0275\u0275directiveInject(e.ElementRef),e.\u0275\u0275directiveInject(e.Renderer2))}}static{this.\u0275cmp=e.\u0275\u0275defineComponent({type:Ft,selectors:[["crt-agent-inbox"]],inputs:{currentCall:"currentCall",currentCallContact:"currentCallContact",currentCallAccount:"currentCallAccount"},outputs:{currentCallChange:"currentCallChange",currentCallContactChange:"currentCallContactChange",currentCallAccountChange:"currentCallAccountChange"},features:[e.\u0275\u0275InheritDefinitionFeature],ngContentSelectors:bn,decls:3,vars:2,consts:[["agentinbox_template",""],[4,"ngIf","ngIfElse"],[1,"container"],[1,"agent-queue-panel"],[1,"btn-row"],["iconPosition","left-icon","displayType","text","size","medium",1,"crt-create-item-button",3,"icon","ariaLabel","title","caption"],["togglePosition","after","toggleType","material",3,"title","expanded"],[3,"chats","searchFilter","showNoDataBlankState"],[3,"chatClicked","chats","searchFilter","showNoDataBlankState"],[1,"conversation-panel"],[1,"call-conversation-panel"],[1,"call-controls"],[3,"currentCallChange","currentCallContactChange","currentCallAccountChange"],[1,"centerPanel"],[1,"footer"]],template:function(n,a){if(n&1&&(e.\u0275\u0275projectionDef(In),e.\u0275\u0275template(0,xn,1,0,"crt-skeleton-loader",1)(1,wn,26,44,"ng-template",null,0,e.\u0275\u0275templateRefExtractor)),n&2){const l=e.\u0275\u0275reference(2);e.\u0275\u0275property("ngIf",a.loading)("ngIfElse",l)}},dependencies:[f.NgIf,xt.B,fn.l,yn.o,pe.W,_,k.TranslatePipe],styles:["[_nghost-%COMP%]{--crt-agent-inbox-block-margin: 16px}[_nghost-%COMP%]   .container[_ngcontent-%COMP%]{display:flex;gap:var(--crt-agent-inbox-block-margin);height:calc(100vh - 120px)}[_nghost-%COMP%]   .btn-row[_ngcontent-%COMP%]{display:flex;gap:10px}[_nghost-%COMP%]   .agent-queue-panel[_ngcontent-%COMP%]{width:100%;flex:1;display:flex;flex-direction:column;height:400px;overflow-y:auto;overflow-x:hidden;border-right:1px solid var(--crt-palette-border-500, #e3e3e3);margin-top:var(--crt-agent-inbox-block-margin);margin-left:var(--crt-agent-inbox-block-margin)}[_nghost-%COMP%]   .conversation-panel[_ngcontent-%COMP%]{flex:1;display:none;margin-top:var(--crt-agent-inbox-block-margin);margin-right:var(--crt-agent-inbox-block-margin)}[_nghost-%COMP%]   .conversation-panel[_ngcontent-%COMP%]   .call-conversation-panel[_ngcontent-%COMP%]{flex-direction:column;justify-content:space-between;height:100%}[_nghost-%COMP%]   .conversation-panel[_ngcontent-%COMP%]   .call-conversation-panel[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px;padding-top:10px;border-top:1px solid var(--crt-palette-border-500, #e3e3e3)}[_nghost-%COMP%]   .conversation-panel[_ngcontent-%COMP%]   .call-conversation-panel[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]:empty{display:none}"]})}};(0,r.__decorate)([(0,E.k)(),(0,r.__metadata)("design:type",Object),(0,r.__metadata)("design:paramtypes",[Object])],y.prototype,"currentCall",null),(0,r.__decorate)([(0,b.j)(),(0,r.__metadata)("design:type",Object)],y.prototype,"currentCallChange",void 0),(0,r.__decorate)([(0,E.k)(),(0,r.__metadata)("design:type",Object),(0,r.__metadata)("design:paramtypes",[Object])],y.prototype,"currentCallContact",null),(0,r.__decorate)([(0,b.j)(),(0,r.__metadata)("design:type",Object)],y.prototype,"currentCallContactChange",void 0),(0,r.__decorate)([(0,E.k)(),(0,r.__metadata)("design:type",Object),(0,r.__metadata)("design:paramtypes",[Object])],y.prototype,"currentCallAccount",null),(0,r.__decorate)([(0,b.j)(),(0,r.__metadata)("design:type",Object)],y.prototype,"currentCallAccountChange",void 0),y=(0,r.__decorate)([(0,Z.v)({type:"crt.AgentInbox",contentSlots:["callControlsPanel","centerPanel","footerPanel"],reuseStrategy:z.B.Reuse}),(0,r.__metadata)("design:paramtypes",[e.Injector,e.ElementRef,e.Renderer2])],y);var O=o(4164);let $=class{constructor(t){this._omnichannelChatService=t,this._chatSchemaName="OmniChat"}getChats(t){return(0,c.lastValueFrom)(this._omnichannelChatService.getOperatorChats().pipe((0,c.filter)(n=>n.success),(0,c.map)(n=>n.result),(0,c.map)(n=>n.filter(a=>t?a.operator.value:!a.operator.value).map(a=>({schemaName:this._chatSchemaName,id:a.id,contact:a.contact?{value:a.contact.id,displayValue:a.contact.name,primaryImageValue:a.contact.photoId}:null,accepted:t,itemTitle:a.chatPreview,createdOn:a.lastMessageTime,additionalParams:{chatQueueId:a.chatQueueId,status:a.status,channel:a.channel,lastMessageTime:a.lastMessageTime,unprocessedMsgCount:a.unprocessedMsgCount,operator:a.operator,closeDate:a.closeDate,completionDate:a.completionDate,lastMessageDirection:a.lastMessageDirection,channelId:a.channelId}})))))}};$=(0,r.__decorate)([(0,O.a)(),(0,r.__metadata)("design:paramtypes",[At.I])],$);let G=class extends ${convert(){return this.getChats(!0)}};G=(0,r.__decorate)([(0,O.a)({type:"crt.LoadInProgressChats"})],G);let q=class extends ${convert(){return this.getChats(!1)}};q=(0,r.__decorate)([(0,O.a)({type:"crt.LoadNotAcceptedChats"})],q);let tt=class{convert(t){return t.flat().filter(n=>!!n)}};tt=(0,r.__decorate)([(0,O.a)({type:"crt.MergeIncomingItems"})],tt);let et=class{convert(t,n,a){return(0,m.A)(function*(){return!t||t.length===0||!a?[]:yield Promise.all(t.map(function(){var s=(0,m.A)(function*(d){return{schemaName:(yield d.getPrimaryDataSchema()).name,id:yield d[a.id],itemTitle:yield d[a.itemTitle],createdOn:yield d[a.createdOn],contact:yield d[a.contact],accepted:!0}});return function(d){return s.apply(this,arguments)}}()))})()}};et=(0,r.__decorate)([(0,O.a)({type:"crt.ViewModelCollectionToIncomingItemsArray"})],et);let nt=class{convert(t){const n=t?.state===w.CONNECTED||t?.state===w.HOLDED||t?.state===w.CONFERENCED,a=t?.isWrapUp||!1;return n||a}};nt=(0,r.__decorate)([(0,O.a)({type:"crt.IsCallActive"})],nt);let at=class{constructor(t){this._wrapUpService=t}convert(t){const n=t[0],a=t[1],l=t[2],s=t[3],d=t[4],h=(a??"")!==(s??""),p=(l??"")!==(d?.value??""),v=h||p;return v&&this._wrapUpService?.typing(n?.callId),v}};at=(0,r.__decorate)([(0,O.a)({type:"crt.IsCallDetailsChanged"}),(0,r.__metadata)("design:paramtypes",[I])],at);let it=class{convert(t){const n=t[0],a=t[1];return!n&&(a?.isWrapUp??!1)}};it=(0,r.__decorate)([(0,O.a)({type:"crt.IsCallDetailsUnchanged"})],it);let lt=class{convert(t){const n=t[0],a=t[1];return n&&(a?.isWrapUp??!1)}};lt=(0,r.__decorate)([(0,O.a)({type:"crt.IsCallDetailsChangedAndWrapUp"})],lt);var N=o(81517),A=o(2828),M=o(41287),P=o(844),Sn=o(40968),On=o(22592),An=o(99298);let Mt=class extends N.S{};Mt=(0,r.__decorate)([(0,A.$)({type:"crt.AcceptChatRequest"})],Mt);let ot=class extends M.l{constructor(t,n){super(),this._omnichannelChatService=t,this._maskService=n}handle(t){var n=this;return(0,m.A)(function*(){if(t.incomingItem){const a=t.incomingItem.schemaName,l=t.incomingItem.id;if(a===Le){const s=`ACCEPT_CHAT_${l}`;yield n._maskService.showMask(s,t.$context),yield(0,c.lastValueFrom)(n._omnichannelChatService.acceptChat(l)),yield n._maskService.hideMask(s,t.$context)}}yield n.next?.handle(t)})()}};ot=(0,r.__decorate)([(0,P.l)({requestType:"crt.AcceptChatRequest",type:"crt.AcceptChatHandler"}),(0,r.__param)(1,(0,Sn.j)(An.V)),(0,r.__metadata)("design:paramtypes",[At.I,On.s])],ot);let rt=class extends N.S{};rt=(0,r.__decorate)([(0,A.$)({type:"crt.ClearCallDetailsRequest"})],rt);let st=class extends M.l{_clearCallDetails(t){return(0,m.A)(function*(){const n=t.$context,a=yield n[t.callAttributeName];a&&!a?.isWrapUp||(n[t.callResultAttributeName]=null,n[t.callCommentAttributeName]=null,n[t.savedCallCommentAttributeName]=null,n[t.savedCallResultAttributeName]=null)})()}handle(t){var n=this;return(0,m.A)(function*(){return t.callAttributeName&&t.callResultAttributeName&&t.callCommentAttributeName&&t.savedCallCommentAttributeName&&t.savedCallResultAttributeName&&(yield n._clearCallDetails(t)),n.next?.handle(t)})()}};st=(0,r.__decorate)([(0,P.l)({type:"crt.ClearCallDetailsHandler",requestType:"crt.ClearCallDetailsRequest"})],st);let Pt=class extends rt{};Pt=(0,r.__decorate)([(0,A.$)({type:"crt.CloseCallDetailsRequest"})],Pt);let ct=class extends M.l{constructor(t){super(),this._wrapUpService=t}handle(t){var n=this;return(0,m.A)(function*(){switch(t.reason){case"complete":n._wrapUpService.complete(t.currentCall?.callId);break;default:n._wrapUpService.close(t.currentCall?.callId);break}yield n.handlerChain.process({...t,type:"crt.ClearCallDetailsRequest"}),yield n.next?.handle(t)})()}};ct=(0,r.__decorate)([(0,P.l)({requestType:"crt.CloseCallDetailsRequest",type:"crt.CloseCallDetailsHandler"}),(0,r.__metadata)("design:paramtypes",[I])],ct);var Mn=o(94449);let Et=class extends N.S{};Et=(0,r.__decorate)([(0,A.$)({type:"crt.RunCtiProcessActionRequest"})],Et);let dt=class extends M.l{constructor(t){super(),this._processEngineService=t}handle(t){var n=this;return(0,m.A)(function*(){if(!(0,u.isEmpty)(t.processName)&&!(0,u.isEmpty)(t.call)){const a={PhoneNumber:t.call.displayValue,CallId:t.call.value};(0,u.isEmpty)(t.callContact)||(a.ContactId=t.callContact.value),(0,u.isEmpty)(t.callAccount)||(a.AccountId=t.callAccount.value),yield(0,c.lastValueFrom)(n._processEngineService.executeProcessByName(t.processName,a))}yield n.next?.handle(t)})()}};dt=(0,r.__decorate)([(0,P.l)({requestType:"crt.RunCtiProcessActionRequest",type:"crt.RunCtiProcessActionHandler"}),(0,r.__metadata)("design:paramtypes",[Mn.N])],dt);var Pn=o(5240),he=o(65576);let Tt=class extends N.S{};Tt=(0,r.__decorate)([(0,A.$)({type:"crt.SubscribeToChatUpdateRequest"})],Tt);let Ct=class extends M.l{constructor(t){super(),this._messageChannelService=t}_subscribeViewModelEvents(t){const n=t.$context;let a=null;const l=new c.Subscription;l.add(n.events$.pipe((0,c.filter)(({type:s})=>s===he.n.FinishLoadModelAttributes)).subscribe({next:s=>{a=this._messageChannelService.messageEvent$.pipe((0,c.filter)(d=>["AcceptChat","NewIncomingChat","NewTransferredChat","CompleteChat"].includes(d?.header?.sender)),(0,c.debounceTime)(100)).subscribe(()=>{this.handlerChain.process({type:"crt.ReloadChats",$context:n,scopes:t.scopes}).then()})},complete:()=>{a.unsubscribe(),l.unsubscribe()}}))}handle(t){var n=this;return(0,m.A)(function*(){yield n.next?.handle(t),n._subscribeViewModelEvents(t)})()}};Ct=(0,r.__decorate)([(0,P.l)({requestType:"crt.SubscribeToChatUpdateRequest",type:"crt.SubscribeToChatUpdateHandler"}),(0,r.__metadata)("design:paramtypes",[Pn.A])],Ct);let Nt=class extends N.S{};Nt=(0,r.__decorate)([(0,A.$)({type:"crt.SubscribeToCtiEventsRequest"})],Nt);let pt=class extends M.l{constructor(t){super(),this._customEventService=t}_subscribeViewModelEvents(t){const n=t.$context;let a=null;const l=new c.Subscription;l.add(n.events$.pipe((0,c.filter)(({type:s})=>s===he.n.FinishLoadModelAttributes)).subscribe({next:s=>{a=this._customEventService.subscribe("CtiModelEvents").subscribe(d=>{const h=d[0],p=d[1];n[t.callsAttributeName].then(v=>{switch(h){case"callSaved":p.databaseUId&&p.state&&!v.find(Rt=>Rt.id===p.databaseUId)&&(v=[...v,{schemaName:"Call",id:p.databaseUId,accepted:!0,itemTitle:p.callerId??p.calledId,createdOn:new Date,contact:null,additionalParams:{ctiPanelCallId:p.id}}],n[t.callsAttributeName]=v);break;case"callFinished":v=v.filter(Rt=>Rt.id!==p.databaseUId),n[t.callsAttributeName]=v;break}})})},complete:()=>{a.unsubscribe(),l.unsubscribe()}}))}handle(t){var n=this;return(0,m.A)(function*(){yield n.next?.handle(t),n._subscribeViewModelEvents(t)})()}};pt=(0,r.__decorate)([(0,P.l)({requestType:"crt.SubscribeToCtiEventsRequest",type:"crt.SubscribeToCtiEventsHandler"}),(0,r.__metadata)("design:paramtypes",[de.Dj])],pt);var En=o(74709),ge=o(86464),Tn=o(6503);let Dt=class extends N.S{};Dt=(0,r.__decorate)([(0,A.$)({type:"crt.SaveCallDetailsRequest"})],Dt);let mt=class extends M.l{constructor(t,n,a){super(),this._queryExecutor=t,this._notifyService=n,this._wrapUpService=a}handle(t){var n=this;return(0,m.A)(function*(){const a=t.$context;if(!(!!t?.currentCall?.value&&!!t?.callCommentAttributeName&&!!t?.callResultAttributeName)){yield n.next?.handle(t);return}const s=yield a[t.callCommentAttributeName],d=(yield a[t.callResultAttributeName])?.value,h=new En.N("Call");h.addColumn("Comment",s,ge.r.Text),h.addColumn("Result",d,ge.r.Guid),h.filters.addSchemaColumnFilterWithParameter(V.H.Equal,"Id",t.currentCall.value),n._queryExecutor.executeUpdateQuery(h).pipe((0,c.take)(1)).subscribe(()=>{n._notifyService.info({message:"SaveCallDetailsHandler.UpdateSuccessMessage",duration:5e3}),n._wrapUpService.complete(t.currentCall.callId),a[t.savedCallCommentAttributeName]=s,a[t.savedCallResultAttributeName]=d}),yield n.next?.handle(t)})()}};mt=(0,r.__decorate)([(0,P.l)({requestType:"crt.SaveCallDetailsRequest",type:"crt.SaveCallDetailsHandler"}),(0,r.__metadata)("design:paramtypes",[wt.w,Tn.F,I])],mt);let kt=class extends N.S{};kt=(0,r.__decorate)([(0,A.$)({type:"crt.BaseAgentItemClickedRequest"})],kt);let ut=class extends M.l{handle(t){var n=this;return(0,m.A)(function*(){if(t.id){if(t.$context.SelectedItemId=t.id,t.$context.SelectedCollectionName=t.collectionName,t.collectionName==="ChatsNewItemsDS"){const a={type:"crt.AcceptOmniChatRequest",$context:t.$context,chatId:t.id};n.handlerChain.process(a)}if(t.collectionName==="ChatsInProgressItemsDS"){const a={type:"crt.OpenOmniChatRequest",$context:t.$context,chatId:t.id};n.handlerChain.process(a)}yield n.next?.handle(t)}})()}};ut=(0,r.__decorate)([(0,P.l)({type:"crt.BaseAgentItemClickedHandler",requestType:"crt.BaseAgentItemClickedRequest"})],ut);let Ut=class extends N.S{};Ut=(0,r.__decorate)([(0,A.$)({type:"crt.AgentInboxModeRequest"})],Ut);let ht=class extends M.l{handleConversationOpen(t,n){return(0,m.A)(function*(){})()}handle(t){var n=this;return(0,m.A)(function*(){yield n.next?.handle(t);const a=t.$context;a.IsCombinedMode=t.isCombined,yield n.handleConversationOpen(a,t)})()}};ht=(0,r.__decorate)([(0,P.l)({type:"crt.AgentInboxModeHandler",requestType:"crt.AgentInboxModeRequest",scopes:["AgentSideBar"]})],ht);var _e=o(74368);class H{constructor(){this._metadataSchemaUtils=(0,e.inject)(_e.u)}_getViewConfigs(t){return this._metadataSchemaUtils.getViewConfigInfoByProperty("type","crt.IncomingItems",t.viewConfig).map(n=>n?.viewConfig).filter(Boolean)}_createItemsAttribute(t,n){if(!(0,u.isEmpty)(t.items)||!t.dataAttributes||(0,u.isEmpty)(t.dataAttributes))return;const a=`IncomingItems_${t.name}`,l=n.viewModelConfig.attributes;l[a]={from:t.dataAttributes,converter:"crt.MergeIncomingItems"},t.items=`$${a}`}crtOnMetaDataInit(t){const n=t,a=this._getViewConfigs(n);for(const l of a)this._createItemsAttribute(l,n);return Promise.resolve(t)}static{this.\u0275fac=function(n){return new(n||H)}}static{this.\u0275prov=e.\u0275\u0275defineInjectable({token:H,factory:H.\u0275fac})}}var Nn=o(38772),Dn=o(61320),kn=o(95145),Un=o(61775),Vn=o(41483),Ln=o(95211);const Bn="cti-actions-cache",Vt="cti-actions-avaliable-cache",Lt="cti-actions-list-cache";class j{constructor(t){this.injector=t,this._metadataSchemaUtils=t.get(_e.u),this._queryExecutor=t.get(wt.w),this._sysSettingsService=t.get(kn.A),this._userInfo=t.get(bt.oq),this._cacheManager=t.get(Un.G)}_getViewConfigs(t){return this._metadataSchemaUtils.getViewConfigInfoByProperty("type","crt.AgentInbox",t.viewConfig).map(n=>n?.viewConfig).filter(Boolean)}_getCache(){var t=this;return(0,m.A)(function*(){return yield t._cacheManager.getOrCreate({name:Bn,type:Vn.P.Memory})})()}_getIsUserHasCtiActions(){var t=this;return(0,m.A)(function*(){const n=yield(0,c.lastValueFrom)(t._sysSettingsService.getByCode("ContactCenterOperatorsFolder"));if((0,u.isEmpty)(n)||(0,u.isEmpty)(n.value))return!1;const a=yield t._getCache();let l;if(yield a.has(Vt))l=yield a.get(Vt);else{const d=new Q.s("SysUserInRole");d.addAggregationFunctionColumn("Id",Nn.C.Count,"Count"),d.filters.addSchemaColumnFilterWithParameter(V.H.Equal,"SysRole",n.value),d.filters.addSchemaColumnFilterWithParameter(V.H.Equal,"SysUser",t._userInfo.id),l=yield(0,c.lastValueFrom)(t._queryExecutor.executeSelectQuery(d)),yield a.set(Vt,l)}return(l?.length?Number(l[0].Count):0)>0})()}_getCtiProcessActions(){var t=this;return(0,m.A)(function*(){const n=yield t._getCache();if(yield n.has(Lt))return n.get(Lt);const a=new Q.s("CTIProcessAction");a.addSchemaColumn("Id"),a.addSchemaColumn("Name"),a.addSchemaColumn("ProcessSchema.Name","ProcessSchemaName"),a.addSchemaColumn("Position").withOrdering(Dn.Z.Asc,0);const l=yield(0,c.lastValueFrom)(t._queryExecutor.executeSelectQuery(a));return yield n.set(Lt,l),l})()}_createProcessActions(t,n){n.forEach(a=>{t.footerPanel.push({type:"crt.Button",caption:a.Name,icon:"call-business-process",iconPosition:Ln.q.LeftIcon,color:"outline",name:a.ProcessSchemaName+" "+a.Name,clicked:{request:"crt.RunCtiProcessActionRequest",params:{processName:a.ProcessSchemaName,call:t.currentCall,callContact:t.currentCallContact,callAccount:t.currentCallAccount}}})})}_createAttributes(t,n){const a=n.viewModelConfig.attributes;this._createAttribute("currentCall",t,a),this._createAttribute("currentCallContact",t,a),this._createAttribute("currentCallAccount",t,a)}_createAttribute(t,n,a){if(!(0,u.isEmpty)(n[t]))return;const l=`${n.name}_${t}`;a[l]={value:null},n[t]=`$${l}`}crtOnMetaDataInit(t){var n=this;return(0,m.A)(function*(){const a=t;if(yield n._getIsUserHasCtiActions()){const l=n._getViewConfigs(a);if(!(0,u.isEmpty)(l)){const s=yield n._getCtiProcessActions();for(const d of l)n._createAttributes(d,a),n._createProcessActions(d,s)}}return t})()}static{this.\u0275fac=function(n){return new(n||j)(e.\u0275\u0275inject(e.Injector))}}static{this.\u0275prov=e.\u0275\u0275defineInjectable({token:j,factory:j.\u0275fac})}}var Bt=o(3602);class ve{constructor(t){this.databaseUId=t.databaseUId,this.callId=t.callId,this.state=w[t.state],this.startedOn=t.startedOn,this.isCallIncoming=t.isCallIncoming,this.identityId=t.identity?.id,this.identityName=t.identity?.name,this.identityNumber=t.identity?.number}}class R{constructor(t){this.ctiStateService=t,this._destroyed$=new c.Subject,this._callsInContext={},this._activeCalls$=new c.Subject,this._activeCallsSubscription$=this._activeCalls$.pipe((0,c.debounceTime)(100)).subscribe(n=>{this._resetCallContext(n)}),this._subscribeToCallStateChanges()}_subscribeToCallStateChanges(){this.ctiStateService.activeCalls$.pipe((0,c.takeUntil)(this._destroyed$)).subscribe(t=>{const n=t.filter(l=>l.state!==w.NONE).map(l=>new ve(l)),a=t.filter(l=>l.consultCall&&l.state!==w.NONE).map(l=>new ve(l.consultCall));this._activeCalls$.next([...n,...a])})}_resetCallContext(t){for(const a of t){const l=Object.entries(this._callsInContext).find(([p,v])=>v.callId===a.callId);if(l&&(0,u.isEqual)((0,u.toPlainObject)(l[1]),(0,u.toPlainObject)(a)))continue;l&&(Bt.d.instance.removeContextPart(l[0]),delete this._callsInContext[l[0]]);const d={type:"ConstantValuesContextPart",values:{entity:"Call",callId:a.databaseUId,state:a.state,isCallIncoming:a.isCallIncoming,identityId:a.identityId,identityName:a.identityName,identityNumber:a.identityNumber,startedOn:a.startedOn}},h=Bt.d.instance.setContextPart(()=>d);this._callsInContext[h]={...a}}const n=Object.entries(this._callsInContext).filter(([a,l])=>!t.some(s=>s.callId===l.callId)).map(([a,l])=>a);for(const a of n)Bt.d.instance.removeContextPart(a),delete this._callsInContext[a]}ngOnDestroy(){this._activeCallsSubscription$.unsubscribe(),this._destroyed$.next(),this._destroyed$.complete()}static{this.\u0275fac=function(n){return new(n||R)(e.\u0275\u0275inject(S))}}static{this.\u0275prov=e.\u0275\u0275defineInjectable({token:R,factory:R.\u0275fac,providedIn:"root"})}}let gt=class $t{constructor(t,n){this._materialIconsRegistrator=t,this._callAiContextServiceEagerLoaded=n,this._materialIconsRegistrator.addIcons([{name:"answer-call",icon:o(6188)},{name:"call-business-process",icon:o(45856)},{name:"cancel-transfer-call",icon:o(68854)},{name:"call-transferred-to",icon:o(55442)},{name:"complete-transfer-call",icon:o(62605)},{name:"decline-call",icon:o(6438)},{name:"dtmf-call",icon:o(48533)},{name:"hold-call",icon:o(31087)},{name:"mute-call",icon:o(73919)},{name:"queued-tasks",icon:o(39443)},{name:"transfer-call",icon:o(96793)},{name:"unhold-call",icon:o(38864)},{name:"unmute-call",icon:o(54940)},{name:"video-off",icon:o(98078)},{name:"video-on",icon:o(81192)},{name:"unknown-user",icon:o(25803)}])}static{this.\u0275fac=function(n){return new(n||$t)(e.\u0275\u0275inject(zt.K),e.\u0275\u0275inject(R))}}static{this.\u0275mod=e.\u0275\u0275defineNgModule({type:$t})}static{this.\u0275inj=e.\u0275\u0275defineInjector({providers:[{provide:oe.m,useClass:H,multi:!0},{provide:oe.m,useClass:j,multi:!0},L],imports:[f.CommonModule,Yt.U,Jt.J,Xt.a,Gt.Q,qt.Z,te.S,W.q,k.TranslateModule,Kt.V,Qt.e,ee.o,ne.D,W.q,ae.u,ft.MatIconModule,Zt.q,ie.D,D.MatListModule,le.u,vt.OverlayModule]})}};gt=(0,r.__decorate)([(0,fe.g)({viewElements:[x,F,y,_],converters:[G,q,tt,et,nt,at,it,lt],requestHandlers:[ot,st,ct,dt,Ct,pt,mt,ut,ht]}),(0,r.__metadata)("design:paramtypes",[zt.K,R])],gt),function(){(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(gt,{declarations:[x,F,y,_],imports:[f.CommonModule,Yt.U,Jt.J,Xt.a,Gt.Q,qt.Z,te.S,W.q,k.TranslateModule,Kt.V,Qt.e,ee.o,ne.D,W.q,ae.u,ft.MatIconModule,Zt.q,ie.D,D.MatListModule,le.u,vt.OverlayModule],exports:[x,y,_]})}()},6188:C=>{C.exports=`<svg width="17" height="16" viewBox="0 0 17 16" fill="none" xmlns="http://www.w3.org/2000/svg">\r
	<path d="M14.283 11.0298C15.4108 11.9345 14.2082 12.992 13.6817 13.5954C13.3058 14.0478 12.8541 14.5001 9.62494 12.6908C8.45062 12.0614 7.38518 11.2462 6.46967 10.2763C5.49935 9.34207 4.66405 8.27631 3.98788 7.10994C2.25789 3.86492 2.70946 3.33659 3.16022 3.03896C3.76152 2.51064 4.81453 1.37886 5.71694 2.4355C7.22066 4.24483 7.37119 5.07716 6.84471 5.52949C6.46878 5.75565 6.54362 5.83165 6.31824 5.98182C5.71694 6.58523 5.86747 7.56677 7.29546 9.00066L7.52084 9.3028C8.5738 10.3594 9.92699 10.8878 10.5292 10.3595C10.7227 10.1477 10.8988 9.92043 11.0557 9.68004C11.5821 9.15172 12.1087 9.30279 14.2894 11.037" fill="white"/>\r
</svg>\r
`},45856:C=>{C.exports=`<svg width="14" height="12" viewBox="0 0 14 12" fill="none" xmlns="http://www.w3.org/2000/svg">\r
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.02921 0.381812C6.5546 -0.12727 7.40643 -0.127272 7.93183 0.381812L9.83927 2.23004C9.87487 2.26454 9.90806 2.30049 9.93884 2.33769H10.0695C11.3691 2.33769 12.4227 3.35851 12.4227 4.61775V7.31372H12.6546C13.3977 7.31372 14 7.89736 14 8.61731V10.6964C14 11.4164 13.3977 12 12.6546 12H10.5089C9.76592 12 9.16358 11.4164 9.16358 10.6964V8.61731C9.16358 7.89736 9.76591 7.31372 10.5089 7.31372H10.7397V4.61775C10.7397 4.25912 10.4397 3.9684 10.0695 3.9684H9.93681C9.9066 4.00473 9.87409 4.03986 9.83927 4.0736L7.93183 5.92183C7.40644 6.43091 6.5546 6.43091 6.02921 5.92183L4.12176 4.0736C4.08694 4.03986 4.05443 4.00473 4.02423 3.9684H3.9297C3.55958 3.9684 3.25954 4.25912 3.25954 4.61775V7.45943C4.1803 7.79054 4.83642 8.64946 4.83642 9.65686C4.83642 10.9509 3.75375 12 2.41821 12C1.08267 12 0 10.9509 0 9.65686C0 8.64956 0.655977 7.79072 1.57659 7.45953V4.61775C1.57659 3.35851 2.63011 2.33769 3.9297 2.33769H4.0222C4.05297 2.30049 4.08616 2.26454 4.12176 2.23004L6.02921 0.381812Z" fill="#0D2E4E"/>\r
</svg>\r
`},55442:C=>{C.exports=`<svg width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg">\r
<path d="M1.39466 0.215323C1.05242 -0.0937677 0.524413 -0.066893 0.215323 0.275349C-0.0937677 0.617591 -0.066893 1.1456 0.275349 1.45469L4.4399 5.21584C4.75778 5.50293 5.24133 5.50293 5.55921 5.21584L9.72376 1.45469C10.066 1.1456 10.0929 0.617591 9.78379 0.275349C9.4747 -0.066893 8.94669 -0.0937677 8.60445 0.215323L4.99956 3.47102L1.39466 0.215323Z" fill="#0D2E4E"/>\r
<path d="M1.39466 4.77978C1.05242 4.47069 0.524413 4.49756 0.215323 4.8398C-0.0937677 5.18204 -0.066893 5.71005 0.275349 6.01914L4.4399 9.78029C4.75778 10.0674 5.24133 10.0674 5.55921 9.78029L9.72376 6.01914C10.066 5.71005 10.0929 5.18204 9.78379 4.8398C9.4747 4.49756 8.94669 4.47069 8.60445 4.77978L4.99956 8.03548L1.39466 4.77978Z" fill="#0D2E4E"/>\r
</svg>\r
`},68854:C=>{C.exports=`<svg width="17" height="16" viewBox="0 0 17 16" fill="none" xmlns="http://www.w3.org/2000/svg">\r
	<path d="M2.65945 7.41198C2.5093 7.56296 2.4165 7.77104 2.4165 8.00079C2.4165 8.2416 2.51844 8.45859 2.6815 8.61098L6.6502 12.7434C6.96963 13.076 7.49822 13.0867 7.83083 12.7672C8.16344 12.4478 8.17412 11.9192 7.85468 11.5866L5.21284 8.83579L13.5815 8.83579C14.0427 8.83579 14.4165 8.46195 14.4165 8.00079C14.4165 7.53964 14.0427 7.16579 13.5815 7.16579L5.21132 7.16579L7.85468 4.41339C8.17412 4.08078 8.16344 3.55219 7.83083 3.23276C7.49822 2.91333 6.96963 2.92401 6.6502 3.25662L2.65945 7.41198Z" fill="white"/>\r
</svg>\r
`},62605:C=>{C.exports=`<svg width="17" height="16" viewBox="0 0 17 16" fill="none" xmlns="http://www.w3.org/2000/svg">\r
	<path d="M14.3403 7.41198C14.4905 7.56296 14.5833 7.77104 14.5833 8.00079C14.5833 8.2416 14.4813 8.45859 14.3183 8.61098L10.3496 12.7434C10.0301 13.076 9.50154 13.0867 9.16893 12.7672C8.83632 12.4478 8.82564 11.9192 9.14507 11.5866L11.7869 8.83579L3.41825 8.83579C2.95709 8.83579 2.58325 8.46195 2.58325 8.00079C2.58325 7.53964 2.95709 7.16579 3.41825 7.16579L11.7884 7.16579L9.14507 4.41339C8.82564 4.08078 8.83632 3.55219 9.16893 3.23276C9.50154 2.91333 10.0301 2.92401 10.3496 3.25662L14.3403 7.41198Z" fill="white"/>\r
</svg>\r
`},6438:C=>{C.exports=`<svg width="17" height="16" viewBox="0 0 17 16" fill="none" xmlns="http://www.w3.org/2000/svg">\r
	<path d="M10.5557 9.67969C11.0821 9.15159 11.6087 9.30319 13.7891 11.0371L13.8818 11.1152C14.8361 12.0003 13.6917 13.0111 13.1816 13.5957C12.8057 14.048 12.3537 14.4995 9.125 12.6904C8.49551 12.3531 7.89849 11.9609 7.33789 11.5215L8.50879 10.3506C9.12743 10.6195 9.69438 10.6532 10.0293 10.3594C10.2228 10.1476 10.3988 9.92004 10.5557 9.67969ZM2.66016 3.03906C3.26145 2.51075 4.3144 1.37898 5.2168 2.43555C6.72041 4.24475 6.87108 5.07694 6.34473 5.5293C5.96894 5.75538 6.04343 5.83138 5.81836 5.98145C5.27092 6.5308 5.34782 7.3928 6.44336 8.625L5.3877 9.68066C4.66268 8.89727 4.02491 8.03594 3.48828 7.11035C1.7584 3.86554 2.20943 3.33671 2.66016 3.03906Z" fill="white"/>\r
	<line x1="14.076" y1="2.93558" x2="2.60356" y2="14.408" stroke="white"/>\r
</svg>\r
`},48533:C=>{C.exports=`<svg width="17" height="16" viewBox="0 0 17 16" fill="none" xmlns="http://www.w3.org/2000/svg">\r
	<path d="M4.9165 2H3.58317C3.21498 2 2.9165 2.29848 2.9165 2.66667V4C2.9165 4.36819 3.21498 4.66667 3.58317 4.66667H4.9165C5.28469 4.66667 5.58317 4.36819 5.58317 4V2.66667C5.58317 2.29848 5.28469 2 4.9165 2Z" fill="#0D2E4E"/>\r
	<path d="M9.58317 2H8.24984C7.88165 2 7.58317 2.29848 7.58317 2.66667V4C7.58317 4.36819 7.88165 4.66667 8.24984 4.66667H9.58317C9.95136 4.66667 10.2498 4.36819 10.2498 4V2.66667C10.2498 2.29848 9.95136 2 9.58317 2Z" fill="#0D2E4E"/>\r
	<path d="M12.9165 2H14.2498C14.618 2 14.9165 2.29848 14.9165 2.66667V4C14.9165 4.36819 14.618 4.66667 14.2498 4.66667H12.9165C12.5483 4.66667 12.2498 4.36819 12.2498 4V2.66667C12.2498 2.29848 12.5483 2 12.9165 2Z" fill="#0D2E4E"/>\r
	<path d="M4.9165 6.66667H3.58317C3.21498 6.66667 2.9165 6.96514 2.9165 7.33333V8.66667C2.9165 9.03486 3.21498 9.33333 3.58317 9.33333H4.9165C5.28469 9.33333 5.58317 9.03486 5.58317 8.66667V7.33333C5.58317 6.96514 5.28469 6.66667 4.9165 6.66667Z" fill="#0D2E4E"/>\r
	<path d="M8.24984 6.66667H9.58317C9.95136 6.66667 10.2498 6.96514 10.2498 7.33333V8.66667C10.2498 9.03486 9.95136 9.33333 9.58317 9.33333H8.24984C7.88165 9.33333 7.58317 9.03486 7.58317 8.66667V7.33333C7.58317 6.96514 7.88165 6.66667 8.24984 6.66667Z" fill="#0D2E4E"/>\r
	<path d="M14.2498 6.66667H12.9165C12.5483 6.66667 12.2498 6.96514 12.2498 7.33333V8.66667C12.2498 9.03486 12.5483 9.33333 12.9165 9.33333H14.2498C14.618 9.33333 14.9165 9.03486 14.9165 8.66667V7.33333C14.9165 6.96514 14.618 6.66667 14.2498 6.66667Z" fill="#0D2E4E"/>\r
	<path d="M3.58317 11.3333H4.9165C5.28469 11.3333 5.58317 11.6318 5.58317 12V13.3333C5.58317 13.7015 5.28469 14 4.9165 14H3.58317C3.21498 14 2.9165 13.7015 2.9165 13.3333V12C2.9165 11.6318 3.21498 11.3333 3.58317 11.3333Z" fill="#0D2E4E"/>\r
	<path d="M9.58317 11.3333H8.24984C7.88165 11.3333 7.58317 11.6318 7.58317 12V13.3333C7.58317 13.7015 7.88165 14 8.24984 14H9.58317C9.95136 14 10.2498 13.7015 10.2498 13.3333V12C10.2498 11.6318 9.95136 11.3333 9.58317 11.3333Z" fill="#0D2E4E"/>\r
	<path d="M12.9165 11.3333H14.2498C14.618 11.3333 14.9165 11.6318 14.9165 12V13.3333C14.9165 13.7015 14.618 14 14.2498 14H12.9165C12.5483 14 12.2498 13.7015 12.2498 13.3333V12C12.2498 11.6318 12.5483 11.3333 12.9165 11.3333Z" fill="#0D2E4E"/>\r
</svg>\r
`},31087:C=>{C.exports=`<svg width="17" height="16" viewBox="0 0 17 16" fill="none" xmlns="http://www.w3.org/2000/svg">\r
	<path d="M5.08301 12.5833C5.08301 13.0896 5.53072 13.5 6.08301 13.5C6.63529 13.5 7.08301 13.0896 7.08301 12.5833L7.08301 3.41667C7.08301 2.91041 6.63529 2.5 6.08301 2.5C5.53072 2.5 5.08301 2.91041 5.08301 3.41667V12.5833Z" fill="#0D2E4E"/>\r
	<path d="M10.0833 12.5833C10.0833 13.0896 10.531 13.5 11.0833 13.5C11.6355 13.5 12.0833 13.0896 12.0833 12.5833L12.0833 3.41667C12.0833 2.91041 11.6355 2.5 11.0833 2.5C10.531 2.5 10.0833 2.91041 10.0833 3.41667L10.0833 12.5833Z" fill="#0D2E4E"/>\r
</svg>\r
`},73919:C=>{C.exports=`<svg width="17" height="16" viewBox="0 0 17 16" fill="none" xmlns="http://www.w3.org/2000/svg">\r
	<path d="M8.08326 1.5C6.73533 1.5 5.64262 2.59271 5.64262 3.94063V6.8694C5.64262 8.21733 6.73533 9.31004 8.08326 9.31004C9.43118 9.31004 10.5239 8.21733 10.5239 6.8694V3.94064C10.5239 2.59271 9.43118 1.5 8.08326 1.5Z" fill="#0D2E4E"/>\r
	<path d="M4.82883 7.38357C4.82883 6.93066 4.46168 6.56351 4.00877 6.56351C3.55587 6.56351 3.18872 6.93066 3.18872 7.38357C3.18872 9.7616 4.96504 11.7247 7.2632 12.0185V12.8599H6.09166C5.63875 12.8599 5.2716 13.227 5.2716 13.6799C5.2716 14.1328 5.63875 14.5 6.09166 14.5H9.99668C10.4496 14.5 10.8167 14.1328 10.8167 13.6799C10.8167 13.227 10.4496 12.8599 9.99668 12.8599H8.90331V12.0185C11.2015 11.7247 12.9778 9.7616 12.9778 7.38357C12.9778 6.93066 12.6106 6.56351 12.1577 6.56351C11.7048 6.56351 11.3377 6.93066 11.3377 7.38357C11.3377 9.05856 9.97984 10.4164 8.30485 10.4164H8.08635L8.08326 10.4164L8.08016 10.4164H7.86167C6.18668 10.4164 4.82883 9.05855 4.82883 7.38357Z" fill="#0D2E4E"/>\r
</svg>\r
`},39443:C=>{C.exports=`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\r
<path fill-rule="evenodd" clip-rule="evenodd" d="M14.0026 8.0013C14.0026 11.3157 11.3157 14.0026 8.0013 14.0026C4.68687 14.0026 2 11.3157 2 8.0013C2 4.68687 4.68687 2 8.0013 2C11.3157 2 14.0026 4.68687 14.0026 8.0013ZM8.83695 4.40039C8.83695 3.93923 8.46311 3.56539 8.00195 3.56539C7.5408 3.56539 7.16695 3.93923 7.16695 4.40039V8.00117C7.16695 8.31745 7.34564 8.60658 7.62853 8.74802L10.0291 9.94828C10.4415 10.1545 10.9431 9.98733 11.1493 9.57485C11.3556 9.16238 11.1884 8.66082 10.7759 8.45459L8.83695 7.48511V4.40039Z" fill="currentColor"/>\r
</svg>\r
`},96793:C=>{C.exports=`<svg width="17" height="16" viewBox="0 0 17 16" fill="none" xmlns="http://www.w3.org/2000/svg">\r
	<path d="M8.08268 7.31226C9.55544 7.31226 10.7493 6.12307 10.7493 4.65613C10.7493 3.18919 9.55544 2 8.08268 2C6.60992 2 5.41602 3.18919 5.41602 4.65613C5.41602 6.12307 6.60992 7.31226 8.08268 7.31226Z" fill="#0D2E4E"/>\r
	<path d="M8.40868 12.178C8.2556 12.3989 8.13076 12.6662 8.1224 12.9565H3.75C3.19772 12.9565 2.75 12.5088 2.75 11.9565V11.6285C2.75 10.924 3.03095 10.2484 3.53105 9.75031C4.03115 9.25218 4.70942 8.97234 5.41667 8.97234H7.18945V10.3538C7.18945 10.5514 7.2252 10.7474 7.29498 10.9324C7.44052 11.3183 7.79967 11.4857 8.15107 11.5531C8.35869 11.5929 8.52909 12.0042 8.40868 12.178Z" fill="#0D2E4E"/>\r
	<path d="M12.7806 7.88025C12.1976 7.63985 11.5563 7.57713 10.9376 7.6999C10.4266 7.8013 9.94975 8.02557 9.54767 8.35137C9.42013 8.11939 9.17342 7.96218 8.89 7.96218C8.47579 7.96218 8.14 8.29797 8.14 8.71218V10.0388C8.14 10.453 8.47579 10.7888 8.89 10.7888H10.2219C10.6361 10.7888 10.9719 10.453 10.9719 10.0388C10.9719 9.77727 10.838 9.54701 10.6351 9.41279C10.8149 9.2959 11.0165 9.21348 11.2296 9.17121C11.5584 9.10596 11.8992 9.13933 12.2088 9.26699C12.5183 9.39462 12.7824 9.61064 12.968 9.88726C13.1536 10.1638 13.2525 10.4887 13.2525 10.8208C13.2525 11.1529 13.1536 11.4778 12.968 11.7543C12.7824 12.0309 12.5183 12.247 12.2088 12.3746C11.8992 12.5023 11.5584 12.5356 11.2296 12.4704C10.9008 12.4051 10.5993 12.2443 10.3629 12.0087C10.0696 11.7163 9.59468 11.717 9.30225 12.0104C9.00981 12.3037 9.01056 12.7786 9.30391 13.071C9.75038 13.5161 10.319 13.8189 10.9376 13.9417C11.5563 14.0645 12.1976 14.0017 12.7806 13.7613C13.3636 13.5209 13.8624 13.1135 14.2136 12.5901C14.5648 12.0667 14.7525 11.4509 14.7525 10.8208C14.7525 10.1907 14.5648 9.57492 14.2136 9.05149C13.8624 8.5281 13.3636 8.12066 12.7806 7.88025Z" fill="#0D2E4E"/>\r
</svg>\r
`},38864:C=>{C.exports=`<svg width="17" height="16" viewBox="0 0 17 16" fill="none" xmlns="http://www.w3.org/2000/svg">\r
	<path d="M6.99976 12.583C6.99976 13.0893 6.55204 13.5 5.99976 13.5C5.75962 13.5 5.53933 13.4223 5.36694 13.293L6.99976 11.6611V12.583ZM11.9998 12.583C11.9998 13.0893 11.552 13.5 10.9998 13.5C10.4476 13.4999 9.99976 13.0892 9.99976 12.583V8.66113L11.9998 6.66113V12.583ZM5.99976 2.5C6.55204 2.5 6.99976 2.91073 6.99976 3.41699V7.41895L4.99976 9.41895V3.41699C4.99976 2.91073 5.44747 2.5 5.99976 2.5ZM10.9998 2.5C11.2605 2.5 11.4975 2.59232 11.6755 2.74219L9.99976 4.41895V3.41699C9.99976 2.91081 10.4476 2.50012 10.9998 2.5Z" fill="#0D2E4E"/>\r
	<path d="M13.8398 2.69922L4.03516 12.5039" stroke="#0D2E4E" stroke-width="1.34" stroke-linecap="round"/>\r
</svg>\r
`},25803:C=>{C.exports=`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\r
	<path d="M7.99561 7.50518C9.51542 7.50518 10.7475 6.27281 10.7475 4.75259C10.7475 3.23238 9.51542 2 7.99561 2C6.4758 2 5.24375 3.23238 5.24375 4.75259C5.24375 6.27281 6.4758 7.50518 7.99561 7.50518Z" fill="white"/>\r
	<path d="M12.5 14C13.0523 14 13.5 13.5523 13.5 13V12.6237C13.5 11.8937 13.2101 11.1935 12.694 10.6773C12.1779 10.1611 11.478 9.87111 10.7481 9.87111L5.25186 9.87111C4.52202 9.87111 3.82208 10.1611 3.306 10.6773C2.78993 11.1935 2.5 11.8937 2.5 12.6237L2.50023 13.0006C2.50056 13.5527 2.94818 14 3.50023 14H12.5Z" fill="white"/>\r
</svg>\r
`},54940:C=>{C.exports=`<svg width="17" height="16" viewBox="0 0 17 16" fill="none" xmlns="http://www.w3.org/2000/svg">\r
	<path d="M12.1584 6.56348C12.611 6.56391 12.9778 6.93115 12.9778 7.38379C12.9777 9.76147 11.2013 11.7225 8.90356 12.0166V12.8594H9.99634C10.4491 12.8594 10.8165 13.2269 10.8167 13.6797C10.8167 14.1326 10.4492 14.5 9.99634 14.5H6.09106C5.63839 14.4997 5.27173 14.1324 5.27173 13.6797C5.27188 13.2271 5.63848 12.8596 6.09106 12.8594H7.26294V12.0166C6.9609 11.978 6.66812 11.9098 6.38696 11.8164L7.78833 10.415C7.81268 10.4156 7.83708 10.417 7.86157 10.417H8.06177C8.06888 10.4168 8.07609 10.416 8.08325 10.416C8.09044 10.416 8.09759 10.4168 8.10474 10.417H8.30493C9.97969 10.4168 11.338 9.05857 11.3381 7.38379C11.3381 6.93089 11.7055 6.56348 12.1584 6.56348ZM4.00903 6.56348C4.46178 6.56366 4.82935 6.931 4.82935 7.38379C4.82938 7.89014 4.95562 8.36643 5.17505 8.78613L3.97778 9.9834C3.47911 9.24049 3.18876 8.34608 3.18872 7.38379C3.18872 6.93089 3.55613 6.56348 4.00903 6.56348ZM8.08325 1.5C9.27438 1.50004 10.2642 2.35374 10.4788 3.48242L5.77661 8.18457C5.6908 7.97416 5.64282 7.74422 5.64282 7.50293V3.94043C5.64294 2.59261 6.7354 1.5 8.08325 1.5Z" fill="#0D2E4E"/>\r
	<path d="M12.9856 3.09766L3.18091 12.9023" stroke="#0D2E4E" stroke-width="1.34" stroke-linecap="round"/>\r
</svg>\r
`},98078:C=>{C.exports=`<svg width="17" height="16" viewBox="0 0 17 16" fill="none" xmlns="http://www.w3.org/2000/svg">\r
	<path d="M8.82153 3C9.9261 3 10.8215 3.89543 10.8215 5V6.84082L14.679 5.28223V11.5176L10.8215 9.95898V12H3.82153C2.71696 12 1.82153 11.1046 1.82153 10V3H8.82153Z" fill="#0D2E4E"/>\r
</svg>\r
`},81192:C=>{C.exports=`<svg width="17" height="16" viewBox="0 0 17 16" fill="none" xmlns="http://www.w3.org/2000/svg">\r
	<path d="M14.679 11.5176L10.8215 9.95898V12H6.37134L12.011 6.35938L14.679 5.28223V11.5176ZM8.82153 3C9.45196 3 10.0135 3.29227 10.3801 3.74805L2.56958 11.5586C2.1138 11.192 1.82153 10.6304 1.82153 10V3H8.82153Z" fill="#0D2E4E"/>\r
	<path d="M13.1523 3.09766L3.34766 12.9023" stroke="#0D2E4E" stroke-width="1.34" stroke-linecap="round"/>\r
</svg>\r
`}}]);
