(self.webpackChunkapp_studio_enterprise_web_service=self.webpackChunkapp_studio_enterprise_web_service||[]).push([[8931],{8931:(q,E,C)=>{C.r(E),C.d(E,{closeLintPanel:()=>F,diagnosticCount:()=>ee,forEachDiagnostic:()=>we,forceLinting:()=>re,lintGutter:()=>pe,lintKeymap:()=>oe,linter:()=>le,nextDiagnostic:()=>H,openLintPanel:()=>z,previousDiagnostic:()=>ne,setDiagnostics:()=>G,setDiagnosticsEffect:()=>A});var m=C(27875),g=C(20920),u=C(90380);class b{constructor(e,n,i){this.from=e,this.to=n,this.diagnostic=i}}class p{constructor(e,n,i){this.diagnostics=e,this.panel=n,this.selected=i}static init(e,n,i){let o=i.facet(x).markerFilter;o&&(e=o(e,i));let s=e.slice().sort((f,w)=>f.from-w.from||f.to-w.to),r=new g.RangeSetBuilder,l=[],a=0;for(let f=0;;){let w=f==s.length?null:s[f];if(!w&&!l.length)break;let h,v;for(l.length?(h=a,v=l.reduce((d,S)=>Math.min(d,S.to),w&&w.from>h?w.from:1e8)):(h=w.from,v=w.to,l.push(w),f++);f<s.length;){let d=s[f];if(d.from==h&&(d.to>d.from||d.to==h))l.push(d),f++,v=Math.min(d.to,v);else{v=Math.min(d.from,v);break}}let D=Y(l);if(l.some(d=>d.from==d.to||d.from==d.to-1&&i.doc.lineAt(d.from).to==d.from))r.add(h,h,m.Decoration.widget({widget:new ae(D),diagnostics:l.slice()}));else{let d=l.reduce((S,Q)=>Q.markClass?S+" "+Q.markClass:S,"");r.add(h,v,m.Decoration.mark({class:"cm-lintRange cm-lintRange-"+D+d,diagnostics:l.slice(),inclusiveEnd:l.some(S=>S.to>v)}))}a=v;for(let d=0;d<l.length;d++)l[d].to<=a&&l.splice(d--,1)}let c=r.finish();return new p(c,n,y(c))}}function y(t,e=null,n=0){let i=null;return t.between(n,1e9,(o,s,{spec:r})=>{if(!(e&&r.diagnostics.indexOf(e)<0))if(!i)i=new b(o,s,e||r.diagnostics[0]);else{if(r.diagnostics.indexOf(i.diagnostic)<0)return!1;i=new b(i.from,s,i.diagnostic)}}),i}function T(t,e){let n=e.pos,i=e.end||n,o=t.state.facet(x).hideOn(t,n,i);if(o!=null)return o;let s=t.startState.doc.lineAt(e.pos);return!!(t.effects.some(r=>r.is(A))||t.changes.touchesRange(s.from,Math.max(s.to,i)))}function B(t,e){return t.field(k,!1)?e:e.concat(g.StateEffect.appendConfig.of(J))}function G(t,e){return{effects:B(t,[A.of(e)])}}const A=g.StateEffect.define(),M=g.StateEffect.define(),V=g.StateEffect.define(),k=g.StateField.define({create(){return new p(m.Decoration.none,null,null)},update(t,e){if(e.docChanged&&t.diagnostics.size){let n=t.diagnostics.map(e.changes),i=null,o=t.panel;if(t.selected){let s=e.changes.mapPos(t.selected.from,1);i=y(n,t.selected.diagnostic,s)||y(n,null,s)}!n.size&&o&&e.state.facet(x).autoPanel&&(o=null),t=new p(n,o,i)}for(let n of e.effects)if(n.is(A)){let i=e.state.facet(x).autoPanel?n.value.length?P.open:null:t.panel;t=p.init(n.value,i,e.state)}else n.is(M)?t=new p(t.diagnostics,n.value?P.open:null,t.selected):n.is(V)&&(t=new p(t.diagnostics,t.panel,n.value));return t},provide:t=>[m.showPanel.from(t,e=>e.panel),m.EditorView.decorations.from(t,e=>e.diagnostics)]});function ee(t){let e=t.field(k,!1);return e?e.diagnostics.size:0}const te=m.Decoration.mark({class:"cm-lintRange cm-lintRange-active"});function ie(t,e,n){let{diagnostics:i}=t.state.field(k),o,s=-1,r=-1;i.between(e-(n<0?1:0),e+(n>0?1:0),(a,c,{spec:f})=>{if(e>=a&&e<=c&&(a==c||(e>a||n>0)&&(e<c||n<0)))return o=f.diagnostics,s=a,r=c,!1});let l=t.state.facet(x).tooltipFilter;return o&&l&&(o=l(o,t.state)),o?{pos:s,end:r,above:t.state.doc.lineAt(s).to<r,create(){return{dom:j(t,o)}}}:null}function j(t,e){return(0,u.A)("ul",{class:"cm-tooltip-lint"},e.map(n=>$(t,n,!1)))}const z=t=>{let e=t.state.field(k,!1);(!e||!e.panel)&&t.dispatch({effects:B(t.state,[M.of(!0)])});let n=(0,m.getPanel)(t,P.open);return n&&n.dom.querySelector(".cm-panel-lint ul").focus(),!0},F=t=>{let e=t.state.field(k,!1);return!e||!e.panel?!1:(t.dispatch({effects:M.of(!1)}),!0)},H=t=>{let e=t.state.field(k,!1);if(!e)return!1;let n=t.state.selection.main,i=e.diagnostics.iter(n.to+1);return!i.value&&(i=e.diagnostics.iter(0),!i.value||i.from==n.from&&i.to==n.to)?!1:(t.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0}),!0)},ne=t=>{let{state:e}=t,n=e.field(k,!1);if(!n)return!1;let i=e.selection.main,o,s,r,l;return n.diagnostics.between(0,e.doc.length,(a,c)=>{c<i.to&&(o==null||o<a)&&(o=a,s=c),(r==null||a>r)&&(r=a,l=c)}),r==null||o==null&&r==i.from?!1:(t.dispatch({selection:{anchor:o??r,head:s??l},scrollIntoView:!0}),!0)},oe=[{key:"Mod-Shift-m",run:z,preventDefault:!0},{key:"F8",run:H}],K=m.ViewPlugin.fromClass(class{constructor(t){this.view=t,this.timeout=-1,this.set=!0;let{delay:e}=t.state.facet(x);this.lintTime=Date.now()+e,this.run=this.run.bind(this),this.timeout=setTimeout(this.run,e)}run(){clearTimeout(this.timeout);let t=Date.now();if(t<this.lintTime-10)this.timeout=setTimeout(this.run,this.lintTime-t);else{this.set=!1;let{state:e}=this.view,{sources:n}=e.facet(x);n.length&&se(n.map(i=>Promise.resolve(i(this.view))),i=>{this.view.state.doc==e.doc&&this.view.dispatch(G(this.view.state,i.reduce((o,s)=>o.concat(s))))},i=>{(0,m.logException)(this.view.state,i)})}}update(t){let e=t.state.facet(x);(t.docChanged||e!=t.startState.facet(x)||e.needsRefresh&&e.needsRefresh(t))&&(this.lintTime=Date.now()+e.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,e.delay)))}force(){this.set&&(this.lintTime=Date.now(),this.run())}destroy(){clearTimeout(this.timeout)}});function se(t,e,n){let i=[],o=-1;for(let s of t)s.then(r=>{i.push(r),clearTimeout(o),i.length==t.length?e(i):o=setTimeout(()=>e(i),200)},n)}const x=g.Facet.define({combine(t){return{sources:t.map(e=>e.source).filter(e=>e!=null),...(0,g.combineConfig)(t.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{delay:Math.max,markerFilter:U,tooltipFilter:U,needsRefresh:(e,n)=>e?n?i=>e(i)||n(i):e:n,hideOn:(e,n)=>e?n?(i,o,s)=>e(i,o,s)||n(i,o,s):e:n,autoPanel:(e,n)=>e||n})}}});function U(t,e){return t?e?(n,i)=>e(t(n,i),i):t:e}function le(t,e={}){return[x.of({source:t,config:e}),K,J]}function re(t){let e=t.plugin(K);e&&e.force()}function W(t){let e=[];if(t)e:for(let{name:n}of t){for(let i=0;i<n.length;i++){let o=n[i];if(/[a-zA-Z]/.test(o)&&!e.some(s=>s.toLowerCase()==o.toLowerCase())){e.push(o);continue e}}e.push("")}return e}function $(t,e,n){var i;let o=n?W(e.actions):[];return(0,u.A)("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},(0,u.A)("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(t):e.message),(i=e.actions)===null||i===void 0?void 0:i.map((s,r)=>{let l=!1,a=v=>{if(v.preventDefault(),l)return;l=!0;let D=y(t.state.field(k).diagnostics,e);D&&s.apply(t,D.from,D.to)},{name:c}=s,f=o[r]?c.indexOf(o[r]):-1,w=f<0?c:[c.slice(0,f),(0,u.A)("u",c.slice(f,f+1)),c.slice(f+1)],h=s.markClass?" "+s.markClass:"";return(0,u.A)("button",{type:"button",class:"cm-diagnosticAction"+h,onclick:a,onmousedown:a,"aria-label":` Action: ${c}${f<0?"":` (access key "${o[r]})"`}.`},w)}),e.source&&(0,u.A)("div",{class:"cm-diagnosticSource"},e.source))}class ae extends m.WidgetType{constructor(e){super(),this.sev=e}eq(e){return e.sev==this.sev}toDOM(){return(0,u.A)("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class N{constructor(e,n){this.diagnostic=n,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=$(e,n,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class P{constructor(e){this.view=e,this.items=[];let n=o=>{if(o.keyCode==27)F(this.view),this.view.focus();else if(o.keyCode==38||o.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(o.keyCode==40||o.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(o.keyCode==36)this.moveSelection(0);else if(o.keyCode==35)this.moveSelection(this.items.length-1);else if(o.keyCode==13)this.view.focus();else if(o.keyCode>=65&&o.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:s}=this.items[this.selectedIndex],r=W(s.actions);for(let l=0;l<r.length;l++)if(r[l].toUpperCase().charCodeAt(0)==o.keyCode){let a=y(this.view.state.field(k).diagnostics,s);a&&s.actions[l].apply(e,a.from,a.to)}}else return;o.preventDefault()},i=o=>{for(let s=0;s<this.items.length;s++)this.items[s].dom.contains(o.target)&&this.moveSelection(s)};this.list=(0,u.A)("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:n,onclick:i}),this.dom=(0,u.A)("div",{class:"cm-panel-lint"},this.list,(0,u.A)("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>F(this.view)},"\xD7")),this.update()}get selectedIndex(){let e=this.view.state.field(k).selected;if(!e)return-1;for(let n=0;n<this.items.length;n++)if(this.items[n].diagnostic==e.diagnostic)return n;return-1}update(){let{diagnostics:e,selected:n}=this.view.state.field(k),i=0,o=!1,s=null,r=new Set;for(e.between(0,this.view.state.doc.length,(l,a,{spec:c})=>{for(let f of c.diagnostics){if(r.has(f))continue;r.add(f);let w=-1,h;for(let v=i;v<this.items.length;v++)if(this.items[v].diagnostic==f){w=v;break}w<0?(h=new N(this.view,f),this.items.splice(i,0,h),o=!0):(h=this.items[w],w>i&&(this.items.splice(i,w-i),o=!0)),n&&h.diagnostic==n.diagnostic?h.dom.hasAttribute("aria-selected")||(h.dom.setAttribute("aria-selected","true"),s=h):h.dom.hasAttribute("aria-selected")&&h.dom.removeAttribute("aria-selected"),i++}});i<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)o=!0,this.items.pop();this.items.length==0&&(this.items.push(new N(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),o=!0),s?(this.list.setAttribute("aria-activedescendant",s.id),this.view.requestMeasure({key:this,read:()=>({sel:s.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:l,panel:a})=>{let c=a.height/this.list.offsetHeight;l.top<a.top?this.list.scrollTop-=(a.top-l.top)/c:l.bottom>a.bottom&&(this.list.scrollTop+=(l.bottom-a.bottom)/c)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),o&&this.sync()}sync(){let e=this.list.firstChild;function n(){let i=e;e=i.nextSibling,i.remove()}for(let i of this.items)if(i.dom.parentNode==this.list){for(;e!=i.dom;)n();e=i.dom.nextSibling}else this.list.insertBefore(i.dom,e);for(;e;)n()}moveSelection(e){if(this.selectedIndex<0)return;let n=this.view.state.field(k),i=y(n.diagnostics,this.items[e].diagnostic);i&&this.view.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0,effects:V.of(i)})}static open(e){return new P(e)}}function R(t,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(t)}</svg>')`}function L(t){return R(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${t}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const ce=m.EditorView.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:L("#d11")},".cm-lintRange-warning":{backgroundImage:L("orange")},".cm-lintRange-info":{backgroundImage:L("#999")},".cm-lintRange-hint":{backgroundImage:L("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function fe(t){return t=="error"?4:t=="warning"?3:t=="info"?2:1}function Y(t){let e="hint",n=1;for(let i of t){let o=fe(i.severity);o>n&&(n=o,e=i.severity)}return e}class Z extends m.GutterMarker{constructor(e){super(),this.diagnostics=e,this.severity=Y(e)}toDOM(e){let n=document.createElement("div");n.className="cm-lint-marker cm-lint-marker-"+this.severity;let i=this.diagnostics,o=e.state.facet(_).tooltipFilter;return o&&(i=o(i,e.state)),i.length&&(n.onmouseover=()=>ue(e,n,i)),n}}function de(t,e){let n=i=>{let o=e.getBoundingClientRect();if(!(i.clientX>o.left-10&&i.clientX<o.right+10&&i.clientY>o.top-10&&i.clientY<o.bottom+10)){for(let s=i.target;s;s=s.parentNode)if(s.nodeType==1&&s.classList.contains("cm-tooltip-lint"))return;window.removeEventListener("mousemove",n),t.state.field(X)&&t.dispatch({effects:O.of(null)})}};window.addEventListener("mousemove",n)}function ue(t,e,n){function i(){let r=t.elementAtHeight(e.getBoundingClientRect().top+5-t.documentTop);t.coordsAtPos(r.from)&&t.dispatch({effects:O.of({pos:r.from,above:!1,clip:!1,create(){return{dom:j(t,n),getCoords:()=>e.getBoundingClientRect()}}})}),e.onmouseout=e.onmousemove=null,de(t,e)}let{hoverTime:o}=t.state.facet(_),s=setTimeout(i,o);e.onmouseout=()=>{clearTimeout(s),e.onmouseout=e.onmousemove=null},e.onmousemove=()=>{clearTimeout(s),s=setTimeout(i,o)}}function me(t,e){let n=Object.create(null);for(let o of e){let s=t.lineAt(o.from);(n[s.from]||(n[s.from]=[])).push(o)}let i=[];for(let o in n)i.push(new Z(n[o]).range(+o));return g.RangeSet.of(i,!0)}const he=(0,m.gutter)({class:"cm-gutter-lint",markers:t=>t.state.field(I),widgetMarker:(t,e,n)=>{let i=[];return t.state.field(I).between(n.from,n.to,(o,s,r)=>{o>n.from&&o<n.to&&i.push(...r.diagnostics)}),i.length?new Z(i):null}}),I=g.StateField.define({create(){return g.RangeSet.empty},update(t,e){t=t.map(e.changes);let n=e.state.facet(_).markerFilter;for(let i of e.effects)if(i.is(A)){let o=i.value;n&&(o=n(o||[],e.state)),t=me(e.state.doc,o.slice(0))}return t}}),O=g.StateEffect.define(),X=g.StateField.define({create(){return null},update(t,e){return t&&e.docChanged&&(t=T(e,t)?null:{...t,pos:e.changes.mapPos(t.pos)}),e.effects.reduce((n,i)=>i.is(O)?i.value:n,t)},provide:t=>m.showTooltip.from(t)}),ge=m.EditorView.baseTheme({".cm-gutter-lint":{width:"1.4em","& .cm-gutterElement":{padding:".2em"}},".cm-lint-marker":{width:"1em",height:"1em"},".cm-lint-marker-info":{content:R('<path fill="#aaf" stroke="#77e" stroke-width="6" stroke-linejoin="round" d="M5 5L35 5L35 35L5 35Z"/>')},".cm-lint-marker-warning":{content:R('<path fill="#fe8" stroke="#fd7" stroke-width="6" stroke-linejoin="round" d="M20 6L37 35L3 35Z"/>')},".cm-lint-marker-error":{content:R('<circle cx="20" cy="20" r="15" fill="#f87" stroke="#f43" stroke-width="6"/>')}}),J=[k,m.EditorView.decorations.compute([k],t=>{let{selected:e,panel:n}=t.field(k);return!e||!n||e.from==e.to?m.Decoration.none:m.Decoration.set([te.range(e.from,e.to)])}),(0,m.hoverTooltip)(ie,{hideOn:T}),ce],_=g.Facet.define({combine(t){return(0,g.combineConfig)(t,{hoverTime:300,markerFilter:null,tooltipFilter:null})}});function pe(t={}){return[_.of(t),I,he,ge,X]}function we(t,e){let n=t.field(k,!1);if(n&&n.diagnostics.size){let i=[],o=[],s=-1;for(let r=g.RangeSet.iter([n.diagnostics]);;r.next()){for(let l=0;l<i.length;l++)(!r.value||r.value.spec.diagnostics.indexOf(i[l])<0)&&(e(i[l],o[l],s),i.splice(l,1),o.splice(l--,1));if(!r.value)break;for(let l of r.value.spec.diagnostics)i.indexOf(l)<0&&(i.push(l),o.push(r.from));s=r.to}}}},90380:(q,E,C)=>{C.d(E,{A:()=>m});function m(){var u=arguments[0];typeof u=="string"&&(u=document.createElement(u));var b=1,p=arguments[1];if(p&&typeof p=="object"&&p.nodeType==null&&!Array.isArray(p)){for(var y in p)if(Object.prototype.hasOwnProperty.call(p,y)){var T=p[y];typeof T=="string"?u.setAttribute(y,T):T!=null&&(u[y]=T)}b++}for(;b<arguments.length;b++)g(u,arguments[b]);return u}function g(u,b){if(typeof b=="string")u.appendChild(document.createTextNode(b));else if(b!=null)if(b.nodeType!=null)u.appendChild(b);else if(Array.isArray(b))for(var p=0;p<b.length;p++)g(u,b[p]);else throw new RangeError("Unsupported child node: "+b)}}}]);
